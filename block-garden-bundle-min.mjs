var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function t(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function n(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var o,r={exports:{}};
/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/var i=(o||(o=1,r.exports=function e(t,o,r){function i(l,s){if(!o[l]){if(!t[l]){if(!s&&n)return n(l);if(a)return a(l,!0);var c=new Error("Cannot find module '"+l+"'");throw c.code="MODULE_NOT_FOUND",c}var d=o[l]={exports:{}};t[l][0].call(d.exports,function(e){var n=t[l][1][e];return i(n||e)},d,d.exports,e,t,o,r)}return o[l].exports}for(var a=n,l=0;l<r.length;l++)i(r[l]);return i}({1:[function(t,n,o){(function(e){var t,o,r=e.MutationObserver||e.WebKitMutationObserver;if(r){var i=0,a=new r(d),l=e.document.createTextNode("");a.observe(l,{characterData:!0}),t=function(){l.data=i=++i%2}}else if(e.setImmediate||void 0===e.MessageChannel)t="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){d(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(d,0)};else{var s=new e.MessageChannel;s.port1.onmessage=d,t=function(){s.port2.postMessage(0)}}var c=[];function d(){var e,t;o=!0;for(var n=c.length;n;){for(t=c,c=[],e=-1;++e<n;)t[e]();n=c.length}o=!1}function g(e){1!==c.push(e)||o||t()}n.exports=g}).call(this,void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,n){var o=e(1);function r(){}var i={},a=["REJECTED"],l=["FULFILLED"],s=["PENDING"];function c(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=s,this.queue=[],this.outcome=void 0,e!==r&&I(this,e)}function d(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function g(e,t,n){o(function(){var o;try{o=t(n)}catch(t){return i.reject(e,t)}o===e?i.reject(e,new TypeError("Cannot resolve promise with itself")):i.resolve(e,o)})}function u(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function I(e,t){var n=!1;function o(t){n||(n=!0,i.reject(e,t))}function r(t){n||(n=!0,i.resolve(e,t))}function a(){t(r,o)}var l=h(a);"error"===l.status&&o(l.value)}function h(e,t){var n={};try{n.value=e(t),n.status="success"}catch(e){n.status="error",n.value=e}return n}function b(e){return e instanceof this?e:i.resolve(new this(r),e)}function m(e){var t=new this(r);return i.reject(t,e)}function C(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,o=!1;if(!n)return this.resolve([]);for(var a=new Array(n),l=0,s=-1,c=new this(r);++s<n;)d(e[s],s);return c;function d(e,r){function s(e){a[r]=e,++l!==n||o||(o=!0,i.resolve(c,a))}t.resolve(e).then(s,function(e){o||(o=!0,i.reject(c,e))})}}function A(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,o=!1;if(!n)return this.resolve([]);for(var a=-1,l=new this(r);++a<n;)s(e[a]);return l;function s(e){t.resolve(e).then(function(e){o||(o=!0,i.resolve(l,e))},function(e){o||(o=!0,i.reject(l,e))})}}t.exports=c,c.prototype.catch=function(e){return this.then(null,e)},c.prototype.then=function(e,t){if("function"!=typeof e&&this.state===l||"function"!=typeof t&&this.state===a)return this;var n=new this.constructor(r);return this.state!==s?g(n,this.state===l?e:t,this.outcome):this.queue.push(new d(n,e,t)),n},d.prototype.callFulfilled=function(e){i.resolve(this.promise,e)},d.prototype.otherCallFulfilled=function(e){g(this.promise,this.onFulfilled,e)},d.prototype.callRejected=function(e){i.reject(this.promise,e)},d.prototype.otherCallRejected=function(e){g(this.promise,this.onRejected,e)},i.resolve=function(e,t){var n=h(u,t);if("error"===n.status)return i.reject(e,n.value);var o=n.value;if(o)I(e,o);else{e.state=l,e.outcome=t;for(var r=-1,a=e.queue.length;++r<a;)e.queue[r].callFulfilled(t)}return e},i.reject=function(e,t){e.state=a,e.outcome=t;for(var n=-1,o=e.queue.length;++n<o;)e.queue[n].callRejected(t);return e},c.resolve=b,c.reject=m,c.all=C,c.race=A},{1:1}],3:[function(t,n,o){(function(e){"function"!=typeof e.Promise&&(e.Promise=t(2))}).call(this,void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(e,t,n){var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(e){return}}var a=i();function l(){try{if(!a||!a.open)return!1;var e="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!e||t)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}}function s(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(r){if("TypeError"!==r.name)throw r;for(var n=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),o=0;o<e.length;o+=1)n.append(e[o]);return n.getBlob(t.type)}}"undefined"==typeof Promise&&e(3);var c=Promise;function d(e,t){t&&e.then(function(e){t(null,e)},function(e){t(e)})}function g(e,t,n){"function"==typeof t&&e.then(t),"function"==typeof n&&e.catch(n)}function u(e){return"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}function I(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var h="local-forage-detect-blob-support",b=void 0,m={},C=Object.prototype.toString,A="readonly",p="readwrite";function v(e){for(var t=e.length,n=new ArrayBuffer(t),o=new Uint8Array(n),r=0;r<t;r++)o[r]=e.charCodeAt(r);return n}function y(e){return new c(function(t){var n=e.transaction(h,p),o=s([""]);n.objectStore(h).put(o,"key"),n.onabort=function(e){e.preventDefault(),e.stopPropagation(),t(!1)},n.oncomplete=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);t(n||!e||parseInt(e[1],10)>=43)}}).catch(function(){return!1})}function f(e){return"boolean"==typeof b?c.resolve(b):y(e).then(function(e){return b=e})}function w(e){var t=m[e.name],n={};n.promise=new c(function(e,t){n.resolve=e,n.reject=t}),t.deferredOperations.push(n),t.dbReady?t.dbReady=t.dbReady.then(function(){return n.promise}):t.dbReady=n.promise}function G(e){var t=m[e.name].deferredOperations.pop();if(t)return t.resolve(),t.promise}function k(e,t){var n=m[e.name].deferredOperations.pop();if(n)return n.reject(t),n.promise}function S(e,t){return new c(function(n,o){if(m[e.name]=m[e.name]||M(),e.db){if(!t)return n(e.db);w(e),e.db.close()}var r=[e.name];t&&r.push(e.version);var i=a.open.apply(a,r);t&&(i.onupgradeneeded=function(t){var n=i.result;try{n.createObjectStore(e.storeName),t.oldVersion<=1&&n.createObjectStore(h)}catch(n){if("ConstraintError"!==n.name)throw n;console.warn('The database "'+e.name+'" has been upgraded from version '+t.oldVersion+" to version "+t.newVersion+', but the storage "'+e.storeName+'" already exists.')}}),i.onerror=function(e){e.preventDefault(),o(i.error)},i.onsuccess=function(){var t=i.result;t.onversionchange=function(e){e.target.close()},n(t),G(e)}})}function Z(e){return S(e,!1)}function W(e){return S(e,!0)}function L(e,t){if(!e.db)return!0;var n=!e.db.objectStoreNames.contains(e.storeName),o=e.version<e.db.version,r=e.version>e.db.version;if(o&&(e.version!==t&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),r||n){if(n){var i=e.db.version+1;i>e.version&&(e.version=i)}return!0}return!1}function R(e){return new c(function(t,n){var o=new FileReader;o.onerror=n,o.onloadend=function(n){var o=btoa(n.target.result||"");t({__local_forage_encoded_blob:!0,data:o,type:e.type})},o.readAsBinaryString(e)})}function B(e){return s([v(atob(e.data))],{type:e.type})}function x(e){return e&&e.__local_forage_encoded_blob}function T(e){var t=this,n=t._initReady().then(function(){var e=m[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady});return g(n,e,e),n}function E(e){w(e);for(var t=m[e.name],n=t.forages,o=0;o<n.length;o++){var r=n[o];r._dbInfo.db&&(r._dbInfo.db.close(),r._dbInfo.db=null)}return e.db=null,Z(e).then(function(t){return e.db=t,L(e)?W(e):t}).then(function(o){e.db=t.db=o;for(var r=0;r<n.length;r++)n[r]._dbInfo.db=o}).catch(function(t){throw k(e,t),t})}function N(e,t,n,o){void 0===o&&(o=1);try{var r=e.db.transaction(e.storeName,t);n(null,r)}catch(r){if(o>0&&(!e.db||"InvalidStateError"===r.name||"NotFoundError"===r.name))return c.resolve().then(function(){if(!e.db||"NotFoundError"===r.name&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),W(e)}).then(function(){return E(e).then(function(){N(e,t,n,o-1)})}).catch(n);n(r)}}function M(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function Y(e){var t=this,n={db:null};if(e)for(var o in e)n[o]=e[o];var r=m[n.name];r||(r=M(),m[n.name]=r),r.forages.push(t),t._initReady||(t._initReady=t.ready,t.ready=T);var i=[];function a(){return c.resolve()}for(var l=0;l<r.forages.length;l++){var s=r.forages[l];s!==t&&i.push(s._initReady().catch(a))}var d=r.forages.slice(0);return c.all(i).then(function(){return n.db=r.db,Z(n)}).then(function(e){return n.db=e,L(n,t._defaultConfig.version)?W(n):e}).then(function(e){n.db=r.db=e,t._dbInfo=n;for(var o=0;o<d.length;o++){var i=d[o];i!==t&&(i._dbInfo.db=n.db,i._dbInfo.version=n.version)}})}function V(e,t){var n=this;e=u(e);var o=new c(function(t,o){n.ready().then(function(){N(n._dbInfo,A,function(r,i){if(r)return o(r);try{var a=i.objectStore(n._dbInfo.storeName).get(e);a.onsuccess=function(){var e=a.result;void 0===e&&(e=null),x(e)&&(e=B(e)),t(e)},a.onerror=function(){o(a.error)}}catch(e){o(e)}})}).catch(o)});return d(o,t),o}function X(e,t){var n=this,o=new c(function(t,o){n.ready().then(function(){N(n._dbInfo,A,function(r,i){if(r)return o(r);try{var a=i.objectStore(n._dbInfo.storeName).openCursor(),l=1;a.onsuccess=function(){var n=a.result;if(n){var o=n.value;x(o)&&(o=B(o));var r=e(o,n.key,l++);void 0!==r?t(r):n.continue()}else t()},a.onerror=function(){o(a.error)}}catch(e){o(e)}})}).catch(o)});return d(o,t),o}function D(e,t,n){var o=this;e=u(e);var r=new c(function(n,r){var i;o.ready().then(function(){return i=o._dbInfo,"[object Blob]"===C.call(t)?f(i.db).then(function(e){return e?t:R(t)}):t}).then(function(t){N(o._dbInfo,p,function(i,a){if(i)return r(i);try{var l=a.objectStore(o._dbInfo.storeName);null===t&&(t=void 0);var s=l.put(t,e);a.oncomplete=function(){void 0===t&&(t=null),n(t)},a.onabort=a.onerror=function(){var e=s.error?s.error:s.transaction.error;r(e)}}catch(e){r(e)}})}).catch(r)});return d(r,n),r}function J(e,t){var n=this;e=u(e);var o=new c(function(t,o){n.ready().then(function(){N(n._dbInfo,p,function(r,i){if(r)return o(r);try{var a=i.objectStore(n._dbInfo.storeName).delete(e);i.oncomplete=function(){t()},i.onerror=function(){o(a.error)},i.onabort=function(){var e=a.error?a.error:a.transaction.error;o(e)}}catch(e){o(e)}})}).catch(o)});return d(o,t),o}function z(e){var t=this,n=new c(function(e,n){t.ready().then(function(){N(t._dbInfo,p,function(o,r){if(o)return n(o);try{var i=r.objectStore(t._dbInfo.storeName).clear();r.oncomplete=function(){e()},r.onabort=r.onerror=function(){var e=i.error?i.error:i.transaction.error;n(e)}}catch(e){n(e)}})}).catch(n)});return d(n,e),n}function F(e){var t=this,n=new c(function(e,n){t.ready().then(function(){N(t._dbInfo,A,function(o,r){if(o)return n(o);try{var i=r.objectStore(t._dbInfo.storeName).count();i.onsuccess=function(){e(i.result)},i.onerror=function(){n(i.error)}}catch(e){n(e)}})}).catch(n)});return d(n,e),n}function P(e,t){var n=this,o=new c(function(t,o){e<0?t(null):n.ready().then(function(){N(n._dbInfo,A,function(r,i){if(r)return o(r);try{var a=i.objectStore(n._dbInfo.storeName),l=!1,s=a.openKeyCursor();s.onsuccess=function(){var n=s.result;n?0===e||l?t(n.key):(l=!0,n.advance(e)):t(null)},s.onerror=function(){o(s.error)}}catch(e){o(e)}})}).catch(o)});return d(o,t),o}function j(e){var t=this,n=new c(function(e,n){t.ready().then(function(){N(t._dbInfo,A,function(o,r){if(o)return n(o);try{var i=r.objectStore(t._dbInfo.storeName).openKeyCursor(),a=[];i.onsuccess=function(){var t=i.result;t?(a.push(t.key),t.continue()):e(a)},i.onerror=function(){n(i.error)}}catch(e){n(e)}})}).catch(n)});return d(n,e),n}function O(e,t){t=I.apply(this,arguments);var n=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||n.name,e.storeName=e.storeName||n.storeName);var o,r=this;if(e.name){var i=e.name===n.name&&r._dbInfo.db?c.resolve(r._dbInfo.db):Z(e).then(function(t){var n=m[e.name],o=n.forages;n.db=t;for(var r=0;r<o.length;r++)o[r]._dbInfo.db=t;return t});o=e.storeName?i.then(function(t){if(t.objectStoreNames.contains(e.storeName)){var n=t.version+1;w(e);var o=m[e.name],r=o.forages;t.close();for(var i=0;i<r.length;i++){var l=r[i];l._dbInfo.db=null,l._dbInfo.version=n}var s=new c(function(t,o){var r=a.open(e.name,n);r.onerror=function(e){r.result.close(),o(e)},r.onupgradeneeded=function(){r.result.deleteObjectStore(e.storeName)},r.onsuccess=function(){var e=r.result;e.close(),t(e)}});return s.then(function(e){o.db=e;for(var t=0;t<r.length;t++){var n=r[t];n._dbInfo.db=e,G(n._dbInfo)}}).catch(function(t){throw(k(e,t)||c.resolve()).catch(function(){}),t})}}):i.then(function(t){w(e);var n=m[e.name],o=n.forages;t.close();for(var r=0;r<o.length;r++)o[r]._dbInfo.db=null;var i=new c(function(t,n){var o=a.deleteDatabase(e.name);o.onerror=function(){var e=o.result;e&&e.close(),n(o.error)},o.onblocked=function(){console.warn('dropInstance blocked for database "'+e.name+'" until all open connections are closed')},o.onsuccess=function(){var e=o.result;e&&e.close(),t(e)}});return i.then(function(e){n.db=e;for(var t=0;t<o.length;t++)G(o[t]._dbInfo)}).catch(function(t){throw(k(e,t)||c.resolve()).catch(function(){}),t})})}else o=c.reject("Invalid arguments");return d(o,t),o}var U={_driver:"asyncStorage",_initStorage:Y,_support:l(),iterate:X,getItem:V,setItem:D,removeItem:J,clear:z,length:F,key:P,keys:j,dropInstance:O};function H(){return"function"==typeof openDatabase}var _="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",K="~~local_forage_type~",Q=/^~~local_forage_type~([^~]+)~/,q="__lfsc__:",$=q.length,ee="arbf",te="blob",ne="si08",oe="ui08",re="uic8",ie="si16",ae="si32",le="ur16",se="ui32",ce="fl32",de="fl64",ge=$+ee.length,ue=Object.prototype.toString;function Ie(e){var t,n,o,r,i,a=.75*e.length,l=e.length,s=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);var c=new ArrayBuffer(a),d=new Uint8Array(c);for(t=0;t<l;t+=4)n=_.indexOf(e[t]),o=_.indexOf(e[t+1]),r=_.indexOf(e[t+2]),i=_.indexOf(e[t+3]),d[s++]=n<<2|o>>4,d[s++]=(15&o)<<4|r>>2,d[s++]=(3&r)<<6|63&i;return c}function he(e){var t,n=new Uint8Array(e),o="";for(t=0;t<n.length;t+=3)o+=_[n[t]>>2],o+=_[(3&n[t])<<4|n[t+1]>>4],o+=_[(15&n[t+1])<<2|n[t+2]>>6],o+=_[63&n[t+2]];return n.length%3==2?o=o.substring(0,o.length-1)+"=":n.length%3==1&&(o=o.substring(0,o.length-2)+"=="),o}function be(e,t){var n="";if(e&&(n=ue.call(e)),e&&("[object ArrayBuffer]"===n||e.buffer&&"[object ArrayBuffer]"===ue.call(e.buffer))){var o,r=q;e instanceof ArrayBuffer?(o=e,r+=ee):(o=e.buffer,"[object Int8Array]"===n?r+=ne:"[object Uint8Array]"===n?r+=oe:"[object Uint8ClampedArray]"===n?r+=re:"[object Int16Array]"===n?r+=ie:"[object Uint16Array]"===n?r+=le:"[object Int32Array]"===n?r+=ae:"[object Uint32Array]"===n?r+=se:"[object Float32Array]"===n?r+=ce:"[object Float64Array]"===n?r+=de:t(new Error("Failed to get type for BinaryArray"))),t(r+he(o))}else if("[object Blob]"===n){var i=new FileReader;i.onload=function(){var n=K+e.type+"~"+he(this.result);t(q+te+n)},i.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(n){console.error("Couldn't convert value into a JSON string: ",e),t(null,n)}}function me(e){if(e.substring(0,$)!==q)return JSON.parse(e);var t,n=e.substring(ge),o=e.substring($,ge);if(o===te&&Q.test(n)){var r=n.match(Q);t=r[1],n=n.substring(r[0].length)}var i=Ie(n);switch(o){case ee:return i;case te:return s([i],{type:t});case ne:return new Int8Array(i);case oe:return new Uint8Array(i);case re:return new Uint8ClampedArray(i);case ie:return new Int16Array(i);case le:return new Uint16Array(i);case ae:return new Int32Array(i);case se:return new Uint32Array(i);case ce:return new Float32Array(i);case de:return new Float64Array(i);default:throw new Error("Unkown type: "+o)}}var Ce={serialize:be,deserialize:me,stringToBuffer:Ie,bufferToString:he};function Ae(e,t,n,o){e.executeSql("CREATE TABLE IF NOT EXISTS "+t.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],n,o)}function pe(e){var t=this,n={db:null};if(e)for(var o in e)n[o]="string"!=typeof e[o]?e[o].toString():e[o];var r=new c(function(e,o){try{n.db=openDatabase(n.name,String(n.version),n.description,n.size)}catch(e){return o(e)}n.db.transaction(function(r){Ae(r,n,function(){t._dbInfo=n,e()},function(e,t){o(t)})},o)});return n.serializer=Ce,r}function ve(e,t,n,o,r,i){e.executeSql(n,o,r,function(e,a){a.code===a.SYNTAX_ERR?e.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[t.storeName],function(e,l){l.rows.length?i(e,a):Ae(e,t,function(){e.executeSql(n,o,r,i)},i)},i):i(e,a)},i)}function ye(e,t){var n=this;e=u(e);var o=new c(function(t,o){n.ready().then(function(){var r=n._dbInfo;r.db.transaction(function(n){ve(n,r,"SELECT * FROM "+r.storeName+" WHERE key = ? LIMIT 1",[e],function(e,n){var o=n.rows.length?n.rows.item(0).value:null;o&&(o=r.serializer.deserialize(o)),t(o)},function(e,t){o(t)})})}).catch(o)});return d(o,t),o}function fe(e,t){var n=this,o=new c(function(t,o){n.ready().then(function(){var r=n._dbInfo;r.db.transaction(function(n){ve(n,r,"SELECT * FROM "+r.storeName,[],function(n,o){for(var i=o.rows,a=i.length,l=0;l<a;l++){var s=i.item(l),c=s.value;if(c&&(c=r.serializer.deserialize(c)),void 0!==(c=e(c,s.key,l+1)))return void t(c)}t()},function(e,t){o(t)})})}).catch(o)});return d(o,t),o}function we(e,t,n,o){var r=this;e=u(e);var i=new c(function(i,a){r.ready().then(function(){void 0===t&&(t=null);var l=t,s=r._dbInfo;s.serializer.serialize(t,function(t,c){c?a(c):s.db.transaction(function(n){ve(n,s,"INSERT OR REPLACE INTO "+s.storeName+" (key, value) VALUES (?, ?)",[e,t],function(){i(l)},function(e,t){a(t)})},function(t){if(t.code===t.QUOTA_ERR){if(o>0)return void i(we.apply(r,[e,l,n,o-1]));a(t)}})})}).catch(a)});return d(i,n),i}function Ge(e,t,n){return we.apply(this,[e,t,n,1])}function ke(e,t){var n=this;e=u(e);var o=new c(function(t,o){n.ready().then(function(){var r=n._dbInfo;r.db.transaction(function(n){ve(n,r,"DELETE FROM "+r.storeName+" WHERE key = ?",[e],function(){t()},function(e,t){o(t)})})}).catch(o)});return d(o,t),o}function Se(e){var t=this,n=new c(function(e,n){t.ready().then(function(){var o=t._dbInfo;o.db.transaction(function(t){ve(t,o,"DELETE FROM "+o.storeName,[],function(){e()},function(e,t){n(t)})})}).catch(n)});return d(n,e),n}function Ze(e){var t=this,n=new c(function(e,n){t.ready().then(function(){var o=t._dbInfo;o.db.transaction(function(t){ve(t,o,"SELECT COUNT(key) as c FROM "+o.storeName,[],function(t,n){var o=n.rows.item(0).c;e(o)},function(e,t){n(t)})})}).catch(n)});return d(n,e),n}function We(e,t){var n=this,o=new c(function(t,o){n.ready().then(function(){var r=n._dbInfo;r.db.transaction(function(n){ve(n,r,"SELECT key FROM "+r.storeName+" WHERE id = ? LIMIT 1",[e+1],function(e,n){var o=n.rows.length?n.rows.item(0).key:null;t(o)},function(e,t){o(t)})})}).catch(o)});return d(o,t),o}function Le(e){var t=this,n=new c(function(e,n){t.ready().then(function(){var o=t._dbInfo;o.db.transaction(function(t){ve(t,o,"SELECT key FROM "+o.storeName,[],function(t,n){for(var o=[],r=0;r<n.rows.length;r++)o.push(n.rows.item(r).key);e(o)},function(e,t){n(t)})})}).catch(n)});return d(n,e),n}function Re(e){return new c(function(t,n){e.transaction(function(o){o.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(n,o){for(var r=[],i=0;i<o.rows.length;i++)r.push(o.rows.item(i).name);t({db:e,storeNames:r})},function(e,t){n(t)})},function(e){n(e)})})}function Be(e,t){t=I.apply(this,arguments);var n=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||n.name,e.storeName=e.storeName||n.storeName);var o,r=this;return o=e.name?new c(function(t){var o;o=e.name===n.name?r._dbInfo.db:openDatabase(e.name,"","",0),e.storeName?t({db:o,storeNames:[e.storeName]}):t(Re(o))}).then(function(e){return new c(function(t,n){e.db.transaction(function(o){function r(e){return new c(function(t,n){o.executeSql("DROP TABLE IF EXISTS "+e,[],function(){t()},function(e,t){n(t)})})}for(var i=[],a=0,l=e.storeNames.length;a<l;a++)i.push(r(e.storeNames[a]));c.all(i).then(function(){t()}).catch(function(e){n(e)})},function(e){n(e)})})}):c.reject("Invalid arguments"),d(o,t),o}var xe={_driver:"webSQLStorage",_initStorage:pe,_support:H(),iterate:fe,getItem:ye,setItem:Ge,removeItem:ke,clear:Se,length:Ze,key:We,keys:Le,dropInstance:Be};function Te(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(e){return!1}}function Ee(e,t){var n=e.name+"/";return e.storeName!==t.storeName&&(n+=e.storeName+"/"),n}function Ne(){var e="_localforage_support_test";try{return localStorage.setItem(e,!0),localStorage.removeItem(e),!1}catch(e){return!0}}function Me(){return!Ne()||localStorage.length>0}function Ye(e){var t=this,n={};if(e)for(var o in e)n[o]=e[o];return n.keyPrefix=Ee(e,t._defaultConfig),Me()?(t._dbInfo=n,n.serializer=Ce,c.resolve()):c.reject()}function Ve(e){var t=this,n=t.ready().then(function(){for(var e=t._dbInfo.keyPrefix,n=localStorage.length-1;n>=0;n--){var o=localStorage.key(n);0===o.indexOf(e)&&localStorage.removeItem(o)}});return d(n,e),n}function Xe(e,t){var n=this;e=u(e);var o=n.ready().then(function(){var t=n._dbInfo,o=localStorage.getItem(t.keyPrefix+e);return o&&(o=t.serializer.deserialize(o)),o});return d(o,t),o}function De(e,t){var n=this,o=n.ready().then(function(){for(var t=n._dbInfo,o=t.keyPrefix,r=o.length,i=localStorage.length,a=1,l=0;l<i;l++){var s=localStorage.key(l);if(0===s.indexOf(o)){var c=localStorage.getItem(s);if(c&&(c=t.serializer.deserialize(c)),void 0!==(c=e(c,s.substring(r),a++)))return c}}});return d(o,t),o}function Je(e,t){var n=this,o=n.ready().then(function(){var t,o=n._dbInfo;try{t=localStorage.key(e)}catch(e){t=null}return t&&(t=t.substring(o.keyPrefix.length)),t});return d(o,t),o}function ze(e){var t=this,n=t.ready().then(function(){for(var e=t._dbInfo,n=localStorage.length,o=[],r=0;r<n;r++){var i=localStorage.key(r);0===i.indexOf(e.keyPrefix)&&o.push(i.substring(e.keyPrefix.length))}return o});return d(n,e),n}function Fe(e){var t=this.keys().then(function(e){return e.length});return d(t,e),t}function Pe(e,t){var n=this;e=u(e);var o=n.ready().then(function(){var t=n._dbInfo;localStorage.removeItem(t.keyPrefix+e)});return d(o,t),o}function je(e,t,n){var o=this;e=u(e);var r=o.ready().then(function(){void 0===t&&(t=null);var n=t;return new c(function(r,i){var a=o._dbInfo;a.serializer.serialize(t,function(t,o){if(o)i(o);else try{localStorage.setItem(a.keyPrefix+e,t),r(n)}catch(e){"QuotaExceededError"!==e.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.name||i(e),i(e)}})})});return d(r,n),r}function Oe(e,t){if(t=I.apply(this,arguments),!(e="function"!=typeof e&&e||{}).name){var n=this.config();e.name=e.name||n.name,e.storeName=e.storeName||n.storeName}var o,r=this;return o=e.name?new c(function(t){e.storeName?t(Ee(e,r._defaultConfig)):t(e.name+"/")}).then(function(e){for(var t=localStorage.length-1;t>=0;t--){var n=localStorage.key(t);0===n.indexOf(e)&&localStorage.removeItem(n)}}):c.reject("Invalid arguments"),d(o,t),o}var Ue={_driver:"localStorageWrapper",_initStorage:Ye,_support:Te(),iterate:De,getItem:Xe,setItem:je,removeItem:Pe,clear:Ve,length:Fe,key:Je,keys:ze,dropInstance:Oe},He=function(e,t){return e===t||"number"==typeof e&&"number"==typeof t&&isNaN(e)&&isNaN(t)},_e=function(e,t){for(var n=e.length,o=0;o<n;){if(He(e[o],t))return!0;o++}return!1},Ke=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},Qe={},qe={},$e={INDEXEDDB:U,WEBSQL:xe,LOCALSTORAGE:Ue},et=[$e.INDEXEDDB._driver,$e.WEBSQL._driver,$e.LOCALSTORAGE._driver],tt=["dropInstance"],nt=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(tt),ot={description:"",driver:et.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function rt(e,t){e[t]=function(){var n=arguments;return e.ready().then(function(){return e[t].apply(e,n)})}}function it(){for(var e=1;e<arguments.length;e++){var t=arguments[e];if(t)for(var n in t)t.hasOwnProperty(n)&&(Ke(t[n])?arguments[0][n]=t[n].slice():arguments[0][n]=t[n])}return arguments[0]}var at=function(){function e(t){for(var n in r(this,e),$e)if($e.hasOwnProperty(n)){var o=$e[n],i=o._driver;this[n]=i,Qe[i]||this.defineDriver(o)}this._defaultConfig=it({},ot),this._config=it({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return e.prototype.config=function(e){if("object"===(void 0===e?"undefined":o(e))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var t in e){if("storeName"===t&&(e[t]=e[t].replace(/\W/g,"_")),"version"===t&&"number"!=typeof e[t])return new Error("Database version must be a number.");this._config[t]=e[t]}return!("driver"in e)||!e.driver||this.setDriver(this._config.driver)}return"string"==typeof e?this._config[e]:this._config},e.prototype.defineDriver=function(e,t,n){var o=new c(function(t,n){try{var o=e._driver,r=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!e._driver)return void n(r);for(var i=nt.concat("_initStorage"),a=0,l=i.length;a<l;a++){var s=i[a];if((!_e(tt,s)||e[s])&&"function"!=typeof e[s])return void n(r)}var g=function(){for(var t=function(e){return function(){var t=new Error("Method "+e+" is not implemented by the current driver"),n=c.reject(t);return d(n,arguments[arguments.length-1]),n}},n=0,o=tt.length;n<o;n++){var r=tt[n];e[r]||(e[r]=t(r))}};g();var u=function(n){Qe[o]&&console.info("Redefining LocalForage driver: "+o),Qe[o]=e,qe[o]=n,t()};"_support"in e?e._support&&"function"==typeof e._support?e._support().then(u,n):u(!!e._support):u(!0)}catch(e){n(e)}});return g(o,t,n),o},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(e,t,n){var o=Qe[e]?c.resolve(Qe[e]):c.reject(new Error("Driver not found."));return g(o,t,n),o},e.prototype.getSerializer=function(e){var t=c.resolve(Ce);return g(t,e),t},e.prototype.ready=function(e){var t=this,n=t._driverSet.then(function(){return null===t._ready&&(t._ready=t._initDriver()),t._ready});return g(n,e,e),n},e.prototype.setDriver=function(e,t,n){var o=this;Ke(e)||(e=[e]);var r=this._getSupportedDrivers(e);function i(){o._config.driver=o.driver()}function a(e){return o._extend(e),i(),o._ready=o._initStorage(o._config),o._ready}function l(e){return function(){var t=0;function n(){for(;t<e.length;){var r=e[t];return t++,o._dbInfo=null,o._ready=null,o.getDriver(r).then(a).catch(n)}i();var l=new Error("No available storage method found.");return o._driverSet=c.reject(l),o._driverSet}return n()}}var s=null!==this._driverSet?this._driverSet.catch(function(){return c.resolve()}):c.resolve();return this._driverSet=s.then(function(){var e=r[0];return o._dbInfo=null,o._ready=null,o.getDriver(e).then(function(e){o._driver=e._driver,i(),o._wrapLibraryMethodsWithReady(),o._initDriver=l(r)})}).catch(function(){i();var e=new Error("No available storage method found.");return o._driverSet=c.reject(e),o._driverSet}),g(this._driverSet,t,n),this._driverSet},e.prototype.supports=function(e){return!!qe[e]},e.prototype._extend=function(e){it(this,e)},e.prototype._getSupportedDrivers=function(e){for(var t=[],n=0,o=e.length;n<o;n++){var r=e[n];this.supports(r)&&t.push(r)}return t},e.prototype._wrapLibraryMethodsWithReady=function(){for(var e=0,t=nt.length;e<t;e++)rt(this,nt[e])},e.prototype.createInstance=function(t){return new e(t)},e}(),lt=new at;t.exports=lt},{3:3}]},{},[4])(4)),r.exports),a=t(i);const l="shared-saves",s="pending-shared-save";function c(){return new Promise((e,t)=>{const n=indexedDB.open("block-garden",1);n.onerror=()=>t(n.error),n.onsuccess=()=>e(n.result),n.onupgradeneeded=e=>{const t=e.target.result;t.objectStoreNames.contains(l)||t.createObjectStore(l,{keyPath:"id"})}})}async function d(){try{const e=await c(),t=e.transaction(l,"readwrite").objectStore(l);await new Promise((e,n)=>{const o=t.delete(s);o.onerror=()=>n(o.error),o.onsuccess=()=>e()}),console.info("[SharedSave] Deleted shared save from IndexedDB")}catch(e){console.error("[SharedSave] Failed to delete shared save:",e)}}const g=16,u=128,I=16;class h{constructor(e,t){this.chunkX=e,this.chunkZ=t,this.blocks=new Uint8Array(32768),this.dirty=!0,this.generated=!1,this.restored=!1,this.mesh=null,this.modifiedBlocks=new Map,this.metadata=new Map}markModified(e,t,n,o,r=null){if(!this.inBounds(e,t,n))return;const i=this.index(e,t,n);this.modifiedBlocks.set(i,o),r?this.metadata.set(i,r):this.metadata.delete(i)}getModifications(){return this.modifiedBlocks}applyModifications(e,t=null){for(const[t,n]of e)this.blocks[t]=n;if(this.modifiedBlocks=new Map(e),t)for(const[e,n]of t)this.metadata.set(e,n);this.dirty=!0}hasModifications(){return this.modifiedBlocks.size>0}index(e,t,n){return e+n*g+t*g*I}inBounds(e,t,n){return e>=0&&e<g&&t>=0&&t<u&&n>=0&&n<I}getBlock(e,t,n){return this.inBounds(e,t,n)?this.blocks[this.index(e,t,n)]:0}setBlock(e,t,n,o){if(!this.inBounds(e,t,n))return!1;const r=this.index(e,t,n);return this.blocks[r]!==o&&(this.blocks[r]=o,this.dirty=!0),!0}isEmpty(){for(let e=0;e<32768;e++)if(0!==this.blocks[e])return!1;return!0}clear(){this.blocks.fill(0),this.dirty=!0}get worldX(){return this.chunkX*g}get worldZ(){return this.chunkZ*I}toTransferable(){return{chunkX:this.chunkX,chunkZ:this.chunkZ,blocks:this.blocks.buffer.slice(0)}}static fromCompressed(e){const t=new h(e.chunkX,e.chunkZ);return t.blocks.set(new Uint8Array(e.blocks)),t}}function b(e,t){return{chunkX:Math.floor(e/g),chunkZ:Math.floor(t/I),localX:(e%g+g)%g,localZ:(t%I+I)%I}}function m(e,t){const n={};for(const t of e.getAllChunks()){const e=t.worldX,o=t.worldZ;for(let r=1;r<u;r++)for(let i=0;i<I;i++)for(let a=0;a<g;a++){const l=t.getBlock(a,r,i),s=e+a,c=o+i;if(0===l)continue;n[s]||(n[s]={}),n[s][c]||(n[s][c]={}),n[s][c][r]=l;const d=t.index(a,r,i),g=t.metadata?.get(d);g&&(n[s][c].metadata||(n[s][c].metadata={}),n[s][c].metadata[r]=g)}}let o=t?.blockGarden?.state,r=t?.blockGarden?.config;!o&&"undefined"!=typeof globalThis&&globalThis.blockGarden?.state&&(o=globalThis.blockGarden.state),!r&&"undefined"!=typeof globalThis&&globalThis.blockGarden?.config&&(r=globalThis.blockGarden.config);const i=o?.seed??r?.seed??null,a={};for(const[t,n]of e.storedChunks)a[t]=Object.fromEntries(n);for(const t of e.getAllChunks()){const n=t.getModifications();if(n.size>0){a[e.getChunkKey(t.chunkX,t.chunkZ)]=Object.fromEntries(n)}}const l={};if(e.storedMetadata)for(const[t,n]of e.storedMetadata)l[t]=Object.fromEntries(n);for(const t of e.getAllChunks())if(t.metadata?.size>0){l[e.getChunkKey(t.chunkX,t.chunkZ)]=Object.fromEntries(t.metadata)}const s={};for(const[t,n]of e.storedPlantStates)s[t]=n;return{config:{seed:i,version:"function"==typeof r?.version?.get?r.version.get():r?.version??null,terrainOctaves:r.terrainOctaves?.get?r.terrainOctaves.get():4,mountainScale:r.mountainScale?.get?r.mountainScale.get():50,decorationDensity:r.decorationDensity?.get?r.decorationDensity.get():100,caveThreshold:r.caveThreshold?.get?r.caveThreshold.get():55,useCaves:!r.useCaves?.get||r.useCaves.get(),cloudDensity:r.cloudDensity?.get?r.cloudDensity.get():100},state:{x:o?.x??null,y:o?.y??null,z:o?.z??null,dx:o?.dx??null,dy:o?.dy??null,dz:o?.dz??null,pitch:o?.pitch??null,yaw:o?.yaw??null,onGround:o?.onGround??null,inventory:o?.inventory??null,curBlock:o?.curBlock?.get?o.curBlock.get():o?.curBlock??null,flying:o?.flying?.get?o.flying.get():null,materialsInventory:o?.materialsInventory?.get?o.materialsInventory.get():null,materialBar:o?.materialBar?.get?o.materialBar.get():null,activeMaterialBarSlot:o?.activeMaterialBarSlot?.get?o.activeMaterialBarSlot.get():null,arrowsControlCamera:o?.arrowsControlCamera?.get?o.arrowsControlCamera.get():null,hasEnabledExtras:o?.hasEnabledExtras?.get?o.hasEnabledExtras.get():null,growthTimers:o?.growthTimers??null,plantStructures:o?.plantStructures??null},world:n,storedChunks:a,storedPlantStates:s,storedMetadata:l}}var C,A;var p=t(function(){if(A)return C;A=1;var e=Object.prototype.toString;return C=function(t){return"number"==typeof t||function(e){return!!e&&"object"==typeof e}(t)&&"[object Number]"==e.call(t)}}());function v(e,t){const n=new Uint8Array(t);let o="";for(let e=0;e<n.byteLength;e++)o+=String.fromCharCode(n[e]);return e.btoa(o)}function y(e,t,n){const o=function(e,t){const n=e.atob(t),o=n.length,r=new Uint8Array(o);for(let e=0;e<o;e++)r[e]=n.charCodeAt(e);return r.buffer}(e,t),r=new Uint8Array(o);return new Blob([r.buffer],{type:n})}async function f(e){const t=await import("https://cdn.jsdelivr.net/npm/pdf-lib@1.17.1/+esm"),{PDFDocument:n,PDFName:o,PDFDict:r,PDFArray:i,PDFStream:a,decodePDFRawStream:l}=t;let s;e instanceof File&&(s=await e.arrayBuffer()),e instanceof ArrayBuffer&&(s=e);const c=await n.load(s),d=await async function(e,t,n,o){if(!e.catalog.has(o.of("Names")))return[];const r=e.catalog.lookup(o.of("Names"),n);if(!r.has(o.of("EmbeddedFiles")))return[];const i=r.lookup(o.of("EmbeddedFiles"),n);if(!i.has(o.of("Names")))return[];const a=i.lookup(o.of("Names"),t),l=[];for(let e=0,t=a.size();e<t;e+=2){const t=a.lookup(e),o=a.lookup(e+1,n);l.push({fileName:t,fileSpec:o})}return l}(c,i,r,o);return d.map(({fileName:e,fileSpec:t})=>{const n=t.lookup(o.of("EF"),r).lookup(o.of("F"),a);return{name:e.decodeText(),data:l(n).decode()}})}function w(e,t){const n=e.slice(0,8),o=[];let r=8;for(;r<e.length;){const t=new DataView(e.buffer,e.byteOffset+r).getUint32(0),n=String.fromCharCode(e[r+4],e[r+5],e[r+6],e[r+7]),i=8+t+4,a=e.slice(r,r+i);if(o.push({type:n,data:a}),r+=i,"IEND"===n)break}const i=function(e,t){const n=(new TextEncoder).encode(e),o=t.length,r=new Uint8Array(8+o+4),i=new DataView(r.buffer);i.setUint32(0,o),r.set(n,4),r.set(t,8);const a=new Uint8Array(4+o);a.set(n,0),a.set(t,4);const l=function(e){let t=-1;for(let n=0;n<e.length;n++){t^=e[n];for(let e=0;e<8;e++)t=t>>>1^(1&t?3988292384:0)}return(-1^t)>>>0}(a);return i.setUint32(8+o,l),r}("tEXt",(new TextEncoder).encode("gamestate\0"+t)),a=[n];a.push(o[0].data);for(let e=1;e<o.length;e++)"IEND"===o[e].type&&a.push(i),a.push(o[e].data);let l=0;for(const e of a)l+=e.length;const s=new Uint8Array(l);let c=0;for(const e of a)s.set(e,c),c+=e.length;return s}async function G(e){const t=await e.arrayBuffer(),n=new Uint8Array(t);let o=8;for(;o<n.length;){const e=new DataView(n.buffer,n.byteOffset+o).getUint32(0),t=String.fromCharCode(n[o+4],n[o+5],n[o+6],n[o+7]),r=o+8,i=r+e;if("tEXt"===t){const e=n.slice(r,i),t=(new TextDecoder).decode(e),o=t.indexOf("\0");if(-1!==o){const e=t.slice(0,o),n=t.slice(o+1);if("gamestate"===e)return JSON.parse(n)}}if(o=i+4,"IEND"===t)break}return null}const k=1/3,S=1/6,Z=e=>0|Math.floor(e),W=new Float64Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]);function L(e=Math.random){const t=function(e){const t=512,n=new Uint8Array(t);for(let e=0;e<256;e++)n[e]=e;for(let t=0;t<255;t++){const o=t+~~(e()*(256-t)),r=n[t];n[t]=n[o],n[o]=r}for(let e=256;e<t;e++)n[e]=n[e-256];return n}(e),n=new Float64Array(t).map(e=>W[e%12*3]),o=new Float64Array(t).map(e=>W[e%12*3+1]),r=new Float64Array(t).map(e=>W[e%12*3+2]);return function(e,i,a){let l,s,c,d;const g=(e+i+a)*k,u=Z(e+g),I=Z(i+g),h=Z(a+g),b=(u+I+h)*S,m=e-(u-b),C=i-(I-b),A=a-(h-b);let p,v,y,f,w,G;m>=C?C>=A?(p=1,v=0,y=0,f=1,w=1,G=0):m>=A?(p=1,v=0,y=0,f=1,w=0,G=1):(p=0,v=0,y=1,f=1,w=0,G=1):C<A?(p=0,v=0,y=1,f=0,w=1,G=1):m<A?(p=0,v=1,y=0,f=0,w=1,G=1):(p=0,v=1,y=0,f=1,w=1,G=0);const W=m-p+S,L=C-v+S,R=A-y+S,B=m-f+2*S,x=C-w+2*S,T=A-G+2*S,E=m-1+.5,N=C-1+.5,M=A-1+.5,Y=255&u,V=255&I,X=255&h;let D=.6-m*m-C*C-A*A;if(D<0)l=0;else{const e=Y+t[V+t[X]];D*=D,l=D*D*(n[e]*m+o[e]*C+r[e]*A)}let J=.6-W*W-L*L-R*R;if(J<0)s=0;else{const e=Y+p+t[V+v+t[X+y]];J*=J,s=J*J*(n[e]*W+o[e]*L+r[e]*R)}let z=.6-B*B-x*x-T*T;if(z<0)c=0;else{const e=Y+f+t[V+w+t[X+G]];z*=z,c=z*z*(n[e]*B+o[e]*x+r[e]*T)}let F=.6-E*E-N*N-M*M;if(F<0)d=0;else{const e=Y+1+t[V+1+t[X+1]];F*=F,d=F*F*(n[e]*E+o[e]*N+r[e]*M)}return 32*(l+s+c+d)}}var R=function(){return e.importState=function(t){var n=new e;return n.importState(t),n},e;function e(){return function(e){var t=0,n=0,o=0,r=1;0==e.length&&(e=[+new Date]);var i=function(){var e=4022871197,t=function(t){t=t.toString();for(var n=0;n<t.length;n++){var o=.02519603282416938*(e+=t.charCodeAt(n));o-=e=o>>>0,e=(o*=e)>>>0,e+=4294967296*(o-=e)}return 2.3283064365386963e-10*(e>>>0)};return t.version="Mash 0.9",t}();t=i(" "),n=i(" "),o=i(" ");for(var a=0;a<e.length;a++)(t-=i(e[a]))<0&&(t+=1),(n-=i(e[a]))<0&&(n+=1),(o-=i(e[a]))<0&&(o+=1);i=null;var l=function(){var e=2091639*t+2.3283064365386963e-10*r;return t=n,n=o,o=e-(r=0|e)};return l.next=l,l.uint32=function(){return 4294967296*l()},l.fract53=function(){return l()+11102230246251565e-32*(2097152*l()|0)},l.version="Alea 0.9",l.args=e,l.exportState=function(){return[t,n,o,r]},l.importState=function(e){t=+e[0]||0,n=+e[1]||0,o=+e[2]||0,r=+e[3]||0},l}(Array.prototype.slice.call(arguments))}}();let B=null,x=null;const T=new Map;function E(e){if(e!==x||!B)if(x=e,T.has(e))B=T.get(e);else if(B=L(R(e)),T.set(e,B),T.size>20){const e=T.keys().next().value;T.delete(e)}}async function N(e,t,n){if(!n)return console.warn("Save state validation failed: No state data provided."),!1;let o=n;if("pdf"===o?.type){const t=y(e,o.contents,"application/pdf"),[n]=await f(new File([t],"block-garden-game-card.png"));o=JSON.parse(await G(new Blob([n.data])))}const r=o.world||o,i=o.state||{};let a=!1;const l=Object.keys(r);for(const e of l){const t=Number(e);if(!p(t)||isNaN(t))continue;const n=r[e];if(n&&"object"==typeof n){const e=Object.keys(n);for(const t of e){const e=Number(t);if(!p(e)||isNaN(e))continue;const o=n[t];if(o&&"object"==typeof o){const e=Object.keys(o);for(const t of e){const e=Number(t);if(!p(e)||isNaN(e))continue;if("number"==typeof o[t]){a=!0;break}}}if(a)break}}if(a)break}if(!a)return console.warn("Save state validation failed: No voxel data found."),!1;const s=o.config||{},c=e.blockGarden.state.world,d=e.blockGarden.state,g=e.blockGarden.config,u=(e,t,n,o,r={})=>{if(null==n||!e)return;let i=n;if("number"===o){if(i=Number(n),isNaN(i))return;void 0!==r.min&&(i=Math.max(r.min,i)),void 0!==r.max&&(i=Math.min(r.max,i))}else if("boolean"===o)i=Boolean(n);else if("string"===o)i=String(n);else if("object"===o&&("object"!=typeof n||Array.isArray(n)))return;const a=e[t];a&&"function"==typeof a.set?a.set(i):e[t]=i};if(u(d,"seed",s.seed,"number",{min:1,max:Number.MAX_SAFE_INTEGER}),u(d,"version",s.version,"string"),g&&(u(g,"terrainOctaves",s.terrainOctaves,"number",{min:1,max:8}),u(g,"mountainScale",s.mountainScale,"number",{min:0,max:100}),u(g,"decorationDensity",s.decorationDensity,"number",{min:0,max:100}),u(g,"caveThreshold",s.caveThreshold,"number",{min:0,max:100}),u(g,"useCaves",s.useCaves,"boolean"),u(g,"cloudDensity",s.cloudDensity,"number",{min:0,max:100})),u(d,"x",i.x,"number"),u(d,"y",i.y,"number"),u(d,"z",i.z,"number"),u(d,"dx",i.dx,"number"),u(d,"dy",i.dy,"number"),u(d,"dz",i.dz,"number"),u(d,"pitch",i.pitch,"number"),u(d,"yaw",i.yaw,"number"),u(d,"onGround",i.onGround,"boolean"),u(d,"flying",i.flying,"boolean"),i.inventory&&"object"==typeof i.inventory?d.inventory=i.inventory:d.inventory={},u(d,"curBlock",i.curBlock,"number"),i.materialsInventory&&Array.isArray(i.materialsInventory)&&u(d,"materialsInventory",i.materialsInventory,"object"),i.materialBar&&Array.isArray(i.materialBar)&&u(d,"materialBar",i.materialBar,"object"),u(d,"activeMaterialBarSlot",i.activeMaterialBarSlot,"number",{min:0,max:8}),u(d,"arrowsControlCamera",i.arrowsControlCamera,"boolean"),u(d,"hasEnabledExtras",i.hasEnabledExtras,"boolean"),"function"==typeof e.cancelGameLoop?e.cancelGameLoop():"function"==typeof e.globalThis?.cancelGameLoop&&e.globalThis.cancelGameLoop(),c.clear(),void 0!==d.seed){E(d.seed),d.plantStructures&&Object.keys(d.plantStructures).forEach(e=>{delete d.plantStructures[e]}),d.growthTimers&&Object.keys(d.growthTimers).forEach(e=>{delete d.growthTimers[e]});const e=i.plantStructures||{},t=i.growthTimers||{};c.storedPlantStates.clear(),o.storedPlantStates&&Object.entries(o.storedPlantStates).forEach(([e,t])=>{c.storedPlantStates.set(e,t)});new Set([...Object.keys(e),...Object.keys(t)]).forEach(n=>{const o=n.split(",");if(3===o.length){const r=parseInt(o[0]),i=parseInt(o[2]),{chunkX:a,chunkZ:l}=b(r,i),s=`${a},${l}`;c.storedPlantStates.has(s)||c.storedPlantStates.set(s,{structures:{},timers:{}});const d=c.storedPlantStates.get(s);e[n]&&(d.structures[n]=e[n]),t[n]&&(d.timers[n]=t[n])}})}c.storedChunks?.clear(),c.storedMetadata?.clear(),o.storedChunks&&Object.entries(o.storedChunks).forEach(([e,t])=>{c.storedChunks.set(e,new Map(Object.entries(t).map(([e,t])=>[Number(e),t])))}),o.storedMetadata&&c.storedMetadata&&Object.entries(o.storedMetadata).forEach(([e,t])=>{c.storedMetadata.set(e,new Map(Object.entries(t).map(([e,t])=>[Number(e),t])))});const I=performance.now();l.length>1e3&&console.warn(`World data is very large (${l.length} x columns), may cause slow loading.`),Object.entries(r).forEach(([e,t])=>{const n=Number(e);Object.entries(t).forEach(([e,t])=>{const o=Number(e);Object.entries(t).forEach(([e,r])=>{if("metadata"===e)return;const i=Number(e),a=t.metadata?t.metadata[e]:null;c.set(`${n},${i},${o}`,Number(r),!1,a);const{chunkX:l,chunkZ:s}=b(n,o),d=c.getChunk(l,s);d&&(d.generated=!0)})})});const h=performance.now();return console.log(`World loading of ${l.length} columns took ${h-I}ms`),t.dispatchEvent(new CustomEvent("block-garden-reset")),!0}function M(){const e=new Date;return`${e.getFullYear()}-${(e.getMonth()+1).toString().padStart(2,"0")}-${e.getDate().toString().padStart(2,"0")}_${e.getHours().toString().padStart(2,"0")}-${e.getMinutes().toString().padStart(2,"0")}-${e.getSeconds().toString().padStart(2,"0")}`}async function Y(e){const t=(new TextEncoder).encode(e);if("CompressionStream"in window){const e=new Blob([t]).stream().pipeThrough(new CompressionStream("gzip"));return await new Response(e).blob()}}async function V(e,t){const n=`Block-Garden-Game-Save-${M()}.bgs`;let o;if(e.showSaveFilePicker)o=await e.showSaveFilePicker({suggestedName:n}),await async function(e,t){const n=await Y(e),o=await t.createWritable();await o.write(n),await o.close()}(t,o);else{const o=await Y(t),r=URL.createObjectURL(o),i=e.document.createElement("a");i.href=r,i.download=n,e.document.body.append(i),i.click(),e.document.body.removeChild(i),URL.revokeObjectURL(r)}}function X(e){return e.trim().replace(/[^a-zA-Z0-9\s-]/g,"").split(/\s+/).map(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join("-")}function D(e,t){const n=e.get(t);if(null===n||""===n.trim())return;const o=Number(n);return Number.isFinite(o)?o:void 0}function J(e,t){const n=(e,t)=>{if(!e)return null;if(e.tagName===t.toUpperCase()&&e.shadowRoot)return e;const o=[...e.children||[]];return e.shadowRoot&&o.push(e.shadowRoot),o.map(e=>n(e,t)).find(Boolean)||null},o=n(e,t);return o?o.shadowRoot:null}async function z(e,t,n){const o=t.toLowerCase();let r="{}";if(o.endsWith(".txt"))r=(await e.text()).replace(/\s+/g,"");else if(o.endsWith(".pdf")){const n=new File([e],t,{type:"application/pdf"}),o=await f(n);if(!o||0===o.length||!o[0].data)throw new Error("Invalid game save: No attachments found in PDF.");r=await G(new Blob([o[0].data]))}else if(o.endsWith(".bgs")){const t=e.stream().pipeThrough(new n.DecompressionStream("gzip")),o=await new n.Response(t).blob();r=await o.text()}else r=await e.text();try{JSON.parse(r)}catch(e){throw new Error("Invalid game state: not valid JSON.")}return r}function F(e){e&&e.parentElement&&(e.classList.add("toast--slide-out"),setTimeout(()=>e.remove(),300))}function P(e,t,n={}){const{duration:o=3e3,manualClose:r=!1,stack:i=!1,bottomOffset:a=1,useSingle:l=!0}=n,s=e.getElementById("toastContainer");if(!s)return void console.warn("Toast container not found");let c;if(s.style.bottom=`${a}rem`,l&&(c=s.querySelector(".toast"),c)){const e=c.querySelector(".toast__content");if(e&&(e.textContent=t),o>0){const e=c;clearTimeout(e.autoRemoveTimer),e.autoRemoveTimer=setTimeout(()=>F(c),o)}return}if(!i&&!l){s.querySelectorAll(".toast").forEach(e=>{e.classList.add("toast--fade-out"),setTimeout(()=>e.remove(),300)})}c=e.ownerDocument.createElement("div"),c.className="toast";const d=e.ownerDocument.createElement("div");if(d.className="toast__content",d.textContent=t,c.appendChild(d),r){const t=e.ownerDocument.createElement("button");t.className="toast__close-btn",t.innerHTML="&times;",t.addEventListener("click",()=>F(c)),c.appendChild(t)}if(s.appendChild(c),o>0){c.autoRemoveTimer=setTimeout(()=>F(c),o)}}var j=Object.freeze({__proto__:null,showToast:P});const O="block-garden-autosave",U="block-garden-autosave-mode",H="block-garden-save-";async function _(){try{return await a.getItem(U)}catch(e){return console.info("Failed to get save mode:",e),"manual"}}async function K(e){try{await a.setItem(U,e),console.info("Save mode set to:",e)}catch(e){console.info("Failed to set save mode:",e)}}let Q=0;async function q(e){try{if("auto"!==await _())return;const t=Date.now();if(t-Q<3e4)return void console.info("Auto save skipped (too soon since last save)");const n=m(e.blockGarden.state.world,e),o=JSON.stringify(n),r=await Y(o),i=v(e,await r.arrayBuffer()),l={name:"[Auto Save]",timestamp:Date.now(),data:i,isAutoSave:!0};await a.setItem(O,l),Q=t,console.info("Game auto saved successfully")}catch(e){console.error("Failed to auto save game:",e)}}async function $(e,t){try{const n=await async function(){try{const e=(await c()).transaction(l,"readonly").objectStore(l);return await new Promise((t,n)=>{const o=e.get(s);o.onerror=()=>n(o.error),o.onsuccess=()=>t(o.result)})}catch(e){return console.error("[SharedSave] Failed to retrieve shared save:",e),null}}();if(!n||!n.data)return!1;const o=e.document.createElement("dialog");o.style.cssText="\n      background: var(--bg-color-gray-50);\n      border-radius: 0.5rem;\n      border: 0.125rem solid var(--bg-color-gray-900);\n      color: var(--bg-color-gray-900);\n      font-family: monospace;\n      padding: 1.25rem;\n      max-width: 25rem;\n      z-index: 10000;\n    ";const r=new Date(n.timestamp).toLocaleString();return o.innerHTML=`\n      <h3 style="margin: 0 0 1rem 0">Shared Game Save</h3>\n      <p style="margin: 0 0 1rem 0">\n        A game save was shared with you (${r}). Would you like to load it?\n      </p>\n      <div style="display: flex; gap: 0.625rem; justify-content: flex-end">\n        <button id="sharedSaveNo" style="\n          background: var(--bg-color-red-500);\n          border-radius: 0.25rem;\n          border: none;\n          color: white;\n          cursor: pointer;\n          padding: 0.5rem 0.9375rem;\n        ">No</button>\n        <button id="sharedSaveYes" style="\n          background: var(--bg-color-green-500);\n          border-radius: 0.25rem;\n          border: none;\n          color: white;\n          cursor: pointer;\n          padding: 0.5rem 0.9375rem;\n        ">Yes</button>\n      </div>\n    `,t.append(o),o.showModal(),new Promise(r=>{o.querySelector("#sharedSaveYes").addEventListener("click",async()=>{try{let i=n.data;if(!await N(e,t,i))return P(t,"Oops! This shared save appears to be broken. Continuing with normal load...",{stack:!0,useSingle:!1,duration:5e3}),o.close(),o.remove(),void r(!1);if("pdf"===i?.type){const t=y(e,i.contents,"application/pdf"),[n]=await f(new File([t],"block-garden-game-card.png"));i=JSON.parse(await G(new Blob([n.data])))}const{seed:a}=i.config,l=t.getElementById("worldSeedInput"),s=t.getElementById("currentSeed");l instanceof HTMLInputElement&&(l.value=a),s&&(s.textContent=a),await d(),console.log("Shared save loaded successfully")}catch(e){return console.error("Failed to load shared save:",e),P(t,"Oops! Failed to load shared save. Continuing...",{stack:!0,useSingle:!1,duration:5e3}),o.close(),o.remove(),void r(!1)}o.close(),o.remove(),r(!0)}),o.querySelector("#sharedSaveNo").addEventListener("click",async()=>{await d(),o.close(),o.remove(),r(!1)}),o.addEventListener("cancel",async()=>{setTimeout(()=>{e.blockGarden.state.isCanvasActionDisabled=!1},500),await d(),r(!1)})})}catch(e){return console.error("Failed to check for shared save:",e),!1}}async function ee(e,t){try{const n=function(e){try{return new e.URLSearchParams(e.location.search).get("gameSave")}catch(e){return console.warn("Failed to parse URL search params:",e),null}}(e);if(!n)return!1;const o=e.document.createElement("dialog");return o.style.cssText="\n      background: var(--bg-color-gray-50);\n      border-radius: 0.5rem;\n      border: 0.125rem solid var(--bg-color-gray-900);\n      color: var(--bg-color-gray-900);\n      font-family: monospace;\n      padding: 1.25rem;\n      max-width: 25rem;\n      z-index: 10000;\n    ",o.innerHTML='\n      <h3 style="margin: 0 0 1rem 0">Game Save Found in URL</h3>\n      <p style="margin: 0 0 1rem 0">\n        A game save was found in the URL. Would you like to load it?\n      </p>\n      <div style="display: flex; gap: 0.625rem; justify-content: flex-end">\n        <button id="urlSaveNo" style="\n          background: var(--bg-color-red-500);\n          border-radius: 0.25rem;\n          border: none;\n          color: white;\n          cursor: pointer;\n          padding: 0.5rem 0.9375rem;\n        ">No</button>\n        <button id="urlSaveYes" style="\n          background: var(--bg-color-green-500);\n          border-radius: 0.25rem;\n          border: none;\n          color: white;\n          cursor: pointer;\n          padding: 0.5rem 0.9375rem;\n        ">Yes</button>\n      </div>\n    ',t.append(o),o.showModal(),new Promise(r=>{o.querySelector("#urlSaveYes").addEventListener("click",async()=>{try{const i=await fetch(n);if(!i.ok)throw new Error(`Failed to fetch from URL: ${i.statusText}`);const a=await i.blob(),l=n.split("/").pop()||"save.bgs",s=await z(a,l,e),c=JSON.parse(s);if(!await N(e,t,c))return P(t,"Oops! This URL save state appears to be broken. Continuing with normal load...",{stack:!0,useSingle:!1,duration:5e3}),o.close(),o.remove(),void r(!1);const d=t.getElementById("worldSeedInput"),g=t.getElementById("currentSeed");d instanceof HTMLInputElement&&(d.value=e.blockGarden.state.seed),g&&(g.textContent=e.blockGarden.state.seed),console.log("URL save loaded successfully")}catch(e){return console.error("Failed to load URL save:",e),P(t,"Oops! Failed to load URL save. Continuing...",{stack:!0,useSingle:!1,duration:5e3}),o.close(),o.remove(),void r(!1)}o.close(),o.remove(),r(!0)}),o.querySelector("#urlSaveNo").addEventListener("click",()=>{o.close(),o.remove(),r(!1)}),o.addEventListener("cancel",()=>{o.close(),o.remove(),r(!1)})})}catch(e){return console.error("Failed to check for URL save:",e),!1}}class te{constructor(e,t,n){this.gThis=e,this.doc=t,this.shadow=n,this.dialog=null,this.savedGames=[],this.close=this.close.bind(this),this.deleteSelectedGame=this.deleteSelectedGame.bind(this),this.getPDFGameStateAttachment=this.getPDFGameStateAttachment.bind(this),this.getSelectedGameAsPNG=this.getSelectedGameAsPNG.bind(this),this.handleDragLeave=this.handleDragLeave.bind(this),this.handleDragOver=this.handleDragOver.bind(this),this.handleFileDrop=this.handleFileDrop.bind(this),this.handleFileSelect=this.handleFileSelect.bind(this),this.handleWorldNameInput=this.handleWorldNameInput.bind(this),this.loadSelectedGame=this.loadSelectedGame.bind(this),this.saveCurrentGame=this.saveCurrentGame.bind(this),this.shareSelectedGame=this.shareSelectedGame.bind(this),this.shareSelectedGameAsPDF=this.shareSelectedGameAsPDF.bind(this)}async createDialog(){this.dialog&&this.dialog.remove();const e=this.doc.createElement("dialog");return e.setAttribute("id","storageDialog"),e.style.cssText="\n      background: var(--bg-color-gray-50);\n      border-radius: 0.5rem;\n      border: 0.125rem solid var(--bg-color-gray-900);\n      color: var(--bg-color-gray-900);\n      font-family: monospace;\n      max-height: 80vh;\n      max-width: 31.25rem;\n      overflow-y: auto;\n      padding: 1.25rem;\n      width: 90%;\n    ",e.innerHTML='\n      <div\n        style="\n          align-items: center;\n          display: flex;\n          justify-content: space-between;\n          margin-bottom: 0.9375rem;\n        "\n      >\n        <h3 style="margin: 0">Game Storage</h3>\n        <button\n          id="closeStorageDialog"\n          style="\n            background: var(--bg-color-red-500);\n            border-radius: 0.25rem;\n            border: none;\n            color: white;\n            cursor: pointer;\n            padding: 0.3125rem 0.625rem;\n          "\n        >\n          &times;\n        </button>\n      </div>\n\n      <div style="margin-bottom: 1.25rem">\n        <h4 style="margin: 0.625rem 0">Save Current Game</h4>\n        <div\n          style="\n            align-items: center;\n            display: flex;\n            gap: 0.625rem;\n            margin-bottom: 0.625rem;\n          "\n        >\n          <input\n            type="text"\n            id="worldNameInput"\n            placeholder="Enter world name..."\n            style="\n              border-radius: 0.25rem;\n              border: 0.0625rem solid var(--bg-color-gray-500);\n              flex: 1;\n              padding: 0.3125rem;\n            "\n          />\n          <button\n            id="saveToStorageBtn"\n            style="\n              background: var(--bg-color-green-500);\n              border-radius: 0.25rem;\n              border: none;\n              color: white;\n              cursor: pointer;\n              padding: 0.5rem 0.9375rem;\n            "\n          >\n            Save\n          </button>\n        </div>\n      </div>\n\n      <div>\n        <h4 style="margin: 0.625rem 0">Saved Games in Storage</h4>\n        <div\n          id="gameDropZone"\n          style="\n            border: 0.0625rem dashed var(--bg-color-gray-400);\n            border-radius: 0.25rem;\n            position: relative;\n            transition: all 0.2s ease;\n            padding: 0;\n          "\n        >\n          <div\n            id="savedGamesList"\n            style="\n              border: 0.0625rem solid var(--bg-color-gray-400);\n              border-radius: 0.25rem;\n              max-height: 18.75rem;\n              overflow-y: auto;\n            "\n          >\n            \x3c!-- Saved games will be populated here --\x3e\n          </div>\n          <input\n            id="fileInput"\n            type="file"\n            accept=".bgs,.pdf,.txt,text/plain,application/pdf,application/gzip,application/*"\n            style="display: none"\n            multiple\n          />\n        </div>\n        <div style="margin-top: 0.625rem; display: flex; gap: 0.625rem">\n          <button\n            id="deleteSelectedBtn"\n            disabled\n            style="\n              background: var(--bg-color-red-500);\n              border-radius: 0.25rem;\n              border: none;\n              color: white;\n              cursor: pointer;\n              padding: 0.5rem 0.9375rem;\n            "\n          >\n            Delete Selected\n          </button>\n          <button\n            id="shareSelectedBtn"\n            disabled\n            hidden\n            style="\n              background: var(--bg-color-medium-purple);\n              border-radius: 0.25rem;\n              border: none;\n              color: white;\n              cursor: pointer;\n              padding: 0.5rem 0.9375rem;\n            "\n          >\n            Share Selected\n          </button>\n          <button\n            id="shareSelectedAsPdfBtn"\n            disabled\n            hidden\n            style="\n              background: var(--bg-color-medium-purple);\n              border-radius: 0.25rem;\n              border: none;\n              color: white;\n              cursor: pointer;\n              padding: 0.5rem 0.9375rem;\n            "\n          >\n            Share Selected As PDF\n          </button>\n          <button\n            id="loadSelectedBtn"\n            disabled\n            style="\n              background: var(--bg-color-blue-500);\n              border-radius: 0.25rem;\n              border: none;\n              color: white;\n              cursor: pointer;\n              padding: 0.5rem 0.9375rem;\n            "\n          >\n            Load Selected\n          </button>\n        </div>\n      </div>\n    ',this.shadow.append(e),this.dialog=e,await this.loadSavedGamesList(),this.initEventListeners(),this.updateButtonStates(),e}async loadSavedGamesList(){this.savedGames=[];const e=await a.keys(),t=await a.getItem(O);t&&this.savedGames.push({key:O,name:t.name,timestamp:t.timestamp,data:t.data,isAutoSave:!0});for(const t of e)if(t.startsWith(H)){const e=await a.getItem(t);e&&this.savedGames.push({key:t,name:e.name,timestamp:e.timestamp,data:e.data,isAutoSave:e.isAutoSave||!1})}this.savedGames.sort((e,t)=>t.timestamp-e.timestamp),this.renderSavedGamesList()}renderSavedGamesList(){const e=this.dialog.querySelector("#savedGamesList");0!==this.savedGames.length?(e.innerHTML=this.savedGames.map((e,t)=>`\n        <div\n          class="saved-game-item"\n          data-index="${t}"\n          style="\n            padding: 0.625rem;\n            border-bottom: 0.0625rem solid var(--bg-color-gray-100);\n            cursor: pointer;\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            ${e.isAutoSave?"background: var(--bg-color-blue-50);":""}\n          "\n        >\n          <div>\n            <div style="font-weight: bold; ${e.isAutoSave?"color: var(--bg-color-blue-700);":""}">${e.name}</div>\n            <div style="font-size: 0.75rem; color: var(--bg-color-neutral-950);">\n              ${new Date(e.timestamp).toLocaleString()}\n            </div>\n          </div>\n          <input\n            name="selectedGame"\n            style="margin-left: 0.625rem"\n            type="radio"\n            value="${t}"\n          />\n        </div>\n    `).join(""),e.querySelectorAll(".saved-game-item").forEach(e=>{e.addEventListener("click",t=>{if(t.target instanceof HTMLElement&&"radio"!==t.target.getAttribute("type")){const t=e.querySelector('input[type="radio"]');t instanceof HTMLInputElement&&(t.checked=!0),this.updateButtonStates()}})}),e.querySelectorAll('input[type="radio"]').forEach(e=>{e.addEventListener("change",()=>this.updateButtonStates())})):e.innerHTML='\n      <div style="padding: 1.25rem; text-align: center; color: var(--bg-color-neutral-950);">\n        No saved games found\n      </div>\n    '}updateButtonStates(){const e=!!this.dialog.querySelector('input[name="selectedGame"]:checked'),t=this.dialog.querySelector("#loadSelectedBtn");t instanceof HTMLButtonElement&&(t.disabled=!e,t.style.opacity=e?"1":"0.5",t.style.cursor=e?"pointer":"not-allowed");const n=this.dialog.querySelector("#deleteSelectedBtn");n instanceof HTMLButtonElement&&(n.disabled=!e,n.style.opacity=e?"1":"0.5",n.style.cursor=e?"pointer":"not-allowed");const o=this.dialog.querySelector("#shareSelectedBtn"),r=this.dialog.querySelector("#shareSelectedAsPdfBtn");if(o instanceof HTMLButtonElement&&r instanceof HTMLButtonElement){let t=!1;if("undefined"!=typeof navigator&&void 0!==navigator.canShare)try{const n=new File([],"test");t=navigator.canShare({files:[n]}),o.disabled=!e,o.style.opacity=t?"1":"0.5",o.style.cursor=t?"pointer":"not-allowed",r.disabled=!e,r.style.opacity=t?"1":"0.5",r.style.cursor=t?"pointer":"not-allowed"}catch{o.disabled=!0,o.setAttribute("hidden","hidden"),o.style.opacity="0.5",o.style.cursor="not-allowed",r.disabled=!0,r.setAttribute("hidden","hidden"),r.style.opacity="0.5",r.style.cursor="not-allowed"}else o.disabled=!0,o.setAttribute("hidden","hidden"),o.style.opacity="0.5",o.style.cursor="not-allowed",r.disabled=!0,r.setAttribute("hidden","hidden"),r.style.opacity="0.5",r.style.cursor="not-allowed";t&&(o.removeAttribute("hidden"),this.gThis.blockGarden.state.hasEnabledExtras.get()&&r.removeAttribute("hidden"))}}handleWorldNameInput(e){/^[\p{L}\p{N}\p{P}\s]+$/u.test(e.key)&&e.stopPropagation(),"Enter"===e.key&&this.saveCurrentGame()}initEventListeners(){const e=this.dialog.querySelector("#closeStorageDialog"),t=this.dialog.querySelector("#saveToStorageBtn"),n=this.dialog.querySelector("#loadSelectedBtn"),o=this.dialog.querySelector("#deleteSelectedBtn"),r=this.dialog.querySelector("#shareSelectedBtn"),i=this.dialog.querySelector("#shareSelectedAsPdfBtn"),a=this.dialog.querySelector("#worldNameInput"),l=this.dialog.querySelector("#gameDropZone"),s=this.dialog.querySelector("#fileInput");e.addEventListener("click",this.close),t.addEventListener("click",this.saveCurrentGame),n.addEventListener("click",this.loadSelectedGame),o.addEventListener("click",this.deleteSelectedGame),r.addEventListener("click",this.shareSelectedGame),i.addEventListener("click",this.shareSelectedGameAsPDF),a.addEventListener("keydown",this.handleWorldNameInput),l.addEventListener("dragover",this.handleDragOver),l.addEventListener("dragleave",this.handleDragLeave),l.addEventListener("drop",this.handleFileDrop),s.addEventListener("change",this.handleFileSelect)}removeEventListeners(){const e=this.dialog.querySelector("#closeStorageDialog"),t=this.dialog.querySelector("#saveToStorageBtn"),n=this.dialog.querySelector("#loadSelectedBtn"),o=this.dialog.querySelector("#deleteSelectedBtn"),r=this.dialog.querySelector("#shareSelectedBtn"),i=this.dialog.querySelector("#shareSelectedAsPdfBtn"),a=this.dialog.querySelector("#worldNameInput"),l=this.dialog.querySelector("#gameDropZone"),s=this.dialog.querySelector("#fileInput");e.removeEventListener("click",this.close),t.removeEventListener("click",this.saveCurrentGame),n.removeEventListener("click",this.loadSelectedGame),o.removeEventListener("click",this.deleteSelectedGame),r.removeEventListener("click",this.shareSelectedGame),i.removeEventListener("click",this.shareSelectedGameAsPDF),a.removeEventListener("keydown",this.handleWorldNameInput),l.removeEventListener("dragover",this.handleDragOver),l.removeEventListener("dragleave",this.handleDragLeave),l.removeEventListener("drop",this.handleFileDrop),s.removeEventListener("change",this.handleFileSelect)}handleDragOver(e){e.preventDefault(),e.stopPropagation();const t=this.dialog.querySelector("#gameDropZone");t instanceof HTMLElement&&(t.style.borderColor="var(--bg-color-blue-500)",t.style.backgroundColor="rgba(100, 200, 255, 0.1)")}handleDragLeave(e){e.preventDefault(),e.stopPropagation();const t=this.dialog.querySelector("#gameDropZone");t instanceof HTMLElement&&(t.style.borderColor="var(--bg-color-gray-400)",t.style.backgroundColor="")}handleFileDrop(e){e.preventDefault(),e.stopPropagation();const t=this.dialog.querySelector("#gameDropZone");t instanceof HTMLElement&&(t.style.borderColor="var(--bg-color-gray-400)",t.style.backgroundColor="");const n=e.dataTransfer.files;this.processFiles(n)}handleFileSelect(e){const t=e.target.files;this.processFiles(t)}async processFiles(e){for(const t of e)if(t.name.endsWith(".bgs")||t.name.endsWith(".txt")||t.name.endsWith(".pdf"))try{const e=await t.arrayBuffer();await this.loadGameFromFile(e,t.name)}catch(e){console.error(`Failed to load file ${t.name}:`,e),alert(`Failed to load file: ${t.name}. Check console for details.`)}else console.warn(`Skipping file ${t.name}: invalid extension`)}async loadGameFromFile(e,t){try{let n;if(t.endsWith(".txt")){n=(new TextDecoder).decode(e)}else if(t.endsWith(".pdf")){const[t]=await f(e);n=await G(new Blob([t.data]))}else{const t=new globalThis.Blob([e],{type:"application/gzip"});if(!("DecompressionStream"in globalThis))throw new Error("DecompressionStream not supported");{const e=t.stream().pipeThrough(new globalThis.DecompressionStream("gzip")),o=await new globalThis.Response(e).blob();n=await o.text()}}const o=JSON.parse(n);await N(globalThis,this.shadow,o);const{seed:r}=o.config,i=this.doc.getElementById("seedInput"),a=this.doc.getElementById("currentSeed");i instanceof HTMLInputElement&&(i.value=r),a&&(a.textContent=r),console.log(`Game loaded from file: ${t}`);const l=this.dialog.querySelector("#fileInput");l instanceof HTMLInputElement&&(l.value=""),this.close()}catch(e){throw console.error(`Failed to process game file ${t}:`,e),e}}async saveCurrentGame(){const e=this.dialog.querySelector("#worldNameInput");let t;if(e instanceof HTMLInputElement&&(t=e.value.trim()),t)try{const n=m(globalThis.blockGarden.state.world,globalThis),o=JSON.stringify(n),r=await Y(o),i=await r.arrayBuffer(),l=v(globalThis,i),s={name:t,timestamp:Date.now(),data:l},c=`${H}${Date.now()}-${t.replace(/[^a-zA-Z0-9]/g,"_")}`;await a.setItem(c,s),console.log("Game saved to storage:",t),e instanceof HTMLInputElement&&(e.value=""),await this.loadSavedGamesList()}catch(e){console.error("Failed to save game to storage:",e),alert("Failed to save game. Check console for details.")}else alert("Please enter a world name")}async loadSelectedGame(){const e=this.dialog.querySelector('input[name="selectedGame"]:checked');if(!e)return;let t;if(e instanceof HTMLInputElement){const n=parseInt(e.value);t=this.savedGames[n]}try{const e=y(globalThis,t.data,"application/gzip");let n;if(!("DecompressionStream"in globalThis))throw new Error("DecompressionStream not supported");{const t=e.stream().pipeThrough(new globalThis.DecompressionStream("gzip")),o=await new globalThis.Response(t).blob();n=await o.text()}const o=JSON.parse(n);await N(globalThis,this.shadow,o),this.close()}catch(e){console.error("Failed to load game from storage:",e),alert("Failed to load game. Check console for details.")}}async deleteSelectedGame(){const e=this.dialog.querySelector('input[name="selectedGame"]:checked');if(!e)return;let t;if(e instanceof HTMLInputElement){const n=parseInt(e.value);t=this.savedGames[n]}if(confirm(`Are you sure you want to delete "${t.name}"?`))try{await a.removeItem(t.key),console.log("Game deleted from storage:",t.name),await this.loadSavedGamesList()}catch(e){console.error("Failed to delete game from storage:",e),alert("Failed to delete game. Check console for details.")}}async getPDFGameStateAttachment(){const e=M(),t=await import("https://cdn.jsdelivr.net/npm/pdf-lib@1.17.1/+esm"),{PDFDocument:n,StandardFonts:o,rgb:r}=t,{game:i,pngSave:a}=await this.getSelectedGameAsPNG(),l=await a.arrayBuffer();let s;if("DecompressionStream"in globalThis){const e=y(globalThis,i.data,"application/gzip").stream().pipeThrough(new globalThis.DecompressionStream("gzip")),t=await new globalThis.Response(e).blob(),n=await t.text();s=JSON.parse(n)}const c=await n.create(),d=c.addPage([800,1100]),{width:g,height:u}=d.getSize(),I=await c.embedFont(o.HelveticaBold),h=await c.embedFont(o.Helvetica);r(.22,.55,.85);const b=r(.68,.68,.68),m=r(.97,.97,.97),C=r(.6,.6,.6),A=r(.1,.1,.1),p=r(.2,.65,.35);d.drawRectangle({x:0,y:0,width:g,height:u,color:m});const v="Block Garden",f=I.widthOfTextAtSize(v,38),w=(g-f)/2,G=u-80;d.drawText(v,{x:w+2,y:G-2,size:38,font:I,color:b}),d.drawText(v,{x:w,y:G,size:38,font:I,color:p});const k=c.context.obj({Type:"Annot",Subtype:"Link",Rect:[w,G,w+f,G+38],Border:[0,0,0],A:c.context.obj({Type:"Action",S:"URI",URI:t.PDFString.of("https://kherrick.github.io/block-garden/")})}),S="Game Save",Z=(g-I.widthOfTextAtSize(S,24))/2,W=G-35;d.drawText(S,{x:Z,y:W,size:24,font:h,color:A});const L=await c.embedPng(l),R=.65*L.width,B=.65*L.height,x=W-B-40,T=(g-R)/2;d.drawRectangle({x:T-4,y:x-4,width:R+8,height:B+8,borderWidth:1,borderColor:C,color:r(1,1,1)}),d.drawImage(L,{x:T,y:x,width:R,height:B});let E="https://kherrick.github.io/block-garden/";if(!0===globalThis?.blockGarden?.config?.linkGameSave?.get()){E+=`?gameSave=${E}assets/game-saves/${X(i.name)}.pdf`}else{const e=s?.config?.seed;e&&(E+=`?seed=${s.config.seed}`)}const N=c.context.obj({Type:"Annot",Subtype:"Link",Rect:[T,x,T+R,x+B],Border:[0,0,0],A:c.context.obj({Type:"Action",S:"URI",URI:t.PDFString.of(E)})}),Y=d.node.get(t.PDFName.of("Annots"));Y?(Y.push(k),Y.push(N)):d.node.set(t.PDFName.of("Annots"),c.context.obj([k,N]));const V=s?.state?.seedInventory||{};Object.values(V).reduce((e,t)=>e+t,0);const D=x-30-390,J=g-160,z=(g-J)/2;d.drawRectangle({x:z,y:D,width:J,height:390,borderWidth:2,borderColor:A,color:m});const F=(new Date).toLocaleString(void 0,{dateStyle:"medium",timeStyle:"short"});let P=D+390-25;const j=z+20;!1===globalThis?.blockGarden?.config?.linkGameSave?.get()&&(d.drawText("Saved On:",{x:j,y:P,size:12,font:I,color:A}),d.drawText(F,{x:j+I.widthOfTextAtSize("Saved On: ",12),y:P,size:12,font:h,color:A}),P-=18),d.drawText("World Name:",{x:j,y:P,size:12,font:I,color:A}),d.drawText(i.name,{x:j+I.widthOfTextAtSize("World Name: ",12),y:P,size:12,font:h,color:A}),P-=18,P-=18;const O=["## Quick Start","","- Movement: w / a / s / d","- Inventory: e","- Camera: Arrow Keys","- Change Block: ~ / `  ","- Jump / Ascend: Space","- Descend: Shift","- Place / Remove Block: Enter","- Click Game Canvas To Lock Mouse","  - Use crosshair to center block placement","  - Left Click: Place Block","  - Right Click: Remove Block"];let U=P;for(let e=0;e<O.length;e++){const t=O[e],n=t.startsWith("## "),o=n?11:9;d.drawText(n?t.replace("## ",""):t,{x:j,y:U,size:o,font:h,color:A}),U-=n?14:12}P=U;const H="Generated by Block Garden";d.drawText(H,{x:(g-h.widthOfTextAtSize(H,12))/2,y:40,size:12,font:h,color:p});let _="";_=!0===globalThis?.blockGarden?.config?.linkGameSave?.get()?"block-garden-game-card.png":`block-garden-game-card-${e}.png`,c.attach(new Uint8Array(l),_,{mimeType:"image/png",description:"Block Garden Game Card"});const K=await c.save(),Q=new Blob([K],{type:"application/pdf"});let q="";return q=!0===globalThis?.blockGarden?.config?.linkGameSave?.get()?"Block-Garden-Game-Save.pdf":`Block-Garden-Game-Save-${e}.pdf`,{game:i,file:new File([Q],q,{type:Q.type,lastModified:Date.now()})}}async getSelectedGameAsPNG(){const e=this.dialog.querySelector('input[name="selectedGame"]:checked');if(!e)return;let t,n;if(e instanceof HTMLInputElement){const n=parseInt(e.value);t=this.savedGames[n]}if(!("DecompressionStream"in globalThis))throw new Error("DecompressionStream not supported");{const e=y(globalThis,t.data,"application/gzip").stream().pipeThrough(new globalThis.DecompressionStream("gzip")),o=await new globalThis.Response(e).blob();n=await o.text()}const o=J(globalThis.document,"block-garden").querySelector("canvas");return{game:t,pngSave:await async function(e,t,n=400){const o=JSON.stringify(t),r=document.createElement("canvas");r.width=n,r.height=n;const i=r.getContext("2d",{colorSpace:"srgb",willReadFrequently:!0}),a=e.getContext("2d");if(a&&a.getContextAttributes){const e=a.getContextAttributes();e.colorSpace&&e.colorSpace}const l=e.width,s=e.height,c=Math.min(l,s),d=(l-c)/2,g=(s-c)/2;i.drawImage(e,d,g,c,c,0,0,n,n);const u=await new Promise(e=>r.toBlob(e,"image/png"));if(!u)throw new Error("Failed to create PNG blob");const I=await u.arrayBuffer(),h=w(new Uint8Array(I),o);return new Blob([h],{type:"image/png"})}(o,n)}}async shareSelectedGameAsPDF(){const{game:e,file:t}=await this.getPDFGameStateAttachment();try{"undefined"!=typeof navigator&&void 0!==navigator.canShare&&navigator.canShare({files:[t]})?(await navigator.share({files:[t],title:"Block Garden Game Save",url:"https://kherrick.github.io/block-garden",text:`Visit Block Garden, then 'Load' and checkout my world: ${e.name}\n\n`}),console.log("Game shared successfully:",e.name)):alert("Web Share API is not available on this device or browser.")}catch(e){"AbortError"!==e.name?(console.error("Failed to share game:",e),alert("Failed to share game. Check console for details.")):console.log("Game sharing was cancelled by the user")}}async shareSelectedGame(){const e=M(),t=this.dialog.querySelector('input[name="selectedGame"]:checked');if(!t)return;let n,o;if(t instanceof HTMLInputElement){const e=parseInt(t.value);n=this.savedGames[e]}if(!("DecompressionStream"in globalThis))throw new Error("DecompressionStream not supported");{const e=y(globalThis,n.data,"application/gzip").stream().pipeThrough(new globalThis.DecompressionStream("gzip")),t=await new globalThis.Response(e).blob();o=await t.text()}try{const t=new Blob([o],{type:"text/plain"}),r=`Block-Garden-Game-Save-${e}.json.txt`,i=new File([t],r,{type:"text/plain"});"undefined"!=typeof navigator&&void 0!==navigator.canShare&&navigator.canShare({files:[i]})?(await navigator.share({files:[i],title:"Block Garden Game Save",url:"https://kherrick.github.io/block-garden",text:`Visit Block Garden, then 'Load' and checkout my world: ${n.name}\n\n`}),console.log("Game shared successfully:",n.name)):alert("Web Share API is not available on this device or browser.")}catch(e){"AbortError"!==e.name?(console.error("Failed to share game:",e),alert("Failed to share game. Check console for details.")):console.log("Game sharing was cancelled by the user")}}show(){this.dialog instanceof HTMLDialogElement&&this.dialog.showModal()}close(){this.removeEventListeners(),this.dialog instanceof HTMLDialogElement&&this.dialog.close()}}const ne={color:{"amber-500":"#f39c12","amber-800":"#8b4513","amber-900":"#654321","antique-white":"#fffacd",beige:"#f5f5dc","black-alpha-60":"#00000099","black-alpha-80":"#000000cc",black:"#000000","blue-400":"#4a90e2","blue-500":"#2196f3","blue-700":"#0066cc",bronze:"#b87333",brown:"#654321",burlywood:"#deb887",chocolate:"#d2691e",coral:"#ff7f50",crimson:"#dc143c","dark-brown":"#59392b","dark-clay":"#cd853f","dark-cyan":"#2f4f2f","dark-green":"#2e5930","dark-olive-green":"#556b2f","dark-orange":"#ff8c00","dark-red":"#8b0000","dark-sea-green-light":"#9bcd9b","dark-sea-green":"#4f7942","dark-slate-gray":"#2f4f4f","dark-tan":"#8b7355","deep-pink":"#ff1493","dim-gray":"#696969","dodger-blue":"#1e90ff","emerald-600":"#45a049","emerald-700":"#27ae60","forest-green":"#228b22",gold:"#ffd700",goldenrod:"#daa520","granite-gray-alpha-30":"#6464644d","gray-100":"#eeeeee","gray-200":"#e3e3e3","gray-300":"#e0e0e0","gray-400":"#dddddd","gray-50":"#f0f0f0","gray-500":"#cccccc","gray-600":"#bbbbbb","gray-700":"#888888","gray-800":"#666666","gray-900":"#333333","gray-alpha-10":"#ffffff1a","gray-alpha-20":"#ffffff33","gray-alpha-30":"#ffffff4d","gray-granite-alpha-30":"#6464644d","green-500":"#4caf50","green-yellow-400":"#adff2f","hot-pink":"#ff69b4","indian-red":"#cd5c5c",jet:"#1c1c1c",khaki:"#ffec8b","lawn-green":"#7cfc00","light-coral-pink":"#f08080","light-coral":"#ffa54f","light-pink":"#ffb6d9","light-sky-blue":"#87ceeb","light-steel-blue":"#c5d1d3","lime-400":"#32cd32","medium-purple":"#8a7fc8","medium-sea-green":"#3cb371","medium-slate-blue":"#9370db","misty-rose":"#ffe4e1","neutral-950":"#555","olive-drab-700":"#6b8e23","orange-500":"#ff6b35","orange-red":"#ff4500","pale-goldenrod":"#eee8aa","pale-green-200":"#90ee90","pale-green-300":"#98fb98",pink:"#ff69b4",plum:"#dda0dd","powder-blue":"#b0e0e6","red-500":"#ff4444","royal-blue":"#4169e1","saddle-brown":"#8b4513","sandy-brown":"#f4a460","sea-green":"#2e8b57","sky-300":"#87ceeb","sky-50":"#e6f3ff","stone-100":"#f1f1f1","stone-50":"#fffafa",tan:"#b8a99a",tomato:"#ff6347",white:"#ffffff","wood-brown":"#362200","yellow-400":"#ffff00","yellow-green-400":"#9acd32"},ui:{"touch-btn-background":"var(--bg-color-black-alpha-60)","touch-btn-border":"var(--bg-color-gray-alpha-30)","touch-btn":"var(--bg-color-white)","ui-grid-corner-container":"var(--bg-color-white)","ui-grid-corner-heading-background":"var(--black-alpha-80)","ui-grid-corner-heading-border":"var(--bg-color-gray-alpha-10)","ui-grid-corner-heading":"var(--bg-color-white)","ui-grid-corner-sub-heading":"var(--bg-color-white)"},block:{"agave-base":"var(--bg-color-lime-400)","agave-flower-stalk":"var(--bg-color-yellow-green-400)","agave-flower":"var(--bg-color-yellow-400)","agave-growing":"var(--bg-color-green-yellow-400)","agave-spike":"var(--bg-color-lawn-green)",agave:"var(--bg-color-lawn-green)",air:"var(--bg-color-sky-300)","bamboo-growing":"var(--bg-color-pale-green-300)","bamboo-joint":"var(--bg-color-olive-drab-700)","bamboo-leaves":"var(--bg-color-lime-400)","bamboo-stalk":"var(--bg-color-pale-green-200)",bamboo:"var(--bg-color-pale-green-200)",bedrock:"var(--bg-color-jet)","berry-bush-berries":"var(--bg-color-crimson)","berry-bush-branch":"var(--bg-color-saddle-brown)","berry-bush-growing":"var(--bg-color-indian-red)","berry-bush-leaves":"var(--bg-color-forest-green)","berry-bush":"var(--bg-color-crimson)","birch-bark":"var(--bg-color-white)","birch-branches":"var(--bg-color-dark-tan)","birch-catkins":"var(--bg-color-pale-goldenrod)","birch-growing":"var(--bg-color-antique-white)","birch-leaves":"var(--bg-color-pale-green-300)","birch-trunk":"var(--bg-color-beige)",birch:"var(--bg-color-beige)","cactus-body":"var(--bg-color-sea-green)","cactus-flower":"var(--bg-color-hot-pink)","cactus-growing":"var(--bg-color-forest-green)",cactus:"var(--bg-color-lime-400)","carrot-growing":"var(--bg-color-coral)","carrot-leaves":"var(--bg-color-forest-green)","carrot-root":"var(--bg-color-tomato)",carrot:"var(--bg-color-dark-orange)",clay:"var(--bg-color-dark-clay)",cloud:"var(--bg-color-light-steel-blue)",coal:"var(--bg-color-dark-slate-gray)","corn-ear":"var(--bg-color-pale-goldenrod)","corn-growing":"var(--bg-color-pale-goldenrod)","corn-leaves":"var(--bg-color-olive-drab-700)","corn-silk":"var(--bg-color-burlywood)","corn-stalk":"var(--bg-color-yellow-green-400)",corn:"var(--bg-color-pale-goldenrod)",dirt:"var(--bg-color-saddle-brown)","fern-frond":"var(--bg-color-medium-sea-green)","fern-growing":"var(--bg-color-pale-green-200)","fern-stem":"var(--bg-color-dark-olive-green)",fern:"var(--bg-color-medium-sea-green)",gold:"var(--bg-color-gold)",grass:"var(--bg-color-pale-green-200)",ice:"var(--bg-color-powder-blue)",iron:"var(--bg-color-bronze)","kelp-blade":"var(--bg-color-sea-green)","kelp-bulb":"var(--bg-color-dark-sea-green)","kelp-growing":"var(--bg-color-medium-slate-blue)",kelp:"var(--bg-color-dark-cyan)",lava:"var(--bg-color-orange-red)",link:"var(--bg-color-dodger-blue)","lavender-bush":"var(--bg-color-medium-purple)","lavender-flowers":"var(--bg-color-medium-slate-blue)","lavender-growing":"var(--bg-color-plum)","lavender-stem":"var(--bg-color-dark-olive-green)",lavender:"var(--bg-color-medium-slate-blue)","lotus-bud":"var(--bg-color-light-pink)","lotus-flower":"var(--bg-color-pink)","lotus-growing":"var(--bg-color-misty-rose)","lotus-pad":"var(--bg-color-medium-sea-green)","lotus-stem":"var(--bg-color-sea-green)",lotus:"var(--bg-color-pink)",moss:"var(--bg-color-dark-olive-green)","mushroom-cap":"var(--bg-color-dark-red)","mushroom-growing":"var(--bg-color-indian-red)","mushroom-stem":"var(--bg-color-chocolate)",mushroom:"var(--bg-color-dark-red)","pine-cone":"var(--bg-color-dark-tan)","pine-needles":"var(--bg-color-dark-green)","pine-tree-growing":"var(--bg-color-dark-olive-green)","pine-tree":"var(--bg-color-dark-green)","pine-trunk":"var(--bg-color-saddle-brown)",pumice:"var(--bg-color-tan)","pumpkin-fruit":"var(--bg-color-dark-orange)","pumpkin-growing":"var(--bg-color-light-coral)","pumpkin-leaves":"var(--bg-color-yellow-green-400)","pumpkin-stem":"var(--bg-color-saddle-brown)","pumpkin-vine":"var(--bg-color-olive-drab-700)",pumpkin:"var(--bg-color-dark-orange)","rose-bloom":"var(--bg-color-crimson)","rose-bud":"var(--bg-color-indian-red)","rose-growing":"var(--bg-color-light-coral-pink)","rose-leaves":"var(--bg-color-dark-cyan)","rose-stem":"var(--bg-color-brown)","rose-thorns":"var(--bg-color-saddle-brown)",rose:"var(--bg-color-crimson)",sand:"var(--bg-color-sandy-brown)",snow:"var(--bg-color-stone-50)",stone:"var(--bg-color-dim-gray)","sunflower-center":"var(--bg-color-saddle-brown)","sunflower-growing":"var(--bg-color-khaki)","sunflower-leaves":"var(--bg-color-forest-green)","sunflower-petals":"var(--bg-color-gold)","sunflower-stem":"var(--bg-color-dark-tan)",sunflower:"var(--bg-color-gold)","tree-growing":"var(--bg-color-yellow-green-400)","tree-leaves":"var(--bg-color-forest-green)","tree-trunk":"var(--bg-color-dark-brown)","tulip-bulb":"var(--bg-color-dark-tan)","tulip-growing":"var(--bg-color-light-pink)","tulip-leaves":"var(--bg-color-forest-green)","tulip-petals":"var(--bg-color-deep-pink)","tulip-stem":"var(--bg-color-olive-drab-700)",tulip:"var(--bg-color-deep-pink)",walnut:"var(--bg-color-brown)",water:"var(--bg-color-royal-blue)","wheat-grain":"var(--bg-color-goldenrod)","wheat-growing":"var(--bg-color-yellow-green-400)","wheat-stalk":"var(--bg-color-dark-tan)",wheat:"var(--bg-color-goldenrod)","willow-branches":"var(--bg-color-medium-slate-blue)","willow-leaves":"var(--bg-color-yellow-green-400)","willow-tree-growing":"var(--bg-color-dark-sea-green-light)","willow-tree":"var(--bg-color-medium-slate-blue)","willow-trunk":"var(--bg-color-dark-tan)",wood:"var(--bg-color-wood-brown)"}};var oe=Object.freeze({__proto__:null,colors:ne});function re(e,t){return Object.entries(t).map(([t,n])=>`${e}${t}${"--bg-color-"===e?"":"-color"}: ${n};`).join("\n")}var ie,ae={exports:{}};
/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */var le,se=(ie||(ie=1,le=ae,function(e,t,n,o){var r,i=["","webkit","Moz","MS","ms","o"],a=t.createElement("div"),l=Math.round,s=Math.abs,c=Date.now;function d(e,t,n){return setTimeout(C(e,n),t)}function g(e,t,n){return!!Array.isArray(e)&&(u(e,n[t],n),!0)}function u(e,t,n){var r;if(e)if(e.forEach)e.forEach(t,n);else if(e.length!==o)for(r=0;r<e.length;)t.call(n,e[r],r,e),r++;else for(r in e)e.hasOwnProperty(r)&&t.call(n,e[r],r,e)}function I(t,n,o){var r="DEPRECATED METHOD: "+n+"\n"+o+" AT \n";return function(){var n=new Error("get-stack-trace"),o=n&&n.stack?n.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",i=e.console&&(e.console.warn||e.console.log);return i&&i.call(e.console,r,o),t.apply(this,arguments)}}r="function"!=typeof Object.assign?function(e){if(e===o||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var r=arguments[n];if(r!==o&&null!==r)for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])}return t}:Object.assign;var h=I(function(e,t,n){for(var r=Object.keys(t),i=0;i<r.length;)(!n||n&&e[r[i]]===o)&&(e[r[i]]=t[r[i]]),i++;return e},"extend","Use `assign`."),b=I(function(e,t){return h(e,t,!0)},"merge","Use `assign`.");function m(e,t,n){var o,i=t.prototype;(o=e.prototype=Object.create(i)).constructor=e,o._super=i,n&&r(o,n)}function C(e,t){return function(){return e.apply(t,arguments)}}function A(e,t){return"function"==typeof e?e.apply(t&&t[0]||o,t):e}function p(e,t){return e===o?t:e}function v(e,t,n){u(G(t),function(t){e.addEventListener(t,n,!1)})}function y(e,t,n){u(G(t),function(t){e.removeEventListener(t,n,!1)})}function f(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function w(e,t){return e.indexOf(t)>-1}function G(e){return e.trim().split(/\s+/g)}function k(e,t,n){if(e.indexOf&&!n)return e.indexOf(t);for(var o=0;o<e.length;){if(n&&e[o][n]==t||!n&&e[o]===t)return o;o++}return-1}function S(e){return Array.prototype.slice.call(e,0)}function Z(e,t,n){for(var o=[],r=[],i=0;i<e.length;){var a=t?e[i][t]:e[i];k(r,a)<0&&o.push(e[i]),r[i]=a,i++}return n&&(o=t?o.sort(function(e,n){return e[t]>n[t]}):o.sort()),o}function W(e,t){for(var n,r,a=t[0].toUpperCase()+t.slice(1),l=0;l<i.length;){if((r=(n=i[l])?n+a:t)in e)return r;l++}return o}var L=1;function R(t){var n=t.ownerDocument||t;return n.defaultView||n.parentWindow||e}var B="ontouchstart"in e,x=W(e,"PointerEvent")!==o,T=B&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),E="touch",N="mouse",M=24,Y=["x","y"],V=["clientX","clientY"];function X(e,t){var n=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){A(e.options.enable,[e])&&n.handler(t)},this.init()}function D(e,t,n){var r=n.pointers.length,i=n.changedPointers.length,a=1&t&&r-i===0,l=12&t&&r-i===0;n.isFirst=!!a,n.isFinal=!!l,a&&(e.session={}),n.eventType=t,function(e,t){var n=e.session,r=t.pointers,i=r.length;n.firstInput||(n.firstInput=J(t)),i>1&&!n.firstMultiple?n.firstMultiple=J(t):1===i&&(n.firstMultiple=!1);var a=n.firstInput,l=n.firstMultiple,d=l?l.center:a.center,g=t.center=z(r);t.timeStamp=c(),t.deltaTime=t.timeStamp-a.timeStamp,t.angle=O(d,g),t.distance=j(d,g),function(e,t){var n=t.center,o=e.offsetDelta||{},r=e.prevDelta||{},i=e.prevInput||{};1!==t.eventType&&4!==i.eventType||(r=e.prevDelta={x:i.deltaX||0,y:i.deltaY||0},o=e.offsetDelta={x:n.x,y:n.y}),t.deltaX=r.x+(n.x-o.x),t.deltaY=r.y+(n.y-o.y)}(n,t),t.offsetDirection=P(t.deltaX,t.deltaY);var u,I,h=F(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=h.x,t.overallVelocityY=h.y,t.overallVelocity=s(h.x)>s(h.y)?h.x:h.y,t.scale=l?(u=l.pointers,j((I=r)[0],I[1],V)/j(u[0],u[1],V)):1,t.rotation=l?function(e,t){return O(t[1],t[0],V)+O(e[1],e[0],V)}(l.pointers,r):0,t.maxPointers=n.prevInput?t.pointers.length>n.prevInput.maxPointers?t.pointers.length:n.prevInput.maxPointers:t.pointers.length,function(e,t){var n,r,i,a,l=e.lastInterval||t,c=t.timeStamp-l.timeStamp;if(8!=t.eventType&&(c>25||l.velocity===o)){var d=t.deltaX-l.deltaX,g=t.deltaY-l.deltaY,u=F(c,d,g);r=u.x,i=u.y,n=s(u.x)>s(u.y)?u.x:u.y,a=P(d,g),e.lastInterval=t}else n=l.velocity,r=l.velocityX,i=l.velocityY,a=l.direction;t.velocity=n,t.velocityX=r,t.velocityY=i,t.direction=a}(n,t);var b=e.element;f(t.srcEvent.target,b)&&(b=t.srcEvent.target),t.target=b}(e,n),e.emit("hammer.input",n),e.recognize(n),e.session.prevInput=n}function J(e){for(var t=[],n=0;n<e.pointers.length;)t[n]={clientX:l(e.pointers[n].clientX),clientY:l(e.pointers[n].clientY)},n++;return{timeStamp:c(),pointers:t,center:z(t),deltaX:e.deltaX,deltaY:e.deltaY}}function z(e){var t=e.length;if(1===t)return{x:l(e[0].clientX),y:l(e[0].clientY)};for(var n=0,o=0,r=0;r<t;)n+=e[r].clientX,o+=e[r].clientY,r++;return{x:l(n/t),y:l(o/t)}}function F(e,t,n){return{x:t/e||0,y:n/e||0}}function P(e,t){return e===t?1:s(e)>=s(t)?e<0?2:4:t<0?8:16}function j(e,t,n){n||(n=Y);var o=t[n[0]]-e[n[0]],r=t[n[1]]-e[n[1]];return Math.sqrt(o*o+r*r)}function O(e,t,n){n||(n=Y);var o=t[n[0]]-e[n[0]],r=t[n[1]]-e[n[1]];return 180*Math.atan2(r,o)/Math.PI}X.prototype={handler:function(){},init:function(){this.evEl&&v(this.element,this.evEl,this.domHandler),this.evTarget&&v(this.target,this.evTarget,this.domHandler),this.evWin&&v(R(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&y(this.element,this.evEl,this.domHandler),this.evTarget&&y(this.target,this.evTarget,this.domHandler),this.evWin&&y(R(this.element),this.evWin,this.domHandler)}};var U={mousedown:1,mousemove:2,mouseup:4},H="mousedown",_="mousemove mouseup";function K(){this.evEl=H,this.evWin=_,this.pressed=!1,X.apply(this,arguments)}m(K,X,{handler:function(e){var t=U[e.type];1&t&&0===e.button&&(this.pressed=!0),2&t&&1!==e.which&&(t=4),this.pressed&&(4&t&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:N,srcEvent:e}))}});var Q={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},q={2:E,3:"pen",4:N,5:"kinect"},$="pointerdown",ee="pointermove pointerup pointercancel";function te(){this.evEl=$,this.evWin=ee,X.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}e.MSPointerEvent&&!e.PointerEvent&&($="MSPointerDown",ee="MSPointerMove MSPointerUp MSPointerCancel"),m(te,X,{handler:function(e){var t=this.store,n=!1,o=e.type.toLowerCase().replace("ms",""),r=Q[o],i=q[e.pointerType]||e.pointerType,a=i==E,l=k(t,e.pointerId,"pointerId");1&r&&(0===e.button||a)?l<0&&(t.push(e),l=t.length-1):12&r&&(n=!0),l<0||(t[l]=e,this.callback(this.manager,r,{pointers:t,changedPointers:[e],pointerType:i,srcEvent:e}),n&&t.splice(l,1))}});var ne={touchstart:1,touchmove:2,touchend:4,touchcancel:8};function oe(){this.evTarget="touchstart",this.evWin="touchstart touchmove touchend touchcancel",this.started=!1,X.apply(this,arguments)}function re(e,t){var n=S(e.touches),o=S(e.changedTouches);return 12&t&&(n=Z(n.concat(o),"identifier",!0)),[n,o]}m(oe,X,{handler:function(e){var t=ne[e.type];if(1===t&&(this.started=!0),this.started){var n=re.call(this,e,t);12&t&&n[0].length-n[1].length===0&&(this.started=!1),this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:E,srcEvent:e})}}});var ie={touchstart:1,touchmove:2,touchend:4,touchcancel:8},ae="touchstart touchmove touchend touchcancel";function se(){this.evTarget=ae,this.targetIds={},X.apply(this,arguments)}function ce(e,t){var n=S(e.touches),o=this.targetIds;if(3&t&&1===n.length)return o[n[0].identifier]=!0,[n,n];var r,i,a=S(e.changedTouches),l=[],s=this.target;if(i=n.filter(function(e){return f(e.target,s)}),1===t)for(r=0;r<i.length;)o[i[r].identifier]=!0,r++;for(r=0;r<a.length;)o[a[r].identifier]&&l.push(a[r]),12&t&&delete o[a[r].identifier],r++;return l.length?[Z(i.concat(l),"identifier",!0),l]:void 0}function de(){X.apply(this,arguments);var e=C(this.handler,this);this.touch=new se(this.manager,e),this.mouse=new K(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}function ge(e,t){1&e?(this.primaryTouch=t.changedPointers[0].identifier,ue.call(this,t)):12&e&&ue.call(this,t)}function ue(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var n={x:t.clientX,y:t.clientY};this.lastTouches.push(n);var o=this.lastTouches;setTimeout(function(){var e=o.indexOf(n);e>-1&&o.splice(e,1)},2500)}}function Ie(e){for(var t=e.srcEvent.clientX,n=e.srcEvent.clientY,o=0;o<this.lastTouches.length;o++){var r=this.lastTouches[o],i=Math.abs(t-r.x),a=Math.abs(n-r.y);if(i<=25&&a<=25)return!0}return!1}m(se,X,{handler:function(e){var t=ie[e.type],n=ce.call(this,e,t);n&&this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:E,srcEvent:e})}}),m(de,X,{handler:function(e,t,n){var o=n.pointerType==E,r=n.pointerType==N;if(!(r&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(o)ge.call(this,t,n);else if(r&&Ie.call(this,n))return;this.callback(e,t,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var he=W(a.style,"touchAction"),be=he!==o,me="compute",Ce="auto",Ae="manipulation",pe="none",ve="pan-x",ye="pan-y",fe=function(){if(!be)return!1;var t={},n=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(o){t[o]=!n||e.CSS.supports("touch-action",o)}),t}();function we(e,t){this.manager=e,this.set(t)}we.prototype={set:function(e){e==me&&(e=this.compute()),be&&this.manager.element.style&&fe[e]&&(this.manager.element.style[he]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return u(this.manager.recognizers,function(t){A(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))}),function(e){if(w(e,pe))return pe;var t=w(e,ve),n=w(e,ye);return t&&n?pe:t||n?t?ve:ye:w(e,Ae)?Ae:Ce}(e.join(" "))},preventDefaults:function(e){var t=e.srcEvent,n=e.offsetDirection;if(this.manager.session.prevented)t.preventDefault();else{var o=this.actions,r=w(o,pe)&&!fe[pe],i=w(o,ye)&&!fe[ye],a=w(o,ve)&&!fe[ve];if(r){var l=1===e.pointers.length,s=e.distance<2,c=e.deltaTime<250;if(l&&s&&c)return}if(!a||!i)return r||i&&6&n||a&&n&M?this.preventSrc(t):void 0}},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};var Ge=32;function ke(e){this.options=r({},this.defaults,e||{}),this.id=L++,this.manager=null,this.options.enable=p(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function Se(e){return 16&e?"cancel":8&e?"end":4&e?"move":2&e?"start":""}function Ze(e){return 16==e?"down":8==e?"up":2==e?"left":4==e?"right":""}function We(e,t){var n=t.manager;return n?n.get(e):e}function Le(){ke.apply(this,arguments)}function Re(){Le.apply(this,arguments),this.pX=null,this.pY=null}function Be(){Le.apply(this,arguments)}function xe(){ke.apply(this,arguments),this._timer=null,this._input=null}function Te(){Le.apply(this,arguments)}function Ee(){Le.apply(this,arguments)}function Ne(){ke.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Me(e,t){return(t=t||{}).recognizers=p(t.recognizers,Me.defaults.preset),new Ye(e,t)}function Ye(e,t){var n;this.options=r({},Me.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new((n=this).options.inputClass||(x?te:T?se:B?de:K))(n,D),this.touchAction=new we(this,this.options.touchAction),Ve(this,!0),u(this.options.recognizers,function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])},this)}function Ve(e,t){var n,o=e.element;o.style&&(u(e.options.cssProps,function(r,i){n=W(o.style,i),t?(e.oldCssProps[n]=o.style[n],o.style[n]=r):o.style[n]=e.oldCssProps[n]||""}),t||(e.oldCssProps={}))}ke.prototype={defaults:{},set:function(e){return r(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(g(e,"recognizeWith",this))return this;var t=this.simultaneous;return t[(e=We(e,this)).id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return g(e,"dropRecognizeWith",this)||(e=We(e,this),delete this.simultaneous[e.id]),this},requireFailure:function(e){if(g(e,"requireFailure",this))return this;var t=this.requireFail;return-1===k(t,e=We(e,this))&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(g(e,"dropRequireFailure",this))return this;e=We(e,this);var t=k(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){var t=this,n=this.state;function o(n){t.manager.emit(n,e)}n<8&&o(t.options.event+Se(n)),o(t.options.event),e.additionalEvent&&o(e.additionalEvent),n>=8&&o(t.options.event+Se(n))},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=Ge},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(33&this.requireFail[e].state))return!1;e++}return!0},recognize:function(e){var t=r({},e);if(!A(this.options.enable,[this,t]))return this.reset(),void(this.state=Ge);56&this.state&&(this.state=1),this.state=this.process(t),30&this.state&&this.tryEmit(t)},process:function(e){},getTouchAction:function(){},reset:function(){}},m(Le,ke,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,n=e.eventType,o=6&t,r=this.attrTest(e);return o&&(8&n||!r)?16|t:o||r?4&n?8|t:2&t?4|t:2:Ge}}),m(Re,Le,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var e=this.options.direction,t=[];return 6&e&&t.push(ye),e&M&&t.push(ve),t},directionTest:function(e){var t=this.options,n=!0,o=e.distance,r=e.direction,i=e.deltaX,a=e.deltaY;return r&t.direction||(6&t.direction?(r=0===i?1:i<0?2:4,n=i!=this.pX,o=Math.abs(e.deltaX)):(r=0===a?1:a<0?8:16,n=a!=this.pY,o=Math.abs(e.deltaY))),e.direction=r,n&&o>t.threshold&&r&t.direction},attrTest:function(e){return Le.prototype.attrTest.call(this,e)&&(2&this.state||!(2&this.state)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=Ze(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}}),m(Be,Le,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[pe]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||2&this.state)},emit:function(e){if(1!==e.scale){var t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}this._super.emit.call(this,e)}}),m(xe,ke,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Ce]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,o=e.distance<t.threshold,r=e.deltaTime>t.time;if(this._input=e,!o||!n||12&e.eventType&&!r)this.reset();else if(1&e.eventType)this.reset(),this._timer=d(function(){this.state=8,this.tryEmit()},t.time,this);else if(4&e.eventType)return 8;return Ge},reset:function(){clearTimeout(this._timer)},emit:function(e){8===this.state&&(e&&4&e.eventType?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=c(),this.manager.emit(this.options.event,this._input)))}}),m(Te,Le,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[pe]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||2&this.state)}}),m(Ee,Le,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return Re.prototype.getTouchAction.call(this)},attrTest:function(e){var t,n=this.options.direction;return 30&n?t=e.overallVelocity:6&n?t=e.overallVelocityX:n&M&&(t=e.overallVelocityY),this._super.attrTest.call(this,e)&&n&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&s(t)>this.options.velocity&&4&e.eventType},emit:function(e){var t=Ze(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),m(Ne,ke,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Ae]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,o=e.distance<t.threshold,r=e.deltaTime<t.time;if(this.reset(),1&e.eventType&&0===this.count)return this.failTimeout();if(o&&r&&n){if(4!=e.eventType)return this.failTimeout();var i=!this.pTime||e.timeStamp-this.pTime<t.interval,a=!this.pCenter||j(this.pCenter,e.center)<t.posThreshold;if(this.pTime=e.timeStamp,this.pCenter=e.center,a&&i?this.count+=1:this.count=1,this._input=e,0===this.count%t.taps)return this.hasRequireFailures()?(this._timer=d(function(){this.state=8,this.tryEmit()},t.interval,this),2):8}return Ge},failTimeout:function(){return this._timer=d(function(){this.state=Ge},this.options.interval,this),Ge},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Me.VERSION="2.0.7",Me.defaults={domEvents:!1,touchAction:me,enable:!0,inputTarget:null,inputClass:null,preset:[[Te,{enable:!1}],[Be,{enable:!1},["rotate"]],[Ee,{direction:6}],[Re,{direction:6},["swipe"]],[Ne],[Ne,{event:"doubletap",taps:2},["tap"]],[xe]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},Ye.prototype={set:function(e){return r(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?2:1},recognize:function(e){var t=this.session;if(!t.stopped){var n;this.touchAction.preventDefaults(e);var o=this.recognizers,r=t.curRecognizer;(!r||r&&8&r.state)&&(r=t.curRecognizer=null);for(var i=0;i<o.length;)n=o[i],2===t.stopped||r&&n!=r&&!n.canRecognizeWith(r)?n.reset():n.recognize(e),!r&&14&n.state&&(r=t.curRecognizer=n),i++}},get:function(e){if(e instanceof ke)return e;for(var t=this.recognizers,n=0;n<t.length;n++)if(t[n].options.event==e)return t[n];return null},add:function(e){if(g(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(g(e,"remove",this))return this;if(e=this.get(e)){var t=this.recognizers,n=k(t,e);-1!==n&&(t.splice(n,1),this.touchAction.update())}return this},on:function(e,t){if(e!==o&&t!==o){var n=this.handlers;return u(G(e),function(e){n[e]=n[e]||[],n[e].push(t)}),this}},off:function(e,t){if(e!==o){var n=this.handlers;return u(G(e),function(e){t?n[e]&&n[e].splice(k(n[e],t),1):delete n[e]}),this}},emit:function(e,n){this.options.domEvents&&function(e,n){var o=t.createEvent("Event");o.initEvent(e,!0,!0),o.gesture=n,n.target.dispatchEvent(o)}(e,n);var o=this.handlers[e]&&this.handlers[e].slice();if(o&&o.length){n.type=e,n.preventDefault=function(){n.srcEvent.preventDefault()};for(var r=0;r<o.length;)o[r](n),r++}},destroy:function(){this.element&&Ve(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},r(Me,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:Ge,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:M,DIRECTION_ALL:30,Manager:Ye,Input:X,TouchAction:we,TouchInput:se,MouseInput:K,PointerEventInput:te,TouchMouseInput:de,SingleTouchInput:oe,Recognizer:ke,AttrRecognizer:Le,Tap:Ne,Pan:Re,Swipe:Ee,Pinch:Be,Rotate:Te,Press:xe,on:v,off:y,each:u,merge:b,extend:h,assign:r,inherit:m,bindFn:C,prefixed:W}),(void 0!==e?e:"undefined"!=typeof self?self:{}).Hammer=Me,le.exports?le.exports=Me:e.Hammer=Me}(window,document)),ae.exports),ce=t(se);function de(e,t){for(const[n,o]of Object.entries(t))e.host instanceof HTMLElement&&e.host.style.setProperty(n,o)}function ge(e,t){const n=e.createElement("canvas").getContext("2d");n.fillStyle=t;const o=n.fillStyle,r=o.match(/^#([0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/i);if(r){let e=r[1];3!==e.length&&4!==e.length||(e=e.split("").map(e=>e+e).join(""));return[parseInt(e.substring(0,2),16),parseInt(e.substring(2,4),16),parseInt(e.substring(4,6),16)]}const i=o.match(/^rgba?\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)/i);return i?[parseInt(i[1]),parseInt(i[2]),parseInt(i[3])]:[0,0,0]}function ue(e,t){let n;for(const o of t){n||(n={});const t=o.startsWith("--bg-color-")?o:`${o}-color`;n[t]=e.getPropertyValue(t)}return n}function Ie(e,t){const n=e.getComputedStyle(t.host);return{...ue(n,Object.keys(ne.color).map(e=>`--bg-color-${e}`)),...ue(n,Object.keys(ne.block).map(e=>`--bg-block-${e}`)),...ue(n,Object.keys(ne.ui).map(e=>`--bg-ui-${e}`))}}function he(e){return[e[0]/255,e[1]/255,e[2]/255,e.length>3?e[3]:1]}function be(e={},t="--bg-",n="",o=e=>e){let r;for(const[i,a]of Object.entries(e)){if(r||(r={}),!i.startsWith(t))continue;let e=i.slice(t.length);e=e.slice(0,n.length>0?-n.length:void 0);r[o(e)]=a.trim().replace(/^['"]|['"]$/g,"")}return r}function me(e,t){let n;return function(...o){clearTimeout(n),n=setTimeout(()=>e.apply(this,o),t)}}const Ce="block-garden-custom-colors";class Ae{constructor(e,t,n){this.gThis=e,this.doc=t,this.shadow=n,this.dialog=null,this.colors={},this.originalColors={},this.close=this.close.bind(this),this.handleColorChange=this.handleColorChange.bind(this),this.handleDialogClose=this.handleDialogClose.bind(this),this.handleDialogKeydown=this.handleDialogKeydown.bind(this),this.handleReset=this.handleReset.bind(this),this.handleSave=this.handleSave.bind(this),this.dirty=!1}async createDialog(){this.dialog&&this.dialog.remove(),this.originalColors=Ie(this.gThis,this.shadow),this.colors={...this.originalColors};const e=this.doc.createElement("dialog");return e.setAttribute("id","customizeColorsDialog"),e.addEventListener("close",this.handleDialogClose),e.addEventListener("keydown",this.handleDialogKeydown),e.style.cssText="\n      background: var(--bg-color-gray-50);\n      border-radius: 0.5rem;\n      border: 0.125rem solid var(--bg-color-gray-900);\n      color: var(--bg-color-gray-900);\n      font-family: monospace;\n      max-height: 80vh;\n      max-width: 30rem;\n      overflow-y: auto;\n      padding: 1.25rem;\n      width: 90%;\n    ",e.innerHTML='\n      <div style="\n        align-items: center;\n        display: flex;\n        justify-content: space-between;\n        margin-bottom: 0.9375rem;\n      ">\n        <h3 style="margin: 0">Customize Colors</h3>\n        <button\n          id="closeColorDialog"\n          style="\n            background: var(--bg-color-red-500);\n            border-radius: 0.25rem;\n            border: none;\n            color: var(--bg-color-white);\n            cursor: pointer;\n            font-size: 1.2rem;\n            padding: 0.5rem 1rem;\n          "\n        >\n          &times;\n        </button>\n      </div>\n\n      <div style="margin-bottom: 1rem;">\n        <p style="color: var(--bg-color-gray-700); font-size: 0.875rem; margin: 0 0 0.5rem 0;">\n          Customize the color palette for Block Garden. Changes are applied in real-time and saved automatically.\n        </p>\n      </div>\n\n      <div id="colorInputsContainer" style="\n        display: grid;\n        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));\n        gap: 1rem;\n        margin-bottom: 1rem;\n      ">\n        \x3c!-- Color inputs will be generated here --\x3e\n      </div>\n\n      <div style="border-top: 1px solid var(--bg-color-gray-300); display: flex; gap: 0.625rem; justify-content: flex-end; padding-top: 1rem;">\n        <button\n          id="resetColorsBtn"\n          style="\n            background: var(--bg-color-orange-500);\n            border-radius: 0.25rem;\n            border: none;\n            color: white;\n            cursor: pointer;\n            padding: 0.5rem 0.9375rem;\n          "\n        >\n          Reset to Defaults\n        </button>\n        <button\n          id="saveColorsBtn"\n          style="\n            background: var(--bg-color-green-500);\n            border-radius: 0.25rem;\n            border: none;\n            color: white;\n            cursor: pointer;\n            padding: 0.5rem 0.9375rem;\n          "\n        >\n          Save & Close\n        </button>\n      </div>\n    ',this.shadow.append(e),this.dialog=e,this.renderColorInputs(),this.initEventListeners(),e}async handleSave(){await async function(e,t){try{await a.setItem(t,e),console.log("Saved custom colors")}catch(e){console.error("Failed to save colors:",e)}}(this.colors,Ce),await de(this.shadow,this.colors),this.shadow.dispatchEvent(new CustomEvent("block-garden-reset",{detail:{colors:this.colors}})),this.dirty=!1,this.close()}async handleReset(){confirm("Reset all colors to defaults and close? This cannot be undone.")&&(await async function(e,t,n){try{await a.removeItem(n);const o=Ie(e,t);for(const e of Object.keys(o))t.host instanceof HTMLElement&&t.host.style.removeProperty(e);console.log("Reset to default colors")}catch(e){console.error("Failed to reset colors:",e)}}(this.gThis,this.shadow,Ce),this.shadow.dispatchEvent(new CustomEvent("block-garden-reset",{detail:{colors:null}})),this.dirty=!1,this.close())}renderColorInputs(){const e=this.dialog.querySelector("#colorInputsContainer"),t={};for(const[e,n]of Object.entries(this.colors)){const o=e.match(/--bg-?([a-z]+)-/),r=o?o[1]:"other";["host","touch","ui"].includes(r)||(t[r]||(t[r]=[]),t[r].push({property:e,value:n.slice(0,7)}))}const n=Object.keys(t).sort();for(const o of n){const n=this.doc.createElement("div");n.style.cssText="\n        grid-column: 1 / -1;\n        margin-top: 1rem;\n      ";const r=this.doc.createElement("h4");r.textContent=(o.charAt(0).toUpperCase()+o.slice(1)).replace("Block","Blocks"),r.style.cssText="\n        border-bottom: 1px solid var(--bg-color-gray-300);\n        color: var(--bg-color-gray-800);\n        font-size: 1rem;\n        margin: 0 0 0.5rem 0;\n        padding-bottom: 0.25rem;\n      ",n.append(r);const[i]=t[o];i.property.startsWith("--bg-color")&&n.setAttribute("hidden","hidden"),e.append(n);for(const{property:n,value:r}of t[o]){const t=this.doc.createElement("div");t.style.cssText="\n          display: flex;\n          flex-direction: column;\n          gap: 0.25rem;\n        ",n.startsWith("--bg-color")&&t.setAttribute("hidden","hidden");const o=this.doc.createElement("label");o.textContent=n.replace("--bg-","").replace(/-/g," ").replace("block ","").replace("color ","").replace(" color",""),o.style.cssText="\n          color: var(--bg-color-gray-700);\n          font-size: 0.75rem;\n          text-transform: capitalize;\n        ";const i=this.doc.createElement("div");i.style.cssText="\n          align-items: center;\n          display: flex;\n          gap: 0.5rem;\n        ";const a=this.doc.createElement("input");a.type="color",a.value=this.normalizeColor(r),a.dataset.property=n,a.style.cssText="\n          border-radius: 0.25rem;\n          border: 1px solid var(--bg-color-gray-400);\n          cursor: pointer;\n          height: 2rem;\n          width: 3rem;\n        ";const l=this.doc.createElement("input");l.type="text",l.value=r,l.dataset.property=n,l.style.cssText="\n          border-radius: 0.25rem;\n          border: 1px solid var(--bg-color-gray-400);\n          flex: 1;\n          font-family: monospace;\n          font-size: 0.75rem;\n          padding: 0.25rem;\n        ";const s=me(()=>{this.handleColorChange(n,l.value)},500);a.addEventListener("input",e=>{e.target instanceof HTMLInputElement&&(l.value=e.target.value,s())}),l.addEventListener("input",e=>{if(e.target instanceof HTMLInputElement){const t=this.normalizeColor(e.target.value);t&&(a.value=t),s()}}),i.append(a),i.append(l),t.append(o),t.append(i),e.append(t)}}}normalizeColor(e){if(!e)return"#000000";if(e.startsWith("#"))return 7===e.length?e:"#000000";const t=this.doc.createElement("canvas").getContext("2d");return t.fillStyle=e,t.fillStyle}handleColorChange(e,t){this.colors[e]=t,this.dirty=!0;const n=this.shadow.host;n instanceof HTMLElement&&(n.style.setProperty(e,t),this.shadow.dispatchEvent(new CustomEvent("block-garden-reset",{detail:{colors:this.colors}})))}initEventListeners(){const e=this.dialog.querySelector("#closeColorDialog"),t=this.dialog.querySelector("#saveColorsBtn"),n=this.dialog.querySelector("#resetColorsBtn");e.addEventListener("click",this.close),t.addEventListener("click",this.handleSave),n.addEventListener("click",this.handleReset)}show(){this.dialog instanceof HTMLDialogElement&&this.dialog.showModal()}handleDialogKeydown(e){"Escape"===e.key&&(e.preventDefault(),this.close())}close(){this.dirty?confirm("Close without saving?")&&(de(this.shadow,this.originalColors),requestAnimationFrame(()=>{this.shadow.dispatchEvent(new CustomEvent("block-garden-reset",{detail:{colors:this.originalColors}}))}),this.dialog instanceof HTMLDialogElement&&this.dialog.close()):this.dialog instanceof HTMLDialogElement&&this.dialog.close()}handleDialogClose(){this.removeEventListeners(),this.dialog.remove()}removeEventListeners(){const e=this.dialog.querySelector("#closeColorDialog"),t=this.dialog.querySelector("#saveColorsBtn"),n=this.dialog.querySelector("#resetColorsBtn");e.removeEventListener("click",this.close),t.removeEventListener("click",this.handleSave),n.removeEventListener("click",this.handleReset)}}const pe=()=>new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);function ve(e,{x:t,y:n,z:o},{yaw:r,pitch:i}){const a=Math,l=a.sin(r)*a.cos(i),s=a.sin(i),c=a.cos(r)*a.cos(i);let d=a.floor(t),g=a.floor(n),u=a.floor(o);const I=l>0?1:-1,h=s>0?1:-1,b=c>0?1:-1;let m,C,A,p,v,y;if(0!==l){p=I/l;m=(I>0?d+1-t:t-d)/a.abs(l)}else p=1/0,m=1/0;if(0!==s){v=h/s;C=(h>0?g+1-n:n-g)/a.abs(s)}else v=1/0,C=1/0;if(0!==c){y=b/c;A=(b>0?u+1-o:o-u)/a.abs(c)}else y=1/0,A=1/0;let f=0,w=0,G=0,k=0;for(;f<16;){const t=`${d},${g},${u}`;if(e.has(t))return{x:d,y:g,z:u,face:{x:w,y:G,z:k}};m<C?m<A?(d+=I,f=m,m+=p,w=-I,G=0,k=0):(u+=b,f=A,A+=y,w=0,G=0,k=-b):C<A?(g+=h,f=C,C+=v,w=0,G=-h,k=0):(u+=b,f=A,A+=y,w=0,G=0,k=-b)}return null}const ye={AIR:"Air",AGAVE_BASE:"Agave Base",AGAVE_FLOWER_STALK:"Agave Flower Stalk",AGAVE_FLOWER:"Agave Flower",AGAVE_GROWING:"Agave Growing",AGAVE_SPIKE:"Agave Spike",AGAVE:"Agave",BAMBOO_GROWING:"Bamboo Growing",BAMBOO_JOINT:"Bamboo Joint",BAMBOO_LEAVES:"Bamboo Leaves",BAMBOO_STALK:"Bamboo Stalk",BAMBOO:"Bamboo",BEDROCK:"Bedrock",BERRY_BUSH_BERRIES:"Berry Bush Berries",BERRY_BUSH_BRANCH:"Berry Bush Branch",BERRY_BUSH_GROWING:"Berry Bush Growing",BERRY_BUSH_LEAVES:"Berry Bush Leaves",BERRY_BUSH:"Berry Bush",BIRCH_BARK:"Birch Bark",BIRCH_BRANCHES:"Birch Branches",BIRCH_CATKINS:"Birch Catkins",BIRCH_GROWING:"Birch Growing",BIRCH_LEAVES:"Birch Leaves",BIRCH_TRUNK:"Birch Trunk",BIRCH:"Birch",CACTUS_BODY:"Cactus Body",CACTUS_FLOWER:"Cactus Flower",CACTUS_GROWING:"Cactus Growing",CACTUS:"Cactus",CARROT_GROWING:"Carrot Growing",CARROT_LEAVES:"Carrot Leaves",CARROT_ROOT:"Carrot Root",CARROT:"Carrot",CLAY:"Clay",CLOUD:"Cloud",COAL:"Coal",CORN_EAR:"Corn Ear",CORN_GROWING:"Corn Growing",CORN_LEAVES:"Corn Leaves",CORN_SILK:"Corn Silk",CORN_STALK:"Corn Stalk",CORN:"Corn",DIRT:"Dirt",FERN_FROND:"Fern Frond",FERN_GROWING:"Fern Growing",FERN_STEM:"Fern Stem",FERN:"Fern",GOLD:"Gold",GRASS:"Grass",ICE:"Ice",IRON:"Iron",KELP_BLADE:"Kelp Blade",KELP_BULB:"Kelp Bulb",KELP_GROWING:"Kelp Growing",KELP:"Kelp",LAVA:"Lava",LAVENDER_BUSH:"Lavender Bush",LAVENDER_FLOWERS:"Lavender Flowers",LAVENDER_GROWING:"Lavender Growing",LAVENDER_STEM:"Lavender Stem",LAVENDER:"Lavender",LOTUS_BUD:"Lotus Bud",LOTUS_FLOWER:"Lotus Flower",LOTUS_GROWING:"Lotus Growing",LOTUS_PAD:"Lotus Pad",LOTUS_STEM:"Lotus Stem",LOTUS:"Lotus",MOSS:"Moss",MUSHROOM_CAP:"Mushroom Cap",MUSHROOM_GROWING:"Mushroom Growing",MUSHROOM_STEM:"Mushroom Stem",MUSHROOM:"Mushroom",PINE_CONE:"Pine Cone",PINE_NEEDLES:"Pine Needles",PINE_TREE_GROWING:"Pine Tree Growing",PINE_TREE:"Pine Tree",PINE_TRUNK:"Pine Trunk",PUMICE:"Pumice",PUMPKIN_FRUIT:"Pumpkin Fruit",PUMPKIN_GROWING:"Pumpkin Growing",PUMPKIN_LEAVES:"Pumpkin Leaves",PUMPKIN_STEM:"Pumpkin Stem",PUMPKIN_VINE:"Pumpkin Vine",PUMPKIN:"Pumpkin",ROSE_BLOOM:"Rose Bloom",ROSE_BUD:"Rose Bud",ROSE_GROWING:"Rose Growing",ROSE_LEAVES:"Rose Leaves",ROSE_STEM:"Rose Stem",ROSE_THORNS:"Rose Thorns",ROSE:"Rose",SAND:"Sand",SNOW:"Snow",STONE:"Stone",SUNFLOWER_CENTER:"Sunflower Center",SUNFLOWER_GROWING:"Sunflower Growing",SUNFLOWER_LEAVES:"Sunflower Leaves",SUNFLOWER_PETALS:"Sunflower Petals",SUNFLOWER_STEM:"Sunflower Stem",SUNFLOWER:"Sunflower",TREE_GROWING:"Tree Growing",TREE_LEAVES:"Tree Leaves",TREE_TRUNK:"Tree Trunk",TULIP_BULB:"Tulip Bulb",TULIP_GROWING:"Tulip Growing",TULIP_LEAVES:"Tulip Leaves",TULIP_PETALS:"Tulip Petals",TULIP_STEM:"Tulip Stem",TULIP:"Tulip",WATER:"Water",WHEAT_GRAIN:"Wheat Grain",WHEAT_GROWING:"Wheat Growing",WHEAT_STALK:"Wheat Stalk",WHEAT:"Wheat",WILLOW_BRANCHES:"Willow Branches",WILLOW_LEAVES:"Willow Leaves",WILLOW_TREE_GROWING:"Willow Tree Growing",WILLOW_TREE:"Willow Tree",WILLOW_TRUNK:"Willow Trunk",WOOD:"Wood",LINK:"Link"},fe=[{name:ye.AIR,id:0,drops:null,solid:!1},{name:ye.AGAVE_BASE,id:82,drops:null,solid:!0},{name:ye.AGAVE_FLOWER_STALK,id:84,drops:null,solid:!0},{name:ye.AGAVE_FLOWER,id:85,drops:null,solid:!0},{name:ye.AGAVE_GROWING,id:81,drops:null,solid:!0,crop:!0},{name:ye.AGAVE_SPIKE,id:83,drops:null,solid:!0},{name:ye.AGAVE,id:80,drops:"AGAVE",solid:!0,growthTime:1920,isSeed:!0,crop:!0},{name:ye.BAMBOO_GROWING,id:43,drops:null,solid:!0,crop:!0},{name:ye.BAMBOO_JOINT,id:53,drops:null,solid:!0},{name:ye.BAMBOO_LEAVES,id:54,drops:null,solid:!0},{name:ye.BAMBOO_STALK,id:52,drops:null,solid:!0},{name:ye.BAMBOO,id:36,drops:"BAMBOO",solid:!0,growthTime:180,isSeed:!0,crop:!0},{name:ye.BEDROCK,id:19,drops:null,solid:!0},{name:ye.BERRY_BUSH_BERRIES,id:51,drops:null,solid:!0},{name:ye.BERRY_BUSH_BRANCH,id:49,drops:null,solid:!0},{name:ye.BERRY_BUSH_GROWING,id:42,drops:null,solid:!0,crop:!0},{name:ye.BERRY_BUSH_LEAVES,id:50,drops:null,solid:!0},{name:ye.BERRY_BUSH,id:35,drops:"BERRY_BUSH",solid:!0,growthTime:360,isSeed:!0,crop:!0},{name:ye.BIRCH_BARK,id:117,drops:null,solid:!0},{name:ye.BIRCH_BRANCHES,id:118,drops:null,solid:!0},{name:ye.BIRCH_CATKINS,id:120,drops:null,solid:!0},{name:ye.BIRCH_GROWING,id:115,drops:null,solid:!0,crop:!0},{name:ye.BIRCH_LEAVES,id:119,drops:null,solid:!0},{name:ye.BIRCH_TRUNK,id:116,drops:null,solid:!0},{name:ye.BIRCH,id:114,drops:["BIRCH","WOOD"],solid:!0,growthTime:1260,isSeed:!0,crop:!0},{name:ye.CACTUS_BODY,id:30,drops:null,solid:!0},{name:ye.CACTUS_FLOWER,id:31,drops:null,solid:!0},{name:ye.CACTUS_GROWING,id:23,drops:null,solid:!0,crop:!0},{name:ye.CACTUS,id:15,drops:"CACTUS",solid:!0,growthTime:2400,isSeed:!0,crop:!0},{name:ye.CARROT_GROWING,id:21,drops:null,solid:!0,crop:!0},{name:ye.CARROT_LEAVES,id:26,drops:null,solid:!0},{name:ye.CARROT_ROOT,id:27,drops:null,solid:!0},{name:ye.CARROT,id:13,drops:"CARROT",solid:!0,growthTime:240,isSeed:!0,crop:!0},{name:ye.CLAY,id:6,drops:"CLAY",solid:!0},{name:ye.CLOUD,id:72,drops:"CLOUD",solid:!0},{name:ye.COAL,id:7,drops:"COAL",solid:!0},{name:ye.CORN_EAR,id:61,drops:null,solid:!0},{name:ye.CORN_GROWING,id:45,drops:null,solid:!0,crop:!0},{name:ye.CORN_LEAVES,id:60,drops:null,solid:!0},{name:ye.CORN_SILK,id:62,drops:null,solid:!0},{name:ye.CORN_STALK,id:59,drops:null,solid:!0},{name:ye.CORN,id:38,drops:"CORN",solid:!0,growthTime:420,isSeed:!0,crop:!0},{name:ye.DIRT,id:2,drops:"DIRT",solid:!0},{name:ye.FERN_FROND,id:70,drops:null,solid:!0},{name:ye.FERN_GROWING,id:48,drops:null,solid:!0,crop:!0},{name:ye.FERN_STEM,id:69,drops:null,solid:!0},{name:ye.FERN,id:41,drops:"FERN",solid:!0,growthTime:90,isSeed:!0,crop:!0},{name:ye.GOLD,id:9,drops:"GOLD",solid:!0},{name:ye.GRASS,id:1,drops:"GRASS",solid:!0},{name:ye.ICE,id:17,drops:"ICE",solid:!0},{name:ye.IRON,id:8,drops:"IRON",solid:!0},{name:ye.KELP_BLADE,id:93,drops:null,solid:!0},{name:ye.KELP_BULB,id:94,drops:null,solid:!0},{name:ye.KELP_GROWING,id:92,drops:null,solid:!0,crop:!0},{name:ye.KELP,id:91,drops:"KELP",solid:!0,growthTime:150,isSeed:!0,crop:!0},{name:ye.LAVA,id:18,drops:null,solid:!0,gravity:!0},{name:ye.LAVENDER_BUSH,id:89,drops:null,solid:!0},{name:ye.LAVENDER_FLOWERS,id:90,drops:null,solid:!0},{name:ye.LAVENDER_GROWING,id:87,drops:null,solid:!0,crop:!0},{name:ye.LAVENDER_STEM,id:88,drops:null,solid:!0},{name:ye.LAVENDER,id:86,drops:"LAVENDER",solid:!0,growthTime:200,isSeed:!0,crop:!0},{name:ye.LOTUS_BUD,id:112,drops:null,solid:!0},{name:ye.LOTUS_FLOWER,id:113,drops:null,solid:!0},{name:ye.LOTUS_GROWING,id:109,drops:null,solid:!0,crop:!0},{name:ye.LOTUS_PAD,id:110,drops:null,solid:!0},{name:ye.LOTUS_STEM,id:111,drops:null,solid:!0},{name:ye.LOTUS,id:108,drops:"LOTUS",solid:!0,growthTime:390,isSeed:!0,crop:!0},{name:ye.MUSHROOM_CAP,id:29,drops:null,solid:!0},{name:ye.MUSHROOM_GROWING,id:22,drops:null,solid:!0,crop:!0},{name:ye.MUSHROOM_STEM,id:28,drops:null,solid:!0},{name:ye.MUSHROOM,id:14,drops:"MUSHROOM",solid:!0,growthTime:120,isSeed:!0,crop:!0},{name:ye.PINE_CONE,id:65,drops:null,solid:!0},{name:ye.PINE_NEEDLES,id:64,drops:null,solid:!0},{name:ye.PINE_TREE_GROWING,id:46,drops:null,solid:!0,crop:!0},{name:ye.PINE_TREE,id:39,drops:"PINE_TREE",solid:!0,growthTime:1440,isSeed:!0,crop:!0},{name:ye.PINE_TRUNK,id:63,drops:null,solid:!0},{name:ye.PUMICE,id:71,drops:"PUMICE",solid:!0},{name:ye.PUMPKIN_FRUIT,id:106,drops:null,solid:!0},{name:ye.PUMPKIN_GROWING,id:103,drops:null,solid:!0,crop:!0},{name:ye.PUMPKIN_LEAVES,id:105,drops:null,solid:!0},{name:ye.PUMPKIN_STEM,id:107,drops:null,solid:!0},{name:ye.PUMPKIN_VINE,id:104,drops:null,solid:!0},{name:ye.PUMPKIN,id:102,drops:"PUMPKIN",solid:!0,growthTime:660,isSeed:!0,crop:!0},{name:ye.ROSE_BLOOM,id:101,drops:null,solid:!0},{name:ye.ROSE_BUD,id:100,drops:null,solid:!0},{name:ye.ROSE_GROWING,id:96,drops:null,solid:!0,crop:!0},{name:ye.ROSE_LEAVES,id:99,drops:null,solid:!0},{name:ye.ROSE_STEM,id:97,drops:null,solid:!0},{name:ye.ROSE_THORNS,id:98,drops:null,solid:!0},{name:ye.ROSE,id:95,drops:"ROSE",solid:!0,growthTime:540,isSeed:!0,crop:!0},{name:ye.SAND,id:5,drops:"SAND",solid:!0,gravity:!0},{name:ye.SNOW,id:16,drops:"SNOW",solid:!0},{name:ye.STONE,id:3,drops:"STONE",solid:!0},{name:ye.SUNFLOWER_CENTER,id:57,drops:null,solid:!0},{name:ye.SUNFLOWER_GROWING,id:44,drops:null,solid:!0,crop:!0},{name:ye.SUNFLOWER_LEAVES,id:56,drops:null,solid:!0},{name:ye.SUNFLOWER_PETALS,id:58,drops:null,solid:!0},{name:ye.SUNFLOWER_STEM,id:55,drops:"SUNFLOWER",solid:!0},{name:ye.SUNFLOWER,id:37,drops:null,solid:!0,growthTime:600,isSeed:!0,crop:!0},{name:ye.TREE_GROWING,id:34,drops:null,solid:!0,crop:!0},{name:ye.TREE_LEAVES,id:11,drops:null,solid:!0,crop:!0},{name:ye.TREE_TRUNK,id:10,drops:"WOOD",solid:!0,crop:!0},{name:ye.TULIP_BULB,id:79,drops:null,solid:!0},{name:ye.TULIP_GROWING,id:75,drops:null,solid:!0,crop:!0},{name:ye.TULIP_LEAVES,id:77,drops:null,solid:!0},{name:ye.TULIP_PETALS,id:78,drops:null,solid:!0},{name:ye.TULIP_STEM,id:76,drops:null,solid:!0},{name:ye.TULIP,id:74,drops:"TULIP",solid:!0,growthTime:300,isSeed:!0,crop:!0},{name:ye.WATER,id:4,drops:null,solid:!0,gravity:!0},{name:ye.WHEAT_GRAIN,id:25,drops:null,solid:!0},{name:ye.WHEAT_GROWING,id:20,drops:null,solid:!0,crop:!0},{name:ye.WHEAT_STALK,id:24,drops:null,solid:!0},{name:ye.WHEAT,id:12,drops:"WHEAT",solid:!0,growthTime:480,isSeed:!0,crop:!0},{name:ye.WILLOW_BRANCHES,id:67,drops:null,solid:!0},{name:ye.WILLOW_LEAVES,id:68,drops:null,solid:!0},{name:ye.WILLOW_TREE_GROWING,id:47,drops:null,solid:!0,crop:!0},{name:ye.WILLOW_TREE,id:40,drops:["WILLOW_TREE","WOOD"],solid:!0,growthTime:1800,isSeed:!0,crop:!0},{name:ye.WILLOW_TRUNK,id:66,drops:null,solid:!0},{name:ye.WOOD,id:73,drops:"WOOD",solid:!0,crop:!0},{name:ye.LINK,id:130,drops:null,solid:!0}],we=new Array(256).fill(void 0),Ge=new Map,ke=new Map;fe.forEach((e,t)=>{ke.set(e.id,t),void 0!==e.id&&e.id<256&&(we[e.id]=e),e.name&&Ge.set(e.name,e)});const Se=Object.assign(fe,{getById:e=>we[e],getByName:e=>Ge.get(e)});function Ze(e){return Ge.get(e)}function We(e){return we[e]}function Le(e,t,n){if(0===t)return!0;const o=n.getById(t);return!o||Number(e[o.name][3])<1}function Re(e,t,n,o,r,i={}){if(o<=0)return 1;if(o>=u)return 0;if(n>=0&&n<g&&r>=0&&r<I)return e.getBlock(n,o,r);if(n<0){if(i.nx)return i.nx.getBlock(n+g,o,r)}else if(n>=g&&i.px)return i.px.getBlock(n-g,o,r);if(r<0){if(i.nz)return i.nz.getBlock(n,o,r+I)}else if(r>=I&&i.pz)return i.pz.getBlock(n,o,r-I);const a=e.worldX+n,l=e.worldZ+r;return t.getBlock(a,o,l)}const Be=[{uvs:[[0,0],[1,0],[1,1],[0,0],[1,1],[0,1]],aoOffsets:[[[0,-1,0],[0,0,-1],[0,-1,-1]],[[0,1,0],[0,0,-1],[0,1,-1]],[[0,1,0],[0,0,1],[0,1,1]],[[0,-1,0],[0,0,-1],[0,-1,-1]],[[0,1,0],[0,0,1],[0,1,1]],[[0,-1,0],[0,0,1],[0,-1,1]]]},{uvs:[[0,1],[1,1],[1,0],[0,1],[1,0],[0,0]],aoOffsets:[[[0,-1,0],[0,0,1],[0,-1,1]],[[0,1,0],[0,0,1],[0,1,1]],[[0,1,0],[0,0,-1],[0,1,-1]],[[0,-1,0],[0,0,1],[0,-1,1]],[[0,1,0],[0,0,-1],[0,1,-1]],[[0,-1,0],[0,0,-1],[0,-1,-1]]]},{uvs:[[0,0],[0,1],[1,1],[0,0],[1,1],[1,0]],aoOffsets:[[[-1,0,0],[0,0,-1],[-1,0,-1]],[[-1,0,0],[0,0,1],[-1,0,1]],[[1,0,0],[0,0,1],[1,0,1]],[[-1,0,0],[0,0,-1],[-1,0,-1]],[[1,0,0],[0,0,1],[1,0,1]],[[1,0,0],[0,0,-1],[1,0,-1]]]},{uvs:[[0,1],[0,0],[1,0],[0,1],[1,0],[1,1]],aoOffsets:[[[-1,0,0],[0,0,1],[-1,0,1]],[[-1,0,0],[0,0,-1],[-1,0,-1]],[[1,0,0],[0,0,-1],[1,0,-1]],[[-1,0,0],[0,0,1],[-1,0,1]],[[1,0,0],[0,0,-1],[1,0,-1]],[[1,0,0],[0,0,1],[1,0,1]]]},{uvs:[[0,0],[0,1],[1,1],[0,0],[1,1],[1,0]],aoOffsets:[[[-1,0,0],[0,-1,0],[-1,-1,0]],[[-1,0,0],[0,1,0],[-1,1,0]],[[1,0,0],[0,1,0],[1,1,0]],[[-1,0,0],[0,-1,0],[-1,-1,0]],[[1,0,0],[0,1,0],[1,1,0]],[[1,0,0],[0,-1,0],[1,-1,0]]]},{uvs:[[1,0],[1,1],[0,1],[1,0],[0,1],[0,0]],aoOffsets:[[[1,0,0],[0,-1,0],[1,-1,0]],[[1,0,0],[0,1,0],[1,1,0]],[[-1,0,0],[0,1,0],[-1,1,0]],[[1,0,0],[0,-1,0],[1,-1,0]],[[-1,0,0],[0,1,0],[-1,1,0]],[[-1,0,0],[0,-1,0],[-1,-1,0]]]}];function xe(e,t,n,o,r,i,a,l){let s=0;const c=Re(e,t,n+i[0][0],o+i[0][1],r+i[0][2],l),d=Re(e,t,n+i[1][0],o+i[1][1],r+i[1][2],l),g=Re(e,t,n+i[2][0],o+i[2][1],r+i[2][2],l),u=0!==c&&a.getById(c)?.solid?1:0,I=0!==d&&a.getById(d)?.solid?1:0,h=0!==g&&a.getById(g)?.solid?1:0;return s=1===u&&1===I?3:u+I+h,[1,.7,.5,.3][s]}const Te=[{axis:0,dir:1,u:2,v:1},{axis:0,dir:-1,u:2,v:1},{axis:1,dir:1,u:0,v:2},{axis:1,dir:-1,u:0,v:2},{axis:2,dir:1,u:0,v:1},{axis:2,dir:-1,u:0,v:1}],Ee=[g,u,I];function Ne(e,t,n,o,r,i,a,l,s,c,d){const g=[];for(let u=0;u<4;u++){const I=1===u||2===u?c:0,h=2===u||3===u?d:0,b=[0,0,0];b[e]=a+(t>0?1:0),b[n]=l+I,b[o]=s+h,g.push({x:r+b[0],y:b[1],z:i+b[2]})}return g}function Me(e,t,n,o){return function(e,t,n,o){const r=[],i=[],a=[],l=[],s=[],c=[],d=[],g=[];let u=0;const I=t.worldX,h=t.worldZ,b=1/16,m={nx:n.getChunk(t.chunkX-1,t.chunkZ),px:n.getChunk(t.chunkX+1,t.chunkZ),nz:n.getChunk(t.chunkX,t.chunkZ-1),pz:n.getChunk(t.chunkX,t.chunkZ+1)};for(let C=0;C<Te.length;C++){const{axis:A,dir:p,u:v,v:y}=Te[C],f=Ee[A],w=Ee[v],G=Ee[y];for(let k=0;k<f;k++){const f=new Int32Array(w*G);for(let r=0;r<G;r++)for(let i=0;i<w;i++){const a=[0,0,0];a[A]=k,a[v]=i,a[y]=r;const[l,s,c]=a;if(0===s)continue;const d=t.getBlock(l,s,c);if(0===d)continue;const g=[l,s,c];g[A]+=p;const u=Re(t,n,g[0],g[1],g[2],m),I=o.getById(d);if(!I)continue;const[h,b,C,G]=e[I.name]||[1,1,1,1],S=Number(G)<1,Z=Le(e,u,o);let W=!1;(0===u||!S&&Z||S&&u!==d)&&(W=!0),W&&(f[i+r*w]=d)}for(let S=0;S<G;S++)for(let Z=0;Z<w;){const W=f[Z+S*w];if(0===W){Z++;continue}let L=1;for(;Z+L<w&&f[Z+L+S*w]===W;)L++;let R=1,B=!0;for(;S+R<G&&B;){for(let e=0;e<L;e++)if(f[Z+e+(S+R)*w]!==W){B=!1;break}B&&R++}const x=o.getById(W),[T,E,N,M]=e[x?.name]||[1,1,1,1],Y=W%16*b,V=Math.floor(W/16)*b,X=[1,1,1,1];if(x.solid){const e=Be[C],r=[0,1,2,5],i=[[0,0],[L,0],[L,R],[0,R]];for(let a=0;a<4;a++){const l=i[a],s=[0,0,0];s[A]=k+p,s[v]=Z+l[0],s[y]=S+l[1],X[a]=xe(t,n,s[0],s[1],s[2],e.aoOffsets[r[a]],o,m)}}const D=Ne(A,p,v,y,I,h,k,Z,S,L,R);for(let e=0;e<4;e++){const t=D[e];r.push(t.x,t.y,t.z);const n=[0,0,0];n[A]=p,i.push(...n),a.push(T,E,N,M);const o=[[0,0],[L,0],[L,R],[0,R]][e];l.push(Y+o[0]/L*b,V+o[1]/R*b);const g=1===e||2===e?1:0,u=2===e||3===e?1:0;c.push(g,u),d.push(...X),s.push(X[e])}p>0?g.push(u,u+1,u+2,u,u+2,u+3):g.push(u,u+2,u+1,u,u+3,u+2),u+=4;for(let e=0;e<R;e++)for(let t=0;t<L;t++)f[Z+t+(S+e)*w]=0;Z+=L}}}return{positions:new Float32Array(r),normals:new Float32Array(i),colors:new Float32Array(a),uvs:new Float32Array(l),ao:new Float32Array(s),localUVs:new Float32Array(c),cornerAO:new Float32Array(d),indices:new Uint16Array(g),vertexCount:r.length/3,indexCount:g.length,positionBuffer:null,normalBuffer:null,colorBuffer:null,uvBuffer:null,aoBuffer:null,localUVBuffer:null,cornerAOBuffer:null,indexBuffer:null}}(e,t,n,o)}function Ye(e,t){const n=t.mesh;n&&0!==n.vertexCount&&(n.positionBuffer||(n.positionBuffer=e.createBuffer()),e.bindBuffer(e.ARRAY_BUFFER,n.positionBuffer),e.bufferData(e.ARRAY_BUFFER,n.positions,e.STATIC_DRAW),n.normalBuffer||(n.normalBuffer=e.createBuffer()),e.bindBuffer(e.ARRAY_BUFFER,n.normalBuffer),e.bufferData(e.ARRAY_BUFFER,n.normals,e.STATIC_DRAW),n.colorBuffer||(n.colorBuffer=e.createBuffer()),e.bindBuffer(e.ARRAY_BUFFER,n.colorBuffer),e.bufferData(e.ARRAY_BUFFER,n.colors,e.STATIC_DRAW),n.uvs&&(n.uvBuffer||(n.uvBuffer=e.createBuffer()),e.bindBuffer(e.ARRAY_BUFFER,n.uvBuffer),e.bufferData(e.ARRAY_BUFFER,n.uvs,e.STATIC_DRAW)),n.ao&&(n.aoBuffer||(n.aoBuffer=e.createBuffer()),e.bindBuffer(e.ARRAY_BUFFER,n.aoBuffer),e.bufferData(e.ARRAY_BUFFER,n.ao,e.STATIC_DRAW)),n.localUVs&&(n.localUVBuffer||(n.localUVBuffer=e.createBuffer()),e.bindBuffer(e.ARRAY_BUFFER,n.localUVBuffer),e.bufferData(e.ARRAY_BUFFER,n.localUVs,e.STATIC_DRAW)),n.cornerAO&&(n.cornerAOBuffer||(n.cornerAOBuffer=e.createBuffer()),e.bindBuffer(e.ARRAY_BUFFER,n.cornerAOBuffer),e.bufferData(e.ARRAY_BUFFER,n.cornerAO,e.STATIC_DRAW)),n.indices&&n.indices.length>0&&(n.indexBuffer||(n.indexBuffer=e.createBuffer()),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,n.indices,e.STATIC_DRAW)))}function Ve(e,t){const n=t.mesh;n&&(n.positionBuffer&&(e.deleteBuffer(n.positionBuffer),n.positionBuffer=null),n.normalBuffer&&(e.deleteBuffer(n.normalBuffer),n.normalBuffer=null),n.colorBuffer&&(e.deleteBuffer(n.colorBuffer),n.colorBuffer=null),n.uvBuffer&&(e.deleteBuffer(n.uvBuffer),n.uvBuffer=null),n.aoBuffer&&(e.deleteBuffer(n.aoBuffer),n.aoBuffer=null),n.localUVBuffer&&(e.deleteBuffer(n.localUVBuffer),n.localUVBuffer=null),n.cornerAOBuffer&&(e.deleteBuffer(n.cornerAOBuffer),n.cornerAOBuffer=null),n.indexBuffer&&(e.deleteBuffer(n.indexBuffer),n.indexBuffer=null))}function Xe(e,t){const n=e.host;return!!(n&&"object"==typeof n&&"keys"in n&&"touchKeys"in n)&&(n.keys[t]||n.touchKeys[t])}function De(e,t){return e.minX<=t.maxX&&e.maxX>=t.minX&&e.minY<=t.maxY&&e.maxY>=t.minY&&e.minZ<=t.maxZ&&e.maxZ>=t.minZ}function Je(e,t){const n=t||e.hit;if(!n)return!1;const o=e.world.get(`${n.x},${n.y},${n.z}`);if(void 0!==o){const t=We(o);if(t&&"Link"===t.name)return function(e,t,n,o){const r=Math.floor(t/16),i=Math.floor(o/16),a=e.world.getOrCreateChunk(r,i),l=(t%16+16)%16,s=(o%16+16)%16,c=a.metadata.get(a.index(l,n,s));if(!c||!c.worldName)return void console.warn("Link block has no metadata or world name");const{worldName:d,params:g={}}=c,u=document.querySelector("block-garden").shadowRoot,I=Object.entries(g).map(([e,t])=>`${e}=${t}`).join(", "),h=` Link: ${d}${I?` (${I})`:""} at [${t}, ${n}, ${o}]`;P(u,h);const b="https://kherrick.github.io/block-garden/assets/game-saves/"+(X(d)+".pdf"),m=new URL("https://kherrick.github.io/block-garden/");m.searchParams.set("gameSave",b);for(const[e,t]of Object.entries(g))m.searchParams.set(e,t);const C=document.createElement("dialog");C.style.cssText="\n    background: var(--bg-color-gray-50);\n    border-radius: 0.5rem;\n    border: 0.125rem solid var(--bg-color-gray-900);\n    color: var(--bg-color-gray-900);\n    font-family: monospace;\n    padding: 1.25rem;\n    max-width: 25rem;\n    z-index: 10000;\n  ",C.innerHTML=`\n    <h3 style="margin: 0 0 1rem 0">Travel to World?</h3>\n    <p style="margin: 0 0 1rem 0">\n      Would you like to travel to <strong>${d}</strong>?\n    </p>\n    <div style="display: flex; gap: 0.625rem; justify-content: flex-end">\n      <button id="cancelTravel" style="background: var(--bg-color-red-500); border-radius: 0.25rem; border: none; color: white; cursor: pointer; padding: 0.5rem 0.9375rem;">No</button>\n      <button id="confirmTravel" style="background: var(--bg-color-green-500); border-radius: 0.25rem; border: none; color: white; cursor: pointer; padding: 0.5rem 0.9375rem;">Yes</button>\n    </div>\n  `,document.pointerLockElement&&document.exitPointerLock();e.isCanvasActionDisabled=!0,u.append(C),C.showModal(),C.querySelector("#cancelTravel").addEventListener("click",()=>{C.close(),C.remove(),setTimeout(()=>{e.isCanvasActionDisabled=!1},500)}),C.querySelector("#confirmTravel").addEventListener("click",()=>{window.location.href=m.toString()})}(e,n.x,n.y,n.z),!0}if(!n.face)return!1;const{x:r,y:i,z:a,face:l}=n,s=r+l.x,c=i+l.y,d=a+l.z;if(De({minX:e.x-e.playerWidth/2,maxX:e.x+e.playerWidth/2,minY:e.y-e.playerHeight/2,maxY:e.y+e.playerHeight/2,minZ:e.z-e.playerWidth/2,maxZ:e.z+e.playerWidth/2},{minX:s,maxX:s+1,minY:c,maxY:c+1,minZ:d,maxZ:d+1})){const t=document.querySelector("block-garden")?.shadowRoot;if(t){const o=We(e.world.get(`${n.x},${n.y},${n.z}`));let r=`${o?o.name:"Unknown"} at [${n.x}, ${n.y}, ${n.z}]`;if("Link"===o?.name){const t=Math.floor(n.x/16),o=Math.floor(n.z/16),i=e.world.getOrCreateChunk(t,o),a=(n.x%16+16)%16,l=(n.z%16+16)%16,s=i.metadata.get(i.index(a,n.y,l));s?.worldName&&(r=` Link to: ${s.worldName} at [${n.x}, ${n.y}, ${n.z}]`)}P(t,r)}return!1}const g=e.curBlock.get(),u=`${s},${c},${d}`,I=We(g);let h=null;I&&"Link"===I.name&&(h=e.armedLinkConfig.get()),e.world.set(u,g,!0,h);const b=We(g);if(b&&b.isSeed){e.growthTimers||(e.growthTimers={}),e.plantStructures||(e.plantStructures={});const t=30,n=e.fastGrowth?t:b.growthTime||10;e.growthTimers[u]=n,e.plantStructures[u]={type:b.name,blocks:[]}}return!0}function ze(e,t){const n=t||e.hit;if(!n)return!1;const o=`${n.x},${n.y},${n.z}`;if(e.world.delete(o,!0),e.plantStructures)for(const[t,o]of Object.entries(e.plantStructures)){if(!o||!o.blocks)continue;if(o.blocks.find(e=>e.x===n.x&&e.y===n.y&&e.z===n.z)){let n=!0;for(const t of o.blocks){const o=`${t.x},${t.y},${t.z}`;if(void 0!==e.world.get(o)){n=!1;break}}n&&(console.log(`[Interaction] Plant at ${t} fully harvested, removing structure`),delete e.plantStructures[t],e.growthTimers&&delete e.growthTimers[t]);break}}return!0}function Fe(e,t,n){const{yaw:o,flying:r}=t,i=r.get(),a=i?12:8,l=Math.sin(o),s=Math.cos(o);let c=0,d=0;if(Xe(e,"w")&&(c+=l*a,d+=s*a),Xe(e,"a")&&(c+=s*a,d-=l*a),Xe(e,"s")&&(c-=l*a,d-=s*a),Xe(e,"d")&&(c-=s*a,d+=l*a),Xe(e,"upleft")?(c+=(l+s)*a,d+=(s-l)*a):Xe(e,"upright")?(c+=(l-s)*a,d+=(s+l)*a):Xe(e,"downleft")?(c+=(-l+s)*a,d+=(-s-l)*a):Xe(e,"downright")&&(c+=(-l-s)*a,d+=(-s+l)*a),t.arrowsControlCamera.get()){const o=2;Xe(e,"arrowleft")&&(t.yaw+=o*n),Xe(e,"arrowright")&&(t.yaw-=o*n),Xe(e,"arrowup")&&(t.pitch+=o*n),Xe(e,"arrowdown")&&(t.pitch-=o*n);const r=Math.PI/2-.01;t.pitch=Math.max(-r,Math.min(r,t.pitch))}else Xe(e,"arrowup")?(c+=l*a,d+=s*a):Xe(e,"arrowleft")?(c+=s*a,d-=l*a):Xe(e,"arrowdown")?(c-=l*a,d-=s*a):Xe(e,"arrowright")&&(c-=s*a,d+=l*a);if(Xe(e,"enter"))if(0===t.actionKeyPressTime)t.actionKeyPressTime=performance.now();else if(t.actionKeyPressTime>0){performance.now()-t.actionKeyPressTime>500&&(ze(t),t.actionKeyPressTime=-performance.now())}else{const e=-t.actionKeyPressTime;performance.now()-e>300&&(ze(t),t.actionKeyPressTime=-performance.now())}else{if(t.actionKeyPressTime>0){performance.now()-t.actionKeyPressTime<=500&&Je(t)}t.actionKeyPressTime=0}t.dx+=(c-t.dx)*(i?15:10)*n,t.dz+=(d-t.dz)*(i?15:10)*n;const g=i?.95:.92;t.dx*=g,t.dz*=g}function Pe(e,t,n,o){if(n>=256)return!0;if(n<=0)return!0;const r=e.getBlock(t,n,o);if(0===r)return!1;const i=We(r);return i&&i.solid||!1}var je=Object.defineProperty,Oe=(e,t,n)=>(((e,t,n)=>{t in e?je(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n),Ue=(e,t)=>{if(Object(t)!==t)throw TypeError('Cannot use the "in" operator on this value');return e.has(t)},He=(e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},_e=(e,t,n)=>(((e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)})(e,t,"access private method"),n);
/**
 * @license
 * Copyright Google LLC All Rights Reserved.
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://angular.io/license
 */
function Ke(e,t){return Object.is(e,t)}
/**
 * @license
 * Copyright Google LLC All Rights Reserved.
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://angular.io/license
 */let Qe=null,qe=!1,$e=1;const et=Symbol("SIGNAL");function tt(e){const t=Qe;return Qe=e,t}const nt={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function ot(e){if(qe)throw new Error("undefined"!=typeof ngDevMode&&ngDevMode?"Assertion error: signal read during notification phase":"");if(null===Qe)return;Qe.consumerOnSignalRead(e);const t=Qe.nextProducerIndex++;if(dt(Qe),t<Qe.producerNode.length&&Qe.producerNode[t]!==e&&ct(Qe)){st(Qe.producerNode[t],Qe.producerIndexOfThis[t])}Qe.producerNode[t]!==e&&(Qe.producerNode[t]=e,Qe.producerIndexOfThis[t]=ct(Qe)?lt(e,Qe,t):0),Qe.producerLastReadVersion[t]=e.version}function rt(e){if(e.dirty||e.lastCleanEpoch!==$e){if(!e.producerMustRecompute(e)&&!function(e){dt(e);for(let t=0;t<e.producerNode.length;t++){const n=e.producerNode[t],o=e.producerLastReadVersion[t];if(o!==n.version)return!0;if(rt(n),o!==n.version)return!0}return!1}(e))return e.dirty=!1,void(e.lastCleanEpoch=$e);e.producerRecomputeValue(e),e.dirty=!1,e.lastCleanEpoch=$e}}function it(e){if(void 0===e.liveConsumerNode)return;const t=qe;qe=!0;try{for(const t of e.liveConsumerNode)t.dirty||at(t)}finally{qe=t}}function at(e){var t;e.dirty=!0,it(e),null==(t=e.consumerMarkedDirty)||t.call(e.wrapper??e)}function lt(e,t,n){var o;if(gt(e),dt(e),0===e.liveConsumerNode.length){null==(o=e.watched)||o.call(e.wrapper);for(let t=0;t<e.producerNode.length;t++)e.producerIndexOfThis[t]=lt(e.producerNode[t],e,t)}return e.liveConsumerIndexOfThis.push(n),e.liveConsumerNode.push(t)-1}function st(e,t){var n;if(gt(e),dt(e),"undefined"!=typeof ngDevMode&&ngDevMode&&t>=e.liveConsumerNode.length)throw new Error(`Assertion error: active consumer index ${t} is out of bounds of ${e.liveConsumerNode.length} consumers)`);if(1===e.liveConsumerNode.length){null==(n=e.unwatched)||n.call(e.wrapper);for(let t=0;t<e.producerNode.length;t++)st(e.producerNode[t],e.producerIndexOfThis[t])}const o=e.liveConsumerNode.length-1;if(e.liveConsumerNode[t]=e.liveConsumerNode[o],e.liveConsumerIndexOfThis[t]=e.liveConsumerIndexOfThis[o],e.liveConsumerNode.length--,e.liveConsumerIndexOfThis.length--,t<e.liveConsumerNode.length){const n=e.liveConsumerIndexOfThis[t],o=e.liveConsumerNode[t];dt(o),o.producerIndexOfThis[n]=t}}function ct(e){var t;return e.consumerIsAlwaysLive||((null==(t=null==e?void 0:e.liveConsumerNode)?void 0:t.length)??0)>0}function dt(e){e.producerNode??(e.producerNode=[]),e.producerIndexOfThis??(e.producerIndexOfThis=[]),e.producerLastReadVersion??(e.producerLastReadVersion=[])}function gt(e){e.liveConsumerNode??(e.liveConsumerNode=[]),e.liveConsumerIndexOfThis??(e.liveConsumerIndexOfThis=[])}
/**
 * @license
 * Copyright Google LLC All Rights Reserved.
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://angular.io/license
 */function ut(e){if(rt(e),ot(e),e.value===bt)throw e.error;return e.value}const It=Symbol("UNSET"),ht=Symbol("COMPUTING"),bt=Symbol("ERRORED"),mt=(()=>({...nt,value:It,dirty:!0,error:null,equal:Ke,producerMustRecompute:e=>e.value===It||e.value===ht,producerRecomputeValue(e){if(e.value===ht)throw new Error("Detected cycle in computations.");const t=e.value;e.value=ht;const n=function(e){return e&&(e.nextProducerIndex=0),tt(e)}(e);let o,r=!1;try{o=e.computation.call(e.wrapper);r=t!==It&&t!==bt&&e.equal.call(e.wrapper,t,o)}catch(t){o=bt,e.error=t}finally{!function(e,t){if(tt(t),e&&void 0!==e.producerNode&&void 0!==e.producerIndexOfThis&&void 0!==e.producerLastReadVersion){if(ct(e))for(let t=e.nextProducerIndex;t<e.producerNode.length;t++)st(e.producerNode[t],e.producerIndexOfThis[t]);for(;e.producerNode.length>e.nextProducerIndex;)e.producerNode.pop(),e.producerLastReadVersion.pop(),e.producerIndexOfThis.pop()}}(e,n)}r?e.value=t:(e.value=o,e.version++)}}))();let Ct=
/**
 * @license
 * Copyright Google LLC All Rights Reserved.
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://angular.io/license
 */
function(){throw new Error};function At(){return ot(this),this.value}function pt(e,t){!1===(null==Qe?void 0:Qe.consumerAllowSignalWrites)&&Ct(),e.equal.call(e.wrapper,e.value,t)||(e.value=t,function(e){e.version++,$e++,it(e)}
/**
 * @license
 * Copyright 2024 Bloomberg Finance L.P.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e))}const vt=(()=>({...nt,equal:Ke,value:void 0}))();const yt=Symbol("node");var ft;(e=>{var t,n,o,r;t=yt,n=new WeakSet,e.isState=e=>"object"==typeof e&&Ue(n,e),e.State=class{constructor(o,r={}){He(this,n),Oe(this,t);const i=
/**
 * @license
 * Copyright Google LLC All Rights Reserved.
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://angular.io/license
 */
function(e){const t=Object.create(vt);t.value=e;const n=()=>(ot(t),t.value);return n[et]=t,n}(o),a=i[et];if(this[yt]=a,a.wrapper=this,r){const t=r.equals;t&&(a.equal=t),a.watched=r[e.subtle.watched],a.unwatched=r[e.subtle.unwatched]}}get(){if(!(0,e.isState)(this))throw new TypeError("Wrong receiver type for Signal.State.prototype.get");return At.call(this[yt])}set(t){if(!(0,e.isState)(this))throw new TypeError("Wrong receiver type for Signal.State.prototype.set");if(qe)throw new Error("Writes to signals not permitted during Watcher callback");pt(this[yt],t)}};o=yt,r=new WeakSet,e.isComputed=e=>"object"==typeof e&&Ue(r,e),e.Computed=class{constructor(t,n){He(this,r),Oe(this,o);const i=function(e){const t=Object.create(mt);t.computation=e;const n=()=>ut(t);return n[et]=t,n}(t),a=i[et];if(a.consumerAllowSignalWrites=!0,this[yt]=a,a.wrapper=this,n){const t=n.equals;t&&(a.equal=t),a.watched=n[e.subtle.watched],a.unwatched=n[e.subtle.unwatched]}}get(){if(!(0,e.isComputed)(this))throw new TypeError("Wrong receiver type for Signal.Computed.prototype.get");return ut(this[yt])}},(t=>{var n,o,r,i;t.untrack=function(e){let t,n=null;try{n=tt(null),t=e()}finally{tt(n)}return t},t.introspectSources=function(t){var n;if(!(0,e.isComputed)(t)&&!(0,e.isWatcher)(t))throw new TypeError("Called introspectSources without a Computed or Watcher argument");return(null==(n=t[yt].producerNode)?void 0:n.map(e=>e.wrapper))??[]},t.introspectSinks=function(t){var n;if(!(0,e.isComputed)(t)&&!(0,e.isState)(t))throw new TypeError("Called introspectSinks without a Signal argument");return(null==(n=t[yt].liveConsumerNode)?void 0:n.map(e=>e.wrapper))??[]},t.hasSinks=function(t){if(!(0,e.isComputed)(t)&&!(0,e.isState)(t))throw new TypeError("Called hasSinks without a Signal argument");const n=t[yt].liveConsumerNode;return!!n&&n.length>0},t.hasSources=function(t){if(!(0,e.isComputed)(t)&&!(0,e.isWatcher)(t))throw new TypeError("Called hasSources without a Computed or Watcher argument");const n=t[yt].producerNode;return!!n&&n.length>0};n=yt,o=new WeakSet,r=new WeakSet,i=function(t){for(const n of t)if(!(0,e.isComputed)(n)&&!(0,e.isState)(n))throw new TypeError("Called watch/unwatch without a Computed or State argument")},e.isWatcher=e=>Ue(o,e),t.Watcher=class{constructor(e){He(this,o),He(this,r),Oe(this,n);let t=Object.create(nt);t.wrapper=this,t.consumerMarkedDirty=e,t.consumerIsAlwaysLive=!0,t.consumerAllowSignalWrites=!1,t.producerNode=[],this[yt]=t}watch(...t){if(!(0,e.isWatcher)(this))throw new TypeError("Called unwatch without Watcher receiver");_e(this,r,i).call(this,t);const n=this[yt];n.dirty=!1;const o=tt(n);for(const e of t)ot(e[yt]);tt(o)}unwatch(...t){if(!(0,e.isWatcher)(this))throw new TypeError("Called unwatch without Watcher receiver");_e(this,r,i).call(this,t);const n=this[yt];dt(n);for(let e=n.producerNode.length-1;e>=0;e--)if(t.includes(n.producerNode[e].wrapper)){st(n.producerNode[e],n.producerIndexOfThis[e]);const t=n.producerNode.length-1;if(n.producerNode[e]=n.producerNode[t],n.producerIndexOfThis[e]=n.producerIndexOfThis[t],n.producerNode.length--,n.producerIndexOfThis.length--,n.nextProducerIndex--,e<n.producerNode.length){const t=n.producerIndexOfThis[e],o=n.producerNode[e];gt(o),o.liveConsumerIndexOfThis[t]=e}}}getPending(){if(!(0,e.isWatcher)(this))throw new TypeError("Called getPending without Watcher receiver");return this[yt].producerNode.filter(e=>e.dirty).map(e=>e.wrapper)}},t.currentComputed=function(){var e;return null==(e=Qe)?void 0:e.wrapper},t.watched=Symbol("watched"),t.unwatched=Symbol("unwatched")})(e.subtle||(e.subtle={}))})(ft||(ft={}));const wt={blockNames:ye,blocks:Se,cacheRadius:new ft.State(4),caveThreshold:new ft.State(80),cloudDensity:new ft.State(20),currentResolution:new ft.State("600"),decorationDensity:new ft.State(40),linkGameSave:new ft.State(!1),mountainScale:new ft.State(25),renderRadius:new ft.State(4),terrainOctaves:new ft.State(2),useAmbientOcclusion:new ft.State(!1),useAODebug:new ft.State(!1),useCaves:new ft.State(!0),useDynamicLighting:new ft.State(!1),usePerFaceLighting:new ft.State(!0),useSplitControls:new ft.State(!1),useTextureAtlas:new ft.State(!1),useTouchControls:new ft.State(!0),version:new ft.State("1"),viewRadius:new ft.State(128),worldRadius:new ft.State(384)};function Gt(e,t,n,o,r){const i=o/2,a=r/2;return{minX:e-i,maxX:e+i,minY:t-a,maxY:t+a,minZ:n-i,maxZ:n+i}}function kt(e,t){const{world:n}=e,o=Math.floor(t.minX),r=Math.ceil(t.maxX),i=Math.floor(t.minY),a=Math.ceil(t.maxY),l=Math.floor(t.minZ),s=Math.ceil(t.maxZ);for(let e=i;e<a;e++)for(let i=o;i<r;i++)for(let o=l;o<s;o++)if(Pe(n,i,e,o)){if(De(t,{minX:i,minY:e,minZ:o,maxX:i+1,maxY:e+1,maxZ:o+1}))return!0}return!1}function St(e,t,n,o){let{x:r,y:i,z:a,dx:l,dy:s,dz:c,playerWidth:d,playerHeight:g,onGround:u,flying:I,flySpeed:h}=n;const b=Xe(e," "),m=performance.now(),C=I.get();b&&!n.spacePressed&&(m-n.lastSpacePressTime<300?(I.set(!C),n.lastSpacePressTime=0):n.lastSpacePressTime=m),b&&!C&&u&&(s=12),n.spacePressed=b,C?s=Xe(e,"shift")?-h:b?h:0:s-=45*o;let A=r+l*o;const p=i+s*o;let v=a+c*o;const y=wt.worldRadius.get();y<2048&&(A>y?(A=y,l=0):A<-y&&(A=-y,l=0),v>y?(v=y,c=0):v<-y&&(v=-y,c=0));let f=!1;return kt(n,Gt(A,p,v,d,g))?(kt(n,Gt(A,i,a,d,g))?n.dx=0:r=A,kt(n,Gt(r,p,a,d,g))?(s<0&&(f=!0),s=0):i=p,kt(n,Gt(r,i,v,d,g))?n.dz=0:a=v):(r=A,i=p,a=v),n.dx=l,n.dy=s,n.dz=c,n.onGround=f,{x:r,y:i,z:a}}function Zt(e,t,n,o){const r=Math.abs(e-n),i=Math.abs(t-o);return r<=64&&i<=64}function Wt(e){const{world:t,x:n,z:o}=e,r=t.gravityQueue;if(!r||0===r.size)return;const i=r.dequeue(200),a=[];for(const e of i){const{x:i,y:l,z:s}=e;if(!Zt(i,s,n,o)){r.enqueue(i,l,s);continue}const c=t.getBlock(i,l,s);if(0===c)continue;const d=We(c);if(!d||!d.gravity)continue;0===t.getBlock(i,l-1,s)&&a.push({x:i,y:l,z:s,type:c})}for(const e of a){const{x:n,y:o,z:i,type:a}=e;t.setBlock(n,o,i,0),t.setBlock(n,o-1,i,a),r.enqueue(n,o-1,i);const l=t.getBlock(n,o+1,i);if(0!==l){const e=We(l);e&&e.gravity&&r.enqueue(n,o+1,i)}}}function Lt(e){const t=Ze(e);return t?t.id:-1}const Rt=Lt(ye.AGAVE_GROWING),Bt=Lt(ye.AGAVE_BASE),xt=Lt(ye.AGAVE_SPIKE),Tt=Lt(ye.AGAVE_FLOWER_STALK),Et=Lt(ye.AGAVE_FLOWER);const Nt=Lt(ye.BAMBOO_GROWING),Mt=Lt(ye.BAMBOO_STALK),Yt=Lt(ye.BAMBOO_JOINT),Vt=Lt(ye.BAMBOO_LEAVES);const Xt=Lt(ye.BERRY_BUSH_GROWING),Dt=Lt(ye.BERRY_BUSH_BRANCH),Jt=Lt(ye.BERRY_BUSH_LEAVES),zt=Lt(ye.BERRY_BUSH_BERRIES);const Ft=Lt(ye.BIRCH_GROWING),Pt=Lt(ye.BIRCH_TRUNK),jt=Lt(ye.BIRCH_LEAVES);Lt(ye.BIRCH_BRANCHES);const Ot=Lt(ye.CACTUS_GROWING),Ut=Lt(ye.CACTUS_BODY),Ht=Lt(ye.CACTUS_FLOWER);const _t=Lt(ye.CARROT_GROWING),Kt=Lt(ye.CARROT_LEAVES),Qt=Lt(ye.CARROT_ROOT);const qt=Lt(ye.CORN_GROWING),$t=Lt(ye.CORN_STALK),en=Lt(ye.CORN_LEAVES),tn=Lt(ye.CORN_EAR),nn=Lt(ye.CORN_SILK);const on=Lt(ye.FERN_GROWING),rn=Lt(ye.FERN_STEM),an=Lt(ye.FERN_FROND);const ln=Lt(ye.KELP_GROWING),sn=Lt(ye.KELP_BLADE),cn=Lt(ye.KELP_BULB);const dn=Lt(ye.LAVENDER_GROWING),gn=Lt(ye.LAVENDER_BUSH),un=Lt(ye.LAVENDER_STEM),In=Lt(ye.LAVENDER_FLOWERS);const hn=Lt(ye.LOTUS_GROWING),bn=Lt(ye.LOTUS_PAD),mn=Lt(ye.LOTUS_STEM),Cn=Lt(ye.LOTUS_BUD),An=Lt(ye.LOTUS_FLOWER);const pn=Lt(ye.MUSHROOM_GROWING),vn=Lt(ye.MUSHROOM_STEM),yn=Lt(ye.MUSHROOM_CAP);const fn=Lt(ye.PINE_TREE_GROWING),wn=Lt(ye.PINE_TRUNK),Gn=Lt(ye.PINE_NEEDLES);const kn=Lt(ye.PUMPKIN_GROWING),Sn=Lt(ye.PUMPKIN_VINE),Zn=Lt(ye.PUMPKIN_STEM),Wn=Lt(ye.PUMPKIN_LEAVES),Ln=Lt(ye.PUMPKIN_FRUIT);const Rn=Lt(ye.ROSE_GROWING),Bn=Lt(ye.ROSE_STEM),xn=Lt(ye.ROSE_THORNS),Tn=Lt(ye.ROSE_LEAVES),En=Lt(ye.ROSE_BUD),Nn=Lt(ye.ROSE_BLOOM);const Mn=Lt(ye.SUNFLOWER_GROWING),Yn=Lt(ye.SUNFLOWER_STEM),Vn=Lt(ye.SUNFLOWER_LEAVES),Xn=Lt(ye.SUNFLOWER_CENTER),Dn=Lt(ye.SUNFLOWER_PETALS);const Jn=Lt(ye.TULIP_GROWING),zn=Lt(ye.TULIP_BULB),Fn=Lt(ye.TULIP_STEM),Pn=Lt(ye.TULIP_LEAVES),jn=Lt(ye.TULIP_PETALS);const On=Lt(ye.WHEAT_GROWING),Un=Lt(ye.WHEAT_STALK),Hn=Lt(ye.WHEAT_GRAIN);const _n=Lt(ye.WILLOW_TREE_GROWING),Kn=Lt(ye.WILLOW_TRUNK),Qn=Lt(ye.WILLOW_BRANCHES),qn=Lt(ye.WILLOW_LEAVES);const $n={[ye.AGAVE]:function(e,t,n,o){const r=[];if(o<.2)return r.push({x:e,y:t,z:n,blockId:Rt}),r;if(r.push({x:e,y:t,z:n,blockId:Bt}),o>.4&&(o>.5&&r.push({x:e-1,y:t,z:n,blockId:xt}),o>.55&&r.push({x:e+1,y:t,z:n,blockId:xt}),o>.6&&r.push({x:e,y:t,z:n-1,blockId:xt}),o>.65&&r.push({x:e,y:t,z:n+1,blockId:xt})),o>.8){const i=3;for(let a=1;a<=i;a++)a===i&&o>.95?r.push({x:e,y:t+a,z:n,blockId:Et}):r.push({x:e,y:t+a,z:n,blockId:Tt})}return r},[ye.BAMBOO]:function(e,t,n,o){const r=[];if(o<.1)return r.push({x:e,y:t,z:n,blockId:Nt}),r;const i=Math.floor(8*o);if(0===i)return r.push({x:e,y:t,z:n,blockId:Nt}),r;for(let o=0;o<i;o++){const a=o%3==2;r.push({x:e,y:t+o,z:n,blockId:a?Yt:Mt}),a&&o<i-1&&(r.push({x:e+1,y:t+o,z:n,blockId:Vt}),r.push({x:e-1,y:t+o,z:n,blockId:Vt}))}return r},[ye.BERRY_BUSH]:function(e,t,n,o){const r=[];return o<.2?(r.push({x:e,y:t,z:n,blockId:Xt}),r):(r.push({x:e,y:t,z:n,blockId:Dt}),o>.4&&(r.push({x:e+1,y:t,z:n,blockId:Jt}),r.push({x:e-1,y:t,z:n,blockId:Jt}),r.push({x:e,y:t,z:n+1,blockId:Jt}),r.push({x:e,y:t,z:n-1,blockId:Jt}),r.push({x:e,y:t+1,z:n,blockId:Jt})),o>.8&&(r.push({x:e+1,y:t+1,z:n,blockId:zt}),r.push({x:e-1,y:t+1,z:n,blockId:zt}),r.push({x:e,y:t+1,z:n+1,blockId:zt}),r.push({x:e,y:t+1,z:n-1,blockId:zt})),r)},[ye.BIRCH]:function(e,t,n,o){const r=[];if(o<.1)return r.push({x:e,y:t,z:n,blockId:Ft}),r;const i=Math.floor(6*o);if(0===i)return r.push({x:e,y:t,z:n,blockId:Ft}),r;for(let o=0;o<i;o++)r.push({x:e,y:t+o,z:n,blockId:Pt});if(o>.5){for(let o=Math.max(2,i-3);o<i;o++)o%2==0&&(r.push({x:e+1,y:t+o,z:n,blockId:jt}),r.push({x:e-1,y:t+o,z:n,blockId:jt}),r.push({x:e,y:t+o,z:n+1,blockId:jt}),r.push({x:e,y:t+o,z:n-1,blockId:jt}));r.push({x:e,y:t+i,z:n,blockId:jt})}return r},[ye.CACTUS]:function(e,t,n,o){const r=[];if(o<.1)return r.push({x:e,y:t,z:n,blockId:Ot}),r;const i=(37*e+73*n)%100/100,a=Math.max(3,Math.min(7,Math.floor(3+4*i*o)));let l=t+a-1;for(let o=0;o<a;o++)r.push({x:e,y:t+o,z:n,blockId:Ut});let s=!1,c=l;const d=Math.max(0,2.5*(o-.3)),g=Math.min(2,Math.floor(d+.7*i));for(let l=0;l<g;l++){const d=.25+.15*l,g=Math.floor(t+d*(a-2));if(g>=t+a-1)continue;const u=(e+n+17*l)%4<2?1:-1,I=l%2==0,h=I?e+u:e,b=I?n:n+u;r.push({x:h,y:g,z:b,blockId:Ut});const m=Math.floor(1+i*o);let C=g;for(let e=1;e<=m;e++){const t=g+e;if(t>c+1)break;r.push({x:h,y:t,z:b,blockId:Ut}),C=t}!s&&o>.85&&(e+n+g)%5==1&&(r.push({x:h,y:C,z:b,blockId:Ht}),s=!0,c=Math.max(c,C))}return!s&&o>.9&&a>=4&&r.push({x:e,y:l,z:n,blockId:Ht}),r},[ye.CARROT]:function(e,t,n,o){const r=[];return o<.3?(r.push({x:e,y:t,z:n,blockId:_t}),r):(r.push({x:e,y:t,z:n,blockId:Qt}),o>.6&&r.push({x:e,y:t+1,z:n,blockId:Kt}),r)},[ye.CORN]:function(e,t,n,o){const r=[];return o<.2?(r.push({x:e,y:t,z:n,blockId:qt}),r):(r.push({x:e,y:t,z:n,blockId:$t}),o>.4&&r.push({x:e,y:t+1,z:n,blockId:$t}),o>.6&&(r.push({x:e+1,y:t,z:n,blockId:en}),r.push({x:e-1,y:t,z:n,blockId:en}),r.push({x:e+1,y:t+1,z:n,blockId:tn})),o>.8&&r.push({x:e+1,y:t+2,z:n,blockId:nn}),r)},[ye.FERN]:function(e,t,n,o){const r=[];return o<.2?(r.push({x:e,y:t,z:n,blockId:on}),r):(r.push({x:e,y:t,z:n,blockId:rn}),o>.5&&(r.push({x:e+1,y:t,z:n,blockId:an}),r.push({x:e-1,y:t,z:n,blockId:an}),r.push({x:e,y:t,z:n+1,blockId:an}),r.push({x:e,y:t,z:n-1,blockId:an})),o>.8&&r.push({x:e,y:t+1,z:n,blockId:an}),r)},[ye.KELP]:function(e,t,n,o){const r=[];if(o<.1)return r.push({x:e,y:t,z:n,blockId:ln}),r;const i=Math.floor(7*o);if(0===i)return r.push({x:e,y:t,z:n,blockId:ln}),r;for(let o=0;o<i;o++){const a=Math.round(Math.sin(.8*o+.1*e+.1*n)),l=o>=i-3?cn:sn;r.push({x:e+a,y:t+o,z:n,blockId:l})}if(o>.8){const e=r[r.length-1],t=e.y,n=e.x;[{dx:1,dz:0},{dx:-1,dz:0},{dx:0,dz:1},{dx:0,dz:-1}].forEach(o=>{r.push({x:n+o.dx,y:t,z:e.z+o.dz,blockId:cn})})}return r},[ye.LAVENDER]:function(e,t,n,o){const r=[];return o<.2?(r.push({x:e,y:t,z:n,blockId:dn}),r):(r.push({x:e,y:t,z:n,blockId:gn}),o>.4&&(r.push({x:e+1,y:t,z:n,blockId:gn}),r.push({x:e-1,y:t,z:n,blockId:gn}),r.push({x:e,y:t,z:n+1,blockId:gn}),r.push({x:e,y:t,z:n-1,blockId:gn})),o>.6&&(r.push({x:e,y:t+1,z:n,blockId:un}),r.push({x:e+1,y:t+1,z:n,blockId:un}),r.push({x:e-1,y:t+1,z:n,blockId:un}),r.push({x:e,y:t+1,z:n+1,blockId:un}),r.push({x:e,y:t+1,z:n-1,blockId:un})),o>.8&&(r.push({x:e,y:t+2,z:n,blockId:In}),r.push({x:e+1,y:t+2,z:n,blockId:In}),r.push({x:e-1,y:t+2,z:n,blockId:In}),r.push({x:e,y:t+2,z:n+1,blockId:In}),r.push({x:e,y:t+2,z:n-1,blockId:In})),r)},[ye.LOTUS]:function(e,t,n,o){const r=[];if(o<.2)return r.push({x:e,y:t,z:n,blockId:hn}),r;if(r.push({x:e,y:t,z:n,blockId:bn}),o>.4&&(r.push({x:e+1,y:t,z:n,blockId:bn}),r.push({x:e-1,y:t,z:n,blockId:bn}),r.push({x:e,y:t,z:n+1,blockId:bn}),r.push({x:e,y:t,z:n-1,blockId:bn})),o>.7){r.push({x:e,y:t+1,z:n,blockId:mn});const i=o>.9?An:Cn;r.push({x:e,y:t+2,z:n,blockId:i})}return r},[ye.MUSHROOM]:function(e,t,n,o){const r=[];if(o<.2)return r.push({x:e,y:t,z:n,blockId:pn}),r;const i=1+Math.floor(2*o);for(let o=0;o<i;o++)r.push({x:e,y:t+o,z:n,blockId:vn});return o>.6&&(r.push({x:e,y:t+i,z:n,blockId:yn}),r.push({x:e+1,y:t+i,z:n,blockId:yn}),r.push({x:e-1,y:t+i,z:n,blockId:yn}),r.push({x:e,y:t+i,z:n+1,blockId:yn}),r.push({x:e,y:t+i,z:n-1,blockId:yn}),o>.8&&(r.push({x:e+1,y:t+i-1,z:n,blockId:yn}),r.push({x:e-1,y:t+i-1,z:n,blockId:yn}),r.push({x:e,y:t+i-1,z:n+1,blockId:yn}),r.push({x:e,y:t+i-1,z:n-1,blockId:yn}))),r},[ye.PINE_TREE]:function(e,t,n,o){const r=[];if(o<.1)return r.push({x:e,y:t,z:n,blockId:fn}),r;const i=Math.floor(7*o);if(0===i)return r.push({x:e,y:t,z:n,blockId:fn}),r;for(let o=0;o<i;o++)r.push({x:e,y:t+o,z:n,blockId:wn});if(o>.4){for(let o=3;o<i;o++){const a=Math.max(1,Math.floor((i-o)/2));a>=1&&(r.push({x:e+1,y:t+o,z:n,blockId:Gn}),r.push({x:e-1,y:t+o,z:n,blockId:Gn}),r.push({x:e,y:t+o,z:n+1,blockId:Gn}),r.push({x:e,y:t+o,z:n-1,blockId:Gn}),a>1&&(r.push({x:e+1,y:t+o,z:n+1,blockId:Gn}),r.push({x:e-1,y:t+o,z:n+1,blockId:Gn}),r.push({x:e+1,y:t+o,z:n-1,blockId:Gn}),r.push({x:e-1,y:t+o,z:n-1,blockId:Gn})))}r.push({x:e,y:t+i,z:n,blockId:Gn})}return r},[ye.PUMPKIN]:function(e,t,n,o){const r=[];return o<.2?(r.push({x:e,y:t,z:n,blockId:kn}),r):(r.push({x:e,y:t,z:n,blockId:Zn}),o>.4&&r.push({x:e+1,y:t,z:n,blockId:Sn}),o>.6&&r.push({x:e+1,y:t+1,z:n,blockId:Wn}),o>.8&&r.push({x:e+2,y:t,z:n,blockId:Ln}),r)},[ye.ROSE]:function(e,t,n,o){const r=[];if(o<.2)return r.push({x:e,y:t,z:n,blockId:Rn}),r;const i=1+Math.floor(2*o),a=e=>e%2!=0,l=a(e+n),s=a(e)?1:-1;for(let o=0;o<i;o++)if(r.push({x:e,y:t+o,z:n,blockId:0===o?xn:Bn}),o>0&&o<i)if(1===o)l?(r.push({x:e+1,y:t+o,z:n,blockId:Tn}),r.push({x:e-1,y:t+o,z:n,blockId:Tn})):(r.push({x:e,y:t+o,z:n+1,blockId:Tn}),r.push({x:e,y:t+o,z:n-1,blockId:Tn}));else if(2===o){let i=e,a=n;l?i+=s:a+=s,r.push({x:i,y:t+o,z:a,blockId:Tn})}if(o>.8){const a=o>.95?Nn:En;r.push({x:e,y:t+i,z:n,blockId:a})}return r},[ye.SUNFLOWER]:function(e,t,n,o){const r=[];if(o<.1)return r.push({x:e,y:t,z:n,blockId:Mn}),r;const i=Math.max(1,Math.ceil(5*o));for(let o=0;o<i;o++)r.push({x:e,y:t+o,z:n,blockId:Yn});if(o>.3){const o=2;for(let a=o;a<i;a+=o){const i=a/o%4;0===i&&r.push({x:e-1,y:t+a,z:n,blockId:Vn}),1===i&&r.push({x:e,y:t+a,z:n-1,blockId:Vn}),2===i&&r.push({x:e+1,y:t+a,z:n,blockId:Vn}),3===i&&r.push({x:e,y:t+a,z:n+1,blockId:Vn})}}if(o>.7){const a=t+i-1;r.push({x:e,y:a,z:n,blockId:Xn}),o>.85&&(r.push({x:e-1,y:a,z:n,blockId:Dn}),r.push({x:e+1,y:a,z:n,blockId:Dn}),r.push({x:e,y:a,z:n-1,blockId:Dn}),r.push({x:e,y:a,z:n+1,blockId:Dn}))}return r},[ye.TULIP]:function(e,t,n,o){const r=[];if(o<.2)return r.push({x:e,y:t,z:n,blockId:Jn}),r;r.push({x:e,y:t,z:n,blockId:zn});const i=(e+t+n)%2!=0;return o>.4&&r.push({x:e,y:t+1,z:n,blockId:Fn}),o>.6&&(i?(r.push({x:e+1,y:t+1,z:n,blockId:Pn}),r.push({x:e-1,y:t+1,z:n,blockId:Pn})):(r.push({x:e,y:t+1,z:n+1,blockId:Pn}),r.push({x:e,y:t+1,z:n-1,blockId:Pn}))),o>.8&&r.push({x:e,y:t+2,z:n,blockId:jn}),r},[ye.WHEAT]:function(e,t,n,o){const r=[];return o<.2?(r.push({x:e,y:t,z:n,blockId:On}),r):(r.push({x:e,y:t,z:n,blockId:Un}),o>.5&&r.push({x:e,y:t+1,z:n,blockId:Un}),o>.8&&r.push({x:e,y:t+2,z:n,blockId:Hn}),r)},[ye.WILLOW_TREE]:function(e,t,n,o){const r=[];if(o<.1)return r.push({x:e,y:t,z:n,blockId:_n}),r;const i=e=>e%2!=0,a=5+(e+n)%3;if(0===a)return r.push({x:e,y:t,z:n,blockId:_n}),r;for(let o=0;o<a;o++)r.push({x:e,y:t+o,z:n,blockId:Kn});if(o>.4){const l=t+a,s=e,c=n;[{dx:0,dz:0},{dx:1,dz:0},{dx:-1,dz:0},{dx:0,dz:1},{dx:0,dz:-1}].forEach((a,d)=>{if(0===d||i(e+n+d)){const g=s+a.dx,u=c+a.dz;if(r.push({x:g,y:l,z:u,blockId:Qn}),o>.6){const o=2+(e*d+n)%4,a=Math.min(o,l-(t+1));for(let e=1;e<=a;e++)1===e&&(i(d)?r.push({x:g+1,y:l-e,z:u,blockId:qn}):r.push({x:g-1,y:l-e,z:u,blockId:qn})),r.push({x:g,y:l-e,z:u,blockId:qn})}}})}return r}};function eo(e,t){if(!e.plantStructures||!e.plantStructures[t])return!1;const n=e.plantStructures[t];if(!n.blocks||0===n.blocks.length)return delete e.plantStructures[t],e.growthTimers&&delete e.growthTimers[t],!0;let o=!0;for(const t of n.blocks){const n=`${t.x},${t.y},${t.z}`;if(void 0!==e.world.get(n)){o=!1;break}}return!!o&&(console.log(`[PlantGrowth] Plant at ${t} fully harvested, removing structure`),delete e.plantStructures[t],e.growthTimers&&delete e.growthTimers[t],!0)}function to(e){if(!e.growthTimers||!e.plantStructures)return;const t=e.fastGrowth,n=[];for(const[o,r]of Object.entries(e.growthTimers)){const i=r-.02,a=e.plantStructures[o];if(i<=0)a&&$n[a.type]&&no(e,o,1,a.type),n.push(o);else{if(e.growthTimers[o]=i,a&&$n[a.type]){const n=Ze(a.type);no(e,o,1-i/(t?30:n?.growthTime||10),a.type)}eo(e,o)}}for(const t of n)delete e.growthTimers[t],eo(e,t)}function no(e,t,n,o){const r=e.plantStructures[t];if(!r)return;const[i,a,l]=t.split(",").map(Number);if(r.blocks)for(const t of r.blocks){let n,o;"string"==typeof t?(n=t,o=void 0):(n=`${t.x},${t.y},${t.z}`,o=t.blockId);const r=e.world.get(n);void 0!==o&&r!==o||e.world.delete(n)}let s=[];const c=$n[o];c?s=c(i,a,l,n):console.warn(`[PlantGrowth] Generator not found for type: ${o}`);for(const t of s){const n=`${t.x},${t.y},${t.z}`;e.world.set(n,t.blockId)}r.blocks=s}let oo,ro=performance.now(),io=0;const ao={x:0,y:0,z:0};let lo=!0;const so=(e,t,n)=>e+(t-e)*n;function co(e,t,n,o,r){const i=t.mesh;if(!i||0===i.vertexCount)return;e.bindBuffer(e.ARRAY_BUFFER,i.positionBuffer),e.enableVertexAttribArray(0),e.vertexAttribPointer(0,3,e.FLOAT,!1,0,0),e.bindBuffer(e.ARRAY_BUFFER,i.normalBuffer),e.enableVertexAttribArray(1),e.vertexAttribPointer(1,3,e.FLOAT,!1,0,0),e.bindBuffer(e.ARRAY_BUFFER,i.colorBuffer),e.enableVertexAttribArray(2),e.vertexAttribPointer(2,4,e.FLOAT,!1,0,0),i.uvBuffer?(e.bindBuffer(e.ARRAY_BUFFER,i.uvBuffer),e.enableVertexAttribArray(3),e.vertexAttribPointer(3,2,e.FLOAT,!1,0,0)):e.disableVertexAttribArray(3),i.aoBuffer?(e.bindBuffer(e.ARRAY_BUFFER,i.aoBuffer),e.enableVertexAttribArray(4),e.vertexAttribPointer(4,1,e.FLOAT,!1,0,0)):(e.disableVertexAttribArray(4),e.vertexAttrib1f(4,1)),i.localUVBuffer?(e.bindBuffer(e.ARRAY_BUFFER,i.localUVBuffer),e.enableVertexAttribArray(5),e.vertexAttribPointer(5,2,e.FLOAT,!1,0,0)):e.disableVertexAttribArray(5),i.cornerAOBuffer?(e.bindBuffer(e.ARRAY_BUFFER,i.cornerAOBuffer),e.enableVertexAttribArray(6),e.vertexAttribPointer(6,4,e.FLOAT,!1,0,0)):e.disableVertexAttribArray(6);const a=pe();e.uniformMatrix4fv(o,!1,n),e.uniformMatrix4fv(r,!1,a),i.indexBuffer&&i.indexCount>0?(e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,i.indexBuffer),e.drawElements(e.TRIANGLES,i.indexCount,e.UNSIGNED_SHORT,0)):e.drawArrays(e.TRIANGLES,0,i.vertexCount)}let go=0,uo=0,Io=0,ho=0;function bo(e,t,n,o,r,i,a,l,s,c,d,g,u,I,h,b,m,C,A){if(o.shouldReset.get())return void o.shouldReset.set(!1);void 0===o.gameTime&&(o.gameTime=0),lo&&(ao.x=o.x,ao.y=o.y,ao.z=o.z,lo=!1);const{pitch:p,yaw:v,world:y}=o,f=performance.now(),w=Math.min(f-ro,250);ro=f,io+=w;let G=0;const k=.02;for(;io>=20&&G<20;){ao.x=o.x,ao.y=o.y,ao.z=o.z,Wt(o),Fe(e,o,k);const t=St(e,0,o,k);to(o),o.x=t.x,o.y=t.y,o.z=t.z,o.gameTime+=k,io-=20,G++}const S=io/20,Z=so(ao.x,o.x,S),W=so(ao.y,o.y,S),L=so(ao.z,o.z,S),R=performance.now();if(R-go>=200){const e=Math.round(Z),t=Math.round(W),n=Math.round(L);uo!==e&&(uo=e,i.playerX.textContent=e),Io!==t&&(Io=t,i.playerY.textContent=t),ho!==n&&(ho=n,i.playerZ.textContent=n),go=R}const B=W-o.playerHeight/2+1.62;o.hit=ve(y,{x:Z,y:B,z:L},{yaw:v,pitch:p}),a.viewport(0,0,t.width,t.height),a.enable(a.DEPTH_TEST);const[x,T,E,N]=n.Air;a.clearColor(x,T,E,N),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT);const M=Math.sin(v),Y=Math.cos(v),V=Math.cos(p),X=r.viewRadius.get(),D=t.clientWidth/t.clientHeight,J=((e,t,n,o,r)=>{const i=1/Math.tan(t/2),a=1/(o-r);return e.set([i/n,0,0,0,0,i,0,0,0,0,(r+o)*a,-1,0,0,2*r*o*a,0]),e})(pe(),Math.PI/3,D,.1,X),z=((e,t,n,o)=>{let r=t[0]-n[0],i=t[1]-n[1],a=t[2]-n[2],l=Math.hypot(r,i,a);r/=l,i/=l,a/=l;let s=o[1]*a-o[2]*i,c=o[2]*r-o[0]*a,d=o[0]*i-o[1]*r;l=Math.hypot(s,c,d),s/=l,c/=l,d/=l;let g=i*d-a*c,u=a*s-r*d,I=r*c-i*s;return e.set([s,g,r,0,c,u,i,0,d,I,a,0,-(s*t[0]+c*t[1]+d*t[2]),-(g*t[0]+u*t[1]+I*t[2]),-(r*t[0]+i*t[1]+a*t[2]),1]),e})(pe(),[Z,B,L],[Z+M*V,B+Math.sin(p),L+Y*V],[0,1,0]),F=((e,t,n)=>{for(let o=0;o<16;o++){const r=o>>2<<2,i=3&o;e[o]=n[r]*t[i]+n[r+1]*t[i+4]+n[r+2]*t[i+8]+n[r+3]*t[i+12]}return e})(pe(),J,z);if(a.uniform1f(b,r.useTextureAtlas.get()?1:0),a.uniform1f(m,r.useAmbientOcclusion.get()?1:0),a.uniform1f(C,r.usePerFaceLighting.get()?1:0),a.uniform1f(A,r.useAODebug.get()?1:0),r.useDynamicLighting.get()){const e=.01*o.gameTime,t=Math.cos(e),n=-Math.abs(Math.sin(e))-.2,r=Math.sin(e);a.uniform3f(g,t,n,r)}else a.uniform3f(g,-.5,-1,-.3);const P=y.updateVisibleChunks(Z,L,o.seed||0,a,Ve,o.growthTimers,o.plantStructures,e=>{for(const t of e){const e=o.plantStructures[t];if(!e)continue;const n=o.growthTimers?o.growthTimers[t]:void 0;let r=1;if(void 0!==n){const t=Ze(e.type),i=o.fastGrowth?30:t?.growthTime||10;r=Math.max(0,1-n/i)}no(o,t,r,e.type)}});let j=0;for(const e of P)e.dirty&&j<10&&(e.mesh=Me(n,e,y,Se),e.dirty=!1,Ye(a,e),j++),e.mesh&&e.mesh.vertexCount>0&&co(a,e,F,I,u);r.useSplitControls.get()&&function(e,t){e.disable(e.DEPTH_TEST);const n=t.width/2,o=t.height/2;e.enable(e.SCISSOR_TEST),e.clearColor(1,1,1,.8),e.scissor(n-10,o-1,20,2),e.clear(e.COLOR_BUFFER_BIT),e.scissor(n-1,o-10,2,20),e.clear(e.COLOR_BUFFER_BIT),e.disable(e.SCISSOR_TEST),e.enable(e.DEPTH_TEST)}(a,t),oo=requestAnimationFrame(()=>bo(e,t,n,o,r,i,a,l,s,c,d,g,u,I,h,b,m,C,A))}function mo(e=1,t=4294967295){return"object"==typeof globalThis.crypto&&"function"==typeof globalThis.crypto.getRandomValues?function(e,t){const n=t-e+1,o=4294967295;let r,i;i=o-o%n;do{r=globalThis.crypto.getRandomValues(new Uint32Array(1))[0]}while(r>i);return e+r%n}(e,t):(n=e,o=t,Math.floor(Math.random()*(o-n+1))+n);var n,o}function Co(e){const t=Se.find(t=>t.name===e);return t?t.id:-1}const Ao={FOREST:{name:"Forest",trees:!0,surfaceBlockId:Co(ye.GRASS),subBlockId:Co(ye.DIRT),cropBlockIds:[Co(ye.BERRY_BUSH),Co(ye.BIRCH),Co(ye.CARROT),Co(ye.FERN),Co(ye.LAVENDER),Co(ye.PINE_TREE),Co(ye.PUMPKIN),Co(ye.ROSE),Co(ye.TULIP),Co(ye.WHEAT)]},DESERT:{name:"Desert",trees:!1,surfaceBlockId:Co(ye.SAND),subBlockId:Co(ye.SAND),cropBlockIds:[Co(ye.AGAVE),Co(ye.CACTUS),Co(ye.SUNFLOWER)]},TUNDRA:{name:"Tundra",trees:!1,surfaceBlockId:Co(ye.SNOW),subBlockId:Co(ye.ICE),cropBlockIds:[Co(ye.BIRCH),Co(ye.FERN),Co(ye.PINE_TREE)]},SWAMP:{name:"Swamp",trees:!0,surfaceBlockId:Co(ye.CLAY),subBlockId:Co(ye.CLAY),cropBlockIds:[Co(ye.BAMBOO),Co(ye.CORN),Co(ye.KELP),Co(ye.LOTUS),Co(ye.MUSHROOM),Co(ye.WILLOW_TREE)]}};Lt(ye.GRASS),Lt(ye.DIRT),Lt(ye.STONE),Lt(ye.WATER),Lt(ye.SAND),Lt(ye.SNOW),Lt(ye.ICE),Lt(ye.CLAY),Lt(ye.BEDROCK),Lt(ye.LAVA),Lt(ye.COAL),Lt(ye.IRON),Lt(ye.GOLD),Lt(ye.CLOUD),Lt(ye.WOOD),Lt(ye.TREE_LEAVES);class po{constructor(){this.candidates=new Set}get size(){return this.candidates.size}enqueue(e,t,n){t<=1||this.candidates.add(`${e},${t},${n}`)}dequeue(e){const t=[],n=this.candidates.values();for(let o=0;o<e;o++){const e=n.next();if(e.done)break;const o=e.value;this.candidates.delete(o);const[r,i,a]=o.split(",").map(Number);t.push({x:r,y:i,z:a})}return t}clear(){this.candidates.clear()}has(e,t,n){return this.candidates.has(`${e},${t},${n}`)}}let vo,yo=!1;const fo=new URLSearchParams(globalThis.location?.search);if(fo.has("seed")){const e=Number(fo.get("seed"));p(e)&&!isNaN(e)&&e>=1&&e<=Number.MAX_SAFE_INTEGER?vo=e:(vo=mo(),yo=!0)}else vo=mo();function wo(e){if(e<0||e>=9)return;ko.activeMaterialBarSlot.set(e);const t=ko.materialBar.get();ko.curBlock.set(t[e])}function Go(e){const t=ko.activeMaterialBarSlot.get(),n=[...ko.materialBar.get()];n[t]=e,ko.materialBar.set(n),ko.curBlock.set(e)}const ko={curBlock:new ft.State(Lt("Dirt")),world:new class{constructor(){this.chunks=new Map,this.gravityQueue=new po,this.blockTypes=null,this.storedChunks=new Map,this.storedPlantStates=new Map,this.storedMetadata=new Map,this.workers=[];const e=globalThis.navigator?.hardwareConcurrency||4;for(let t=0;t<e;t++){const e=new Worker(new URL("data:text/javascript;base64,Y2xhc3Mgb3tjb25zdHJ1Y3RvcihvLGUpe3RoaXMuY2h1bmtYPW8sdGhpcy5jaHVua1o9ZSx0aGlzLmJsb2Nrcz1uZXcgVWludDhBcnJheSgzMjc2OCksdGhpcy5kaXJ0eT0hMCx0aGlzLmdlbmVyYXRlZD0hMSx0aGlzLnJlc3RvcmVkPSExLHRoaXMubWVzaD1udWxsLHRoaXMubW9kaWZpZWRCbG9ja3M9bmV3IE1hcCx0aGlzLm1ldGFkYXRhPW5ldyBNYXB9bWFya01vZGlmaWVkKG8sZSxuLHMsaT1udWxsKXtpZighdGhpcy5pbkJvdW5kcyhvLGUsbikpcmV0dXJuO2NvbnN0IHI9dGhpcy5pbmRleChvLGUsbik7dGhpcy5tb2RpZmllZEJsb2Nrcy5zZXQocixzKSxpP3RoaXMubWV0YWRhdGEuc2V0KHIsaSk6dGhpcy5tZXRhZGF0YS5kZWxldGUocil9Z2V0TW9kaWZpY2F0aW9ucygpe3JldHVybiB0aGlzLm1vZGlmaWVkQmxvY2tzfWFwcGx5TW9kaWZpY2F0aW9ucyhvLGU9bnVsbCl7Zm9yKGNvbnN0W2Usbl1vZiBvKXRoaXMuYmxvY2tzW2VdPW47aWYodGhpcy5tb2RpZmllZEJsb2Nrcz1uZXcgTWFwKG8pLGUpZm9yKGNvbnN0W28sbl1vZiBlKXRoaXMubWV0YWRhdGEuc2V0KG8sbik7dGhpcy5kaXJ0eT0hMH1oYXNNb2RpZmljYXRpb25zKCl7cmV0dXJuIHRoaXMubW9kaWZpZWRCbG9ja3Muc2l6ZT4wfWluZGV4KG8sZSxuKXtyZXR1cm4gbysxNipuKzE2KmUqMTZ9aW5Cb3VuZHMobyxlLG4pe3JldHVybiBvPj0wJiZvPDE2JiZlPj0wJiZlPDEyOCYmbj49MCYmbjwxNn1nZXRCbG9jayhvLGUsbil7cmV0dXJuIHRoaXMuaW5Cb3VuZHMobyxlLG4pP3RoaXMuYmxvY2tzW3RoaXMuaW5kZXgobyxlLG4pXTowfXNldEJsb2NrKG8sZSxuLHMpe2lmKCF0aGlzLmluQm91bmRzKG8sZSxuKSlyZXR1cm4hMTtjb25zdCBpPXRoaXMuaW5kZXgobyxlLG4pO3JldHVybiB0aGlzLmJsb2Nrc1tpXSE9PXMmJih0aGlzLmJsb2Nrc1tpXT1zLHRoaXMuZGlydHk9ITApLCEwfWlzRW1wdHkoKXtmb3IobGV0IG89MDtvPDMyNzY4O28rKylpZigwIT09dGhpcy5ibG9ja3Nbb10pcmV0dXJuITE7cmV0dXJuITB9Y2xlYXIoKXt0aGlzLmJsb2Nrcy5maWxsKDApLHRoaXMuZGlydHk9ITB9Z2V0IHdvcmxkWCgpe3JldHVybiAxNip0aGlzLmNodW5rWH1nZXQgd29ybGRaKCl7cmV0dXJuIDE2KnRoaXMuY2h1bmtafXRvVHJhbnNmZXJhYmxlKCl7cmV0dXJue2NodW5rWDp0aGlzLmNodW5rWCxjaHVua1o6dGhpcy5jaHVua1osYmxvY2tzOnRoaXMuYmxvY2tzLmJ1ZmZlci5zbGljZSgwKX19c3RhdGljIGZyb21Db21wcmVzc2VkKGUpe2NvbnN0IG49bmV3IG8oZS5jaHVua1gsZS5jaHVua1opO3JldHVybiBuLmJsb2Nrcy5zZXQobmV3IFVpbnQ4QXJyYXkoZS5ibG9ja3MpKSxufX1jb25zdCBlPTEvMyxuPTEvNixzPW89PjB8TWF0aC5mbG9vcihvKSxpPW5ldyBGbG9hdDY0QXJyYXkoWzEsMSwwLC0xLDEsMCwxLC0xLDAsLTEsLTEsMCwxLDAsMSwtMSwwLDEsMSwwLC0xLC0xLDAsLTEsMCwxLDEsMCwtMSwxLDAsMSwtMSwwLC0xLC0xXSk7ZnVuY3Rpb24gcihvPU1hdGgucmFuZG9tKXtjb25zdCByPWZ1bmN0aW9uKG8pe2NvbnN0IGU9NTEyLG49bmV3IFVpbnQ4QXJyYXkoZSk7Zm9yKGxldCBvPTA7bzwyNTY7bysrKW5bb109bztmb3IobGV0IGU9MDtlPDI1NTtlKyspe2NvbnN0IHM9ZSt+fihvKCkqKDI1Ni1lKSksaT1uW2VdO25bZV09bltzXSxuW3NdPWl9Zm9yKGxldCBvPTI1NjtvPGU7bysrKW5bb109bltvLTI1Nl07cmV0dXJuIG59KG8pLGQ9bmV3IEZsb2F0NjRBcnJheShyKS5tYXAobz0+aVtvJTEyKjNdKSxsPW5ldyBGbG9hdDY0QXJyYXkocikubWFwKG89PmlbbyUxMiozKzFdKSx0PW5ldyBGbG9hdDY0QXJyYXkocikubWFwKG89PmlbbyUxMiozKzJdKTtyZXR1cm4gZnVuY3Rpb24obyxpLGEpe2xldCB1LGMscCxtO2NvbnN0IGg9KG8raSthKSplLGY9cyhvK2gpLEI9cyhpK2gpLHc9cyhhK2gpLGs9KGYrQit3KSpuLGc9by0oZi1rKSxTPWktKEItayksVD1hLSh3LWspO2xldCB2LE0sYixMLEMsQTtnPj1TP1M+PVQ/KHY9MSxNPTAsYj0wLEw9MSxDPTEsQT0wKTpnPj1UPyh2PTEsTT0wLGI9MCxMPTEsQz0wLEE9MSk6KHY9MCxNPTAsYj0xLEw9MSxDPTAsQT0xKTpTPFQ/KHY9MCxNPTAsYj0xLEw9MCxDPTEsQT0xKTpnPFQ/KHY9MCxNPTEsYj0wLEw9MCxDPTEsQT0xKToodj0wLE09MSxiPTAsTD0xLEM9MSxBPTApO2NvbnN0IHk9Zy12K24sST1TLU0rbixSPVQtYituLE89Zy1MKzIqbixFPVMtQysyKm4sRz1ULUErMipuLFA9Zy0xKy41LFc9Uy0xKy41LEY9VC0xKy41LEQ9MjU1JmYsTj0yNTUmQixVPTI1NSZ3O2xldCB4PS42LWcqZy1TKlMtVCpUO2lmKHg8MCl1PTA7ZWxzZXtjb25zdCBvPUQrcltOK3JbVV1dO3gqPXgsdT14KngqKGRbb10qZytsW29dKlMrdFtvXSpUKX1sZXQgWD0uNi15KnktSSpJLVIqUjtpZihYPDApYz0wO2Vsc2V7Y29uc3Qgbz1EK3YrcltOK00rcltVK2JdXTtYKj1YLGM9WCpYKihkW29dKnkrbFtvXSpJK3Rbb10qUil9bGV0IFo9LjYtTypPLUUqRS1HKkc7aWYoWjwwKXA9MDtlbHNle2NvbnN0IG89RCtMK3JbTitDK3JbVStBXV07Wio9WixwPVoqWiooZFtvXSpPK2xbb10qRSt0W29dKkcpfWxldCBLPS42LVAqUC1XKlctRipGO2lmKEs8MCltPTA7ZWxzZXtjb25zdCBvPUQrMStyW04rMStyW1UrMV1dO0sqPUssbT1LKksqKGRbb10qUCtsW29dKlcrdFtvXSpGKX1yZXR1cm4gMzIqKHUrYytwK20pfX12YXIgZD1mdW5jdGlvbigpe3JldHVybiBvLmltcG9ydFN0YXRlPWZ1bmN0aW9uKGUpe3ZhciBuPW5ldyBvO3JldHVybiBuLmltcG9ydFN0YXRlKGUpLG59LG87ZnVuY3Rpb24gbygpe3JldHVybiBmdW5jdGlvbihvKXt2YXIgZT0wLG49MCxzPTAsaT0xOzA9PW8ubGVuZ3RoJiYobz1bK25ldyBEYXRlXSk7dmFyIHI9ZnVuY3Rpb24oKXt2YXIgbz00MDIyODcxMTk3LGU9ZnVuY3Rpb24oZSl7ZT1lLnRvU3RyaW5nKCk7Zm9yKHZhciBuPTA7bjxlLmxlbmd0aDtuKyspe3ZhciBzPS4wMjUxOTYwMzI4MjQxNjkzOCoobys9ZS5jaGFyQ29kZUF0KG4pKTtzLT1vPXM+Pj4wLG89KHMqPW8pPj4+MCxvKz00Mjk0OTY3Mjk2KihzLT1vKX1yZXR1cm4gMi4zMjgzMDY0MzY1Mzg2OTYzZS0xMCoobz4+PjApfTtyZXR1cm4gZS52ZXJzaW9uPSJNYXNoIDAuOSIsZX0oKTtlPXIoIiAiKSxuPXIoIiAiKSxzPXIoIiAiKTtmb3IodmFyIGQ9MDtkPG8ubGVuZ3RoO2QrKykoZS09cihvW2RdKSk8MCYmKGUrPTEpLChuLT1yKG9bZF0pKTwwJiYobis9MSksKHMtPXIob1tkXSkpPDAmJihzKz0xKTtyPW51bGw7dmFyIGw9ZnVuY3Rpb24oKXt2YXIgbz0yMDkxNjM5KmUrMi4zMjgzMDY0MzY1Mzg2OTYzZS0xMCppO3JldHVybiBlPW4sbj1zLHM9by0oaT0wfG8pfTtyZXR1cm4gbC5uZXh0PWwsbC51aW50MzI9ZnVuY3Rpb24oKXtyZXR1cm4gNDI5NDk2NzI5NipsKCl9LGwuZnJhY3Q1Mz1mdW5jdGlvbigpe3JldHVybiBsKCkrMTExMDIyMzAyNDYyNTE1NjVlLTMyKigyMDk3MTUyKmwoKXwwKX0sbC52ZXJzaW9uPSJBbGVhIDAuOSIsbC5hcmdzPW8sbC5leHBvcnRTdGF0ZT1mdW5jdGlvbigpe3JldHVybltlLG4scyxpXX0sbC5pbXBvcnRTdGF0ZT1mdW5jdGlvbihvKXtlPStvWzBdfHwwLG49K29bMV18fDAscz0rb1syXXx8MCxpPStvWzNdfHwwfSxsfShBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMpKX19KCk7bGV0IGw9bnVsbCx0PW51bGw7Y29uc3QgYT1uZXcgTWFwO2Z1bmN0aW9uIHUobyl7aWYobyE9PXR8fCFsKWlmKHQ9byxhLmhhcyhvKSlsPWEuZ2V0KG8pO2Vsc2UgaWYobD1yKGQobykpLGEuc2V0KG8sbCksYS5zaXplPjIwKXtjb25zdCBvPWEua2V5cygpLm5leHQoKS52YWx1ZTthLmRlbGV0ZShvKX19ZnVuY3Rpb24gYyhvLGUsbj0wLHM9MyxpPS41LHI9LjAyKXtsJiZ0PT09bnx8dShuKTtsZXQgZD0wLGE9MSxjPXIscD0wO2ZvcihsZXQgbj0wO248cztuKyspZCs9bChvKmMsZSpjLDApKmEscCs9YSxhKj1pLGMqPTI7cmV0dXJuIGQvcH1mdW5jdGlvbiBwKG8sZSxuLHM9MCxpPTMscj0uNSxkPS4wMil7bCYmdD09PXN8fHUocyk7bGV0IGE9MCxjPTEscD1kLG09MDtmb3IobGV0IHM9MDtzPGk7cysrKWErPWwobypwLGUqcCxuKnApKmMsbSs9YyxjKj1yLHAqPTI7cmV0dXJuIGEvbX1mdW5jdGlvbiBtKG8sZSxuPTAscz0hMSl7cmV0dXJuIGMobyxlLG4scz8yOjQsLjUsLjAxKX1mdW5jdGlvbiBoKG8sZSxuPTUwMCl7cmV0dXJuIGMobyxlLG4sMiwuOCwuMDA1KX1mdW5jdGlvbiBmKG8sZSxuLHM9MWUzKXtyZXR1cm4gcChvLGUsbixzLDIsLjUsLjA0KX1mdW5jdGlvbiBCKG8sZSxuLHM9M2UzKXtyZXR1cm4gcChvLGUsbixzLDIsLjQsLjA4KX1jb25zdCB3PSJBZ2F2ZSIsaz0iQmFtYm9vIixnPSJCZWRyb2NrIixTPSJCZXJyeSBCdXNoIixUPSJCaXJjaCIsdj0iQ2FjdHVzIixNPSJDYXJyb3QiLGI9IkNsYXkiLEw9IkNsb3VkIixDPSJDb2FsIixBPSJDb3JuIix5PSJEaXJ0IixJPSJGZXJuIixSPSJHb2xkIixPPSJHcmFzcyIsRT0iSWNlIixHPSJJcm9uIixQPSJLZWxwIixXPSJMYXZhIixGPSJMYXZlbmRlciIsRD0iTG90dXMiLE49Ik11c2hyb29tIixVPSJQaW5lIFRyZWUiLHg9IlB1bXBraW4iLFg9IlJvc2UiLFo9IlNhbmQiLEs9IlNub3ciLEg9IlN0b25lIixWPSJTdW5mbG93ZXIiLF89IlRyZWUgTGVhdmVzIix6PSJUdWxpcCIsWT0iV2F0ZXIiLGo9IldoZWF0IixKPSJXaWxsb3cgVHJlZSIscT0iV29vZCIsUT1be25hbWU6IkFpciIsaWQ6MCxkcm9wczpudWxsLHNvbGlkOiExfSx7bmFtZToiQWdhdmUgQmFzZSIsaWQ6ODIsZHJvcHM6bnVsbCxzb2xpZDohMH0se25hbWU6IkFnYXZlIEZsb3dlciBTdGFsayIsaWQ6ODQsZHJvcHM6bnVsbCxzb2xpZDohMH0se25hbWU6IkFnYXZlIEZsb3dlciIsaWQ6ODUsZHJvcHM6bnVsbCxzb2xpZDohMH0se25hbWU6IkFnYXZlIEdyb3dpbmciLGlkOjgxLGRyb3BzOm51bGwsc29saWQ6ITAsY3JvcDohMH0se25hbWU6IkFnYXZlIFNwaWtlIixpZDo4Myxkcm9wczpudWxsLHNvbGlkOiEwfSx7bmFtZTp3LGlkOjgwLGRyb3BzOiJBR0FWRSIsc29saWQ6ITAsZ3Jvd3RoVGltZToxOTIwLGlzU2VlZDohMCxjcm9wOiEwfSx7bmFtZToiQmFtYm9vIEdyb3dpbmciLGlkOjQzLGRyb3BzOm51bGwsc29saWQ6ITAsY3JvcDohMH0se25hbWU6IkJhbWJvbyBKb2ludCIsaWQ6NTMsZHJvcHM6bnVsbCxzb2xpZDohMH0se25hbWU6IkJhbWJvbyBMZWF2ZXMiLGlkOjU0LGRyb3BzOm51bGwsc29saWQ6ITB9LHtuYW1lOiJCYW1ib28gU3RhbGsiLGlkOjUyLGRyb3BzOm51bGwsc29saWQ6ITB9LHtuYW1lOmssaWQ6MzYsZHJvcHM6IkJBTUJPTyIsc29saWQ6ITAsZ3Jvd3RoVGltZToxODAsaXNTZWVkOiEwLGNyb3A6ITB9LHtuYW1lOmcsaWQ6MTksZHJvcHM6bnVsbCxzb2xpZDohMH0se25hbWU6IkJlcnJ5IEJ1c2ggQmVycmllcyIsaWQ6NTEsZHJvcHM6bnVsbCxzb2xpZDohMH0se25hbWU6IkJlcnJ5IEJ1c2ggQnJhbmNoIixpZDo0OSxkcm9wczpudWxsLHNvbGlkOiEwfSx7bmFtZToiQmVycnkgQnVzaCBHcm93aW5nIixpZDo0Mixkcm9wczpudWxsLHNvbGlkOiEwLGNyb3A6ITB9LHtuYW1lOiJCZXJyeSBCdXNoIExlYXZlcyIsaWQ6NTAsZHJvcHM6bnVsbCxzb2xpZDohMH0se25hbWU6UyxpZDozNSxkcm9wczoiQkVSUllfQlVTSCIsc29saWQ6ITAsZ3Jvd3RoVGltZTozNjAsaXNTZWVkOiEwLGNyb3A6ITB9LHtuYW1lOiJCaXJjaCBCYXJrIixpZDoxMTcsZHJvcHM6bnVsbCxzb2xpZDohMH0se25hbWU6IkJpcmNoIEJyYW5jaGVzIixpZDoxMTgsZHJvcHM6bnVsbCxzb2xpZDohMH0se25hbWU6IkJpcmNoIENhdGtpbnMiLGlkOjEyMCxkcm9wczpudWxsLHNvbGlkOiEwfSx7bmFtZToiQmlyY2ggR3Jvd2luZyIsaWQ6MTE1LGRyb3BzOm51bGwsc29saWQ6ITAsY3JvcDohMH0se25hbWU6IkJpcmNoIExlYXZlcyIsaWQ6MTE5LGRyb3BzOm51bGwsc29saWQ6ITB9LHtuYW1lOiJCaXJjaCBUcnVuayIsaWQ6MTE2LGRyb3BzOm51bGwsc29saWQ6ITB9LHtuYW1lOlQsaWQ6MTE0LGRyb3BzOlsiQklSQ0giLCJXT09EIl0sc29saWQ6ITAsZ3Jvd3RoVGltZToxMjYwLGlzU2VlZDohMCxjcm9wOiEwfSx7bmFtZToiQ2FjdHVzIEJvZHkiLGlkOjMwLGRyb3BzOm51bGwsc29saWQ6ITB9LHtuYW1lOiJDYWN0dXMgRmxvd2VyIixpZDozMSxkcm9wczpudWxsLHNvbGlkOiEwfSx7bmFtZToiQ2FjdHVzIEdyb3dpbmciLGlkOjIzLGRyb3BzOm51bGwsc29saWQ6ITAsY3JvcDohMH0se25hbWU6dixpZDoxNSxkcm9wczoiQ0FDVFVTIixzb2xpZDohMCxncm93dGhUaW1lOjI0MDAsaXNTZWVkOiEwLGNyb3A6ITB9LHtuYW1lOiJDYXJyb3QgR3Jvd2luZyIsaWQ6MjEsZHJvcHM6bnVsbCxzb2xpZDohMCxjcm9wOiEwfSx7bmFtZToiQ2Fycm90IExlYXZlcyIsaWQ6MjYsZHJvcHM6bnVsbCxzb2xpZDohMH0se25hbWU6IkNhcnJvdCBSb290IixpZDoyNyxkcm9wczpudWxsLHNvbGlkOiEwfSx7bmFtZTpNLGlkOjEzLGRyb3BzOiJDQVJST1QiLHNvbGlkOiEwLGdyb3d0aFRpbWU6MjQwLGlzU2VlZDohMCxjcm9wOiEwfSx7bmFtZTpiLGlkOjYsZHJvcHM6IkNMQVkiLHNvbGlkOiEwfSx7bmFtZTpMLGlkOjcyLGRyb3BzOiJDTE9VRCIsc29saWQ6ITB9LHtuYW1lOkMsaWQ6Nyxkcm9wczoiQ09BTCIsc29saWQ6ITB9LHtuYW1lOiJDb3JuIEVhciIsaWQ6NjEsZHJvcHM6bnVsbCxzb2xpZDohMH0se25hbWU6IkNvcm4gR3Jvd2luZyIsaWQ6NDUsZHJvcHM6bnVsbCxzb2xpZDohMCxjcm9wOiEwfSx7bmFtZToiQ29ybiBMZWF2ZXMiLGlkOjYwLGRyb3BzOm51bGwsc29saWQ6ITB9LHtuYW1lOiJDb3JuIFNpbGsiLGlkOjYyLGRyb3BzOm51bGwsc29saWQ6ITB9LHtuYW1lOiJDb3JuIFN0YWxrIixpZDo1OSxkcm9wczpudWxsLHNvbGlkOiEwfSx7bmFtZTpBLGlkOjM4LGRyb3BzOiJDT1JOIixzb2xpZDohMCxncm93dGhUaW1lOjQyMCxpc1NlZWQ6ITAsY3JvcDohMH0se25hbWU6eSxpZDoyLGRyb3BzOiJESVJUIixzb2xpZDohMH0se25hbWU6IkZlcm4gRnJvbmQiLGlkOjcwLGRyb3BzOm51bGwsc29saWQ6ITB9LHtuYW1lOiJGZXJuIEdyb3dpbmciLGlkOjQ4LGRyb3BzOm51bGwsc29saWQ6ITAsY3JvcDohMH0se25hbWU6IkZlcm4gU3RlbSIsaWQ6NjksZHJvcHM6bnVsbCxzb2xpZDohMH0se25hbWU6SSxpZDo0MSxkcm9wczoiRkVSTiIsc29saWQ6ITAsZ3Jvd3RoVGltZTo5MCxpc1NlZWQ6ITAsY3JvcDohMH0se25hbWU6UixpZDo5LGRyb3BzOiJHT0xEIixzb2xpZDohMH0se25hbWU6TyxpZDoxLGRyb3BzOiJHUkFTUyIsc29saWQ6ITB9LHtuYW1lOkUsaWQ6MTcsZHJvcHM6IklDRSIsc29saWQ6ITB9LHtuYW1lOkcsaWQ6OCxkcm9wczoiSVJPTiIsc29saWQ6ITB9LHtuYW1lOiJLZWxwIEJsYWRlIixpZDo5Myxkcm9wczpudWxsLHNvbGlkOiEwfSx7bmFtZToiS2VscCBCdWxiIixpZDo5NCxkcm9wczpudWxsLHNvbGlkOiEwfSx7bmFtZToiS2VscCBHcm93aW5nIixpZDo5Mixkcm9wczpudWxsLHNvbGlkOiEwLGNyb3A6ITB9LHtuYW1lOlAsaWQ6OTEsZHJvcHM6IktFTFAiLHNvbGlkOiEwLGdyb3d0aFRpbWU6MTUwLGlzU2VlZDohMCxjcm9wOiEwfSx7bmFtZTpXLGlkOjE4LGRyb3BzOm51bGwsc29saWQ6ITAsZ3Jhdml0eTohMH0se25hbWU6IkxhdmVuZGVyIEJ1c2giLGlkOjg5LGRyb3BzOm51bGwsc29saWQ6ITB9LHtuYW1lOiJMYXZlbmRlciBGbG93ZXJzIixpZDo5MCxkcm9wczpudWxsLHNvbGlkOiEwfSx7bmFtZToiTGF2ZW5kZXIgR3Jvd2luZyIsaWQ6ODcsZHJvcHM6bnVsbCxzb2xpZDohMCxjcm9wOiEwfSx7bmFtZToiTGF2ZW5kZXIgU3RlbSIsaWQ6ODgsZHJvcHM6bnVsbCxzb2xpZDohMH0se25hbWU6RixpZDo4Nixkcm9wczoiTEFWRU5ERVIiLHNvbGlkOiEwLGdyb3d0aFRpbWU6MjAwLGlzU2VlZDohMCxjcm9wOiEwfSx7bmFtZToiTG90dXMgQnVkIixpZDoxMTIsZHJvcHM6bnVsbCxzb2xpZDohMH0se25hbWU6IkxvdHVzIEZsb3dlciIsaWQ6MTEzLGRyb3BzOm51bGwsc29saWQ6ITB9LHtuYW1lOiJMb3R1cyBHcm93aW5nIixpZDoxMDksZHJvcHM6bnVsbCxzb2xpZDohMCxjcm9wOiEwfSx7bmFtZToiTG90dXMgUGFkIixpZDoxMTAsZHJvcHM6bnVsbCxzb2xpZDohMH0se25hbWU6IkxvdHVzIFN0ZW0iLGlkOjExMSxkcm9wczpudWxsLHNvbGlkOiEwfSx7bmFtZTpELGlkOjEwOCxkcm9wczoiTE9UVVMiLHNvbGlkOiEwLGdyb3d0aFRpbWU6MzkwLGlzU2VlZDohMCxjcm9wOiEwfSx7bmFtZToiTXVzaHJvb20gQ2FwIixpZDoyOSxkcm9wczpudWxsLHNvbGlkOiEwfSx7bmFtZToiTXVzaHJvb20gR3Jvd2luZyIsaWQ6MjIsZHJvcHM6bnVsbCxzb2xpZDohMCxjcm9wOiEwfSx7bmFtZToiTXVzaHJvb20gU3RlbSIsaWQ6MjgsZHJvcHM6bnVsbCxzb2xpZDohMH0se25hbWU6TixpZDoxNCxkcm9wczoiTVVTSFJPT00iLHNvbGlkOiEwLGdyb3d0aFRpbWU6MTIwLGlzU2VlZDohMCxjcm9wOiEwfSx7bmFtZToiUGluZSBDb25lIixpZDo2NSxkcm9wczpudWxsLHNvbGlkOiEwfSx7bmFtZToiUGluZSBOZWVkbGVzIixpZDo2NCxkcm9wczpudWxsLHNvbGlkOiEwfSx7bmFtZToiUGluZSBUcmVlIEdyb3dpbmciLGlkOjQ2LGRyb3BzOm51bGwsc29saWQ6ITAsY3JvcDohMH0se25hbWU6VSxpZDozOSxkcm9wczoiUElORV9UUkVFIixzb2xpZDohMCxncm93dGhUaW1lOjE0NDAsaXNTZWVkOiEwLGNyb3A6ITB9LHtuYW1lOiJQaW5lIFRydW5rIixpZDo2Myxkcm9wczpudWxsLHNvbGlkOiEwfSx7bmFtZToiUHVtaWNlIixpZDo3MSxkcm9wczoiUFVNSUNFIixzb2xpZDohMH0se25hbWU6IlB1bXBraW4gRnJ1aXQiLGlkOjEwNixkcm9wczpudWxsLHNvbGlkOiEwfSx7bmFtZToiUHVtcGtpbiBHcm93aW5nIixpZDoxMDMsZHJvcHM6bnVsbCxzb2xpZDohMCxjcm9wOiEwfSx7bmFtZToiUHVtcGtpbiBMZWF2ZXMiLGlkOjEwNSxkcm9wczpudWxsLHNvbGlkOiEwfSx7bmFtZToiUHVtcGtpbiBTdGVtIixpZDoxMDcsZHJvcHM6bnVsbCxzb2xpZDohMH0se25hbWU6IlB1bXBraW4gVmluZSIsaWQ6MTA0LGRyb3BzOm51bGwsc29saWQ6ITB9LHtuYW1lOngsaWQ6MTAyLGRyb3BzOiJQVU1QS0lOIixzb2xpZDohMCxncm93dGhUaW1lOjY2MCxpc1NlZWQ6ITAsY3JvcDohMH0se25hbWU6IlJvc2UgQmxvb20iLGlkOjEwMSxkcm9wczpudWxsLHNvbGlkOiEwfSx7bmFtZToiUm9zZSBCdWQiLGlkOjEwMCxkcm9wczpudWxsLHNvbGlkOiEwfSx7bmFtZToiUm9zZSBHcm93aW5nIixpZDo5Nixkcm9wczpudWxsLHNvbGlkOiEwLGNyb3A6ITB9LHtuYW1lOiJSb3NlIExlYXZlcyIsaWQ6OTksZHJvcHM6bnVsbCxzb2xpZDohMH0se25hbWU6IlJvc2UgU3RlbSIsaWQ6OTcsZHJvcHM6bnVsbCxzb2xpZDohMH0se25hbWU6IlJvc2UgVGhvcm5zIixpZDo5OCxkcm9wczpudWxsLHNvbGlkOiEwfSx7bmFtZTpYLGlkOjk1LGRyb3BzOiJST1NFIixzb2xpZDohMCxncm93dGhUaW1lOjU0MCxpc1NlZWQ6ITAsY3JvcDohMH0se25hbWU6WixpZDo1LGRyb3BzOiJTQU5EIixzb2xpZDohMCxncmF2aXR5OiEwfSx7bmFtZTpLLGlkOjE2LGRyb3BzOiJTTk9XIixzb2xpZDohMH0se25hbWU6SCxpZDozLGRyb3BzOiJTVE9ORSIsc29saWQ6ITB9LHtuYW1lOiJTdW5mbG93ZXIgQ2VudGVyIixpZDo1Nyxkcm9wczpudWxsLHNvbGlkOiEwfSx7bmFtZToiU3VuZmxvd2VyIEdyb3dpbmciLGlkOjQ0LGRyb3BzOm51bGwsc29saWQ6ITAsY3JvcDohMH0se25hbWU6IlN1bmZsb3dlciBMZWF2ZXMiLGlkOjU2LGRyb3BzOm51bGwsc29saWQ6ITB9LHtuYW1lOiJTdW5mbG93ZXIgUGV0YWxzIixpZDo1OCxkcm9wczpudWxsLHNvbGlkOiEwfSx7bmFtZToiU3VuZmxvd2VyIFN0ZW0iLGlkOjU1LGRyb3BzOiJTVU5GTE9XRVIiLHNvbGlkOiEwfSx7bmFtZTpWLGlkOjM3LGRyb3BzOm51bGwsc29saWQ6ITAsZ3Jvd3RoVGltZTo2MDAsaXNTZWVkOiEwLGNyb3A6ITB9LHtuYW1lOiJUcmVlIEdyb3dpbmciLGlkOjM0LGRyb3BzOm51bGwsc29saWQ6ITAsY3JvcDohMH0se25hbWU6XyxpZDoxMSxkcm9wczpudWxsLHNvbGlkOiEwLGNyb3A6ITB9LHtuYW1lOiJUcmVlIFRydW5rIixpZDoxMCxkcm9wczoiV09PRCIsc29saWQ6ITAsY3JvcDohMH0se25hbWU6IlR1bGlwIEJ1bGIiLGlkOjc5LGRyb3BzOm51bGwsc29saWQ6ITB9LHtuYW1lOiJUdWxpcCBHcm93aW5nIixpZDo3NSxkcm9wczpudWxsLHNvbGlkOiEwLGNyb3A6ITB9LHtuYW1lOiJUdWxpcCBMZWF2ZXMiLGlkOjc3LGRyb3BzOm51bGwsc29saWQ6ITB9LHtuYW1lOiJUdWxpcCBQZXRhbHMiLGlkOjc4LGRyb3BzOm51bGwsc29saWQ6ITB9LHtuYW1lOiJUdWxpcCBTdGVtIixpZDo3Nixkcm9wczpudWxsLHNvbGlkOiEwfSx7bmFtZTp6LGlkOjc0LGRyb3BzOiJUVUxJUCIsc29saWQ6ITAsZ3Jvd3RoVGltZTozMDAsaXNTZWVkOiEwLGNyb3A6ITB9LHtuYW1lOlksaWQ6NCxkcm9wczpudWxsLHNvbGlkOiEwLGdyYXZpdHk6ITB9LHtuYW1lOiJXaGVhdCBHcmFpbiIsaWQ6MjUsZHJvcHM6bnVsbCxzb2xpZDohMH0se25hbWU6IldoZWF0IEdyb3dpbmciLGlkOjIwLGRyb3BzOm51bGwsc29saWQ6ITAsY3JvcDohMH0se25hbWU6IldoZWF0IFN0YWxrIixpZDoyNCxkcm9wczpudWxsLHNvbGlkOiEwfSx7bmFtZTpqLGlkOjEyLGRyb3BzOiJXSEVBVCIsc29saWQ6ITAsZ3Jvd3RoVGltZTo0ODAsaXNTZWVkOiEwLGNyb3A6ITB9LHtuYW1lOiJXaWxsb3cgQnJhbmNoZXMiLGlkOjY3LGRyb3BzOm51bGwsc29saWQ6ITB9LHtuYW1lOiJXaWxsb3cgTGVhdmVzIixpZDo2OCxkcm9wczpudWxsLHNvbGlkOiEwfSx7bmFtZToiV2lsbG93IFRyZWUgR3Jvd2luZyIsaWQ6NDcsZHJvcHM6bnVsbCxzb2xpZDohMCxjcm9wOiEwfSx7bmFtZTpKLGlkOjQwLGRyb3BzOlsiV0lMTE9XX1RSRUUiLCJXT09EIl0sc29saWQ6ITAsZ3Jvd3RoVGltZToxODAwLGlzU2VlZDohMCxjcm9wOiEwfSx7bmFtZToiV2lsbG93IFRydW5rIixpZDo2Nixkcm9wczpudWxsLHNvbGlkOiEwfSx7bmFtZTpxLGlkOjczLGRyb3BzOiJXT09EIixzb2xpZDohMCxjcm9wOiEwfSx7bmFtZToiTGluayIsaWQ6MTMwLGRyb3BzOm51bGwsc29saWQ6ITB9XSwkPW5ldyBBcnJheSgyNTYpLmZpbGwodm9pZCAwKSxvbz1uZXcgTWFwLGVvPW5ldyBNYXA7US5mb3JFYWNoKChvLGUpPT57ZW8uc2V0KG8uaWQsZSksdm9pZCAwIT09by5pZCYmby5pZDwyNTYmJigkW28uaWRdPW8pLG8ubmFtZSYmb28uc2V0KG8ubmFtZSxvKX0pO2NvbnN0IG5vPU9iamVjdC5hc3NpZ24oUSx7Z2V0QnlJZDpvPT4kW29dLGdldEJ5TmFtZTpvPT5vby5nZXQobyl9KTtmdW5jdGlvbiBzbyhvKXtjb25zdCBlPW5vLmZpbmQoZT0+ZS5uYW1lPT09byk7cmV0dXJuIGU/ZS5pZDotMX1jb25zdCBpbz17Rk9SRVNUOntuYW1lOiJGb3Jlc3QiLHRyZWVzOiEwLHN1cmZhY2VCbG9ja0lkOnNvKE8pLHN1YkJsb2NrSWQ6c28oeSksY3JvcEJsb2NrSWRzOltzbyhTKSxzbyhUKSxzbyhNKSxzbyhJKSxzbyhGKSxzbyhVKSxzbyh4KSxzbyhYKSxzbyh6KSxzbyhqKV19LERFU0VSVDp7bmFtZToiRGVzZXJ0Iix0cmVlczohMSxzdXJmYWNlQmxvY2tJZDpzbyhaKSxzdWJCbG9ja0lkOnNvKFopLGNyb3BCbG9ja0lkczpbc28odyksc28odiksc28oVildfSxUVU5EUkE6e25hbWU6IlR1bmRyYSIsdHJlZXM6ITEsc3VyZmFjZUJsb2NrSWQ6c28oSyksc3ViQmxvY2tJZDpzbyhFKSxjcm9wQmxvY2tJZHM6W3NvKFQpLHNvKEkpLHNvKFUpXX0sU1dBTVA6e25hbWU6IlN3YW1wIix0cmVlczohMCxzdXJmYWNlQmxvY2tJZDpzbyhiKSxzdWJCbG9ja0lkOnNvKGIpLGNyb3BCbG9ja0lkczpbc28oayksc28oQSksc28oUCksc28oRCksc28oTiksc28oSildfX07ZnVuY3Rpb24gcm8obyxlLG4pe2NvbnN0IHM9aChvLGUsbis2MDApLGk9aChvLGUsbis3MDApO3JldHVybiBzPC0uND9pby5UVU5EUkE6cz4uNCYmaTwtLjI/aW8uREVTRVJUOmk+LjM/aW8uU1dBTVA6aW8uRk9SRVNUfWZ1bmN0aW9uIGxvKG8pe2NvbnN0IGU9ZnVuY3Rpb24obyl7cmV0dXJuIG9vLmdldChvKX0obyk7cmV0dXJuIGU/ZS5pZDotMX1sbyhPKSxsbyh5KTtjb25zdCB0bz1sbyhIKSxhbz1sbyhZKSx1bz1sbyhaKTtsbyhLKSxsbyhFKSxsbyhiKTtjb25zdCBjbz1sbyhnKSxwbz1sbyhXKSxtbz1sbyhDKSxobz1sbyhHKSxmbz1sbyhSKSxCbz1sbyhMKSx3bz1sbyhxKSxrbz1sbyhfKSxnbz0xMjg7ZnVuY3Rpb24gU28obyxlLG4scyxpLHIsZCxsKXtpZihuPj1nb3x8MD09PWkuY3JvcEJsb2NrSWRzLmxlbmd0aClyZXR1cm47Y29uc3QgdD1NYXRoLmZsb29yKFRvKGQrMTAwLGwrMTAwLHIpKmkuY3JvcEJsb2NrSWRzLmxlbmd0aCksYT1pLmNyb3BCbG9ja0lkc1t0XTthPjAmJjA9PT1vLmdldEJsb2NrKGUsbixzKSYmby5zZXRCbG9jayhlLG4scyxhKX1mdW5jdGlvbiBUbyhvLGUsbil7Y29uc3Qgcz00Mzc1OC41NDUzKk1hdGguc2luKDEyLjk4OTgqbys3OC4yMzMqZSs0Mzc1OC41NDUzKm4pO3JldHVybiBzLU1hdGguZmxvb3Iocyl9ZnVuY3Rpb24gdm8obyxlLG4scyxpLHIpe2NvbnN0IGQ9NCtNYXRoLmZsb29yKDIqVG8oZSxzLG4pKTtmb3IobGV0IHI9MDtyPGQ7cisrKW4rcjxnbyYmby5zZXRCbG9jayhlLG4rcixzLGkpO2ZvcihsZXQgaT0tMjtpPD0yO2krKylmb3IobGV0IGw9LTI7bDw9MjtsKyspZm9yKGxldCB0PWQtMjt0PD1kKzE7dCsrKXtjb25zdCBhPWUraSx1PXMrbCxjPW4rdDthPDB8fGE+PTE2fHx1PDB8fHU+PTE2fHxjPj1nb3x8TWF0aC5hYnMoaSkrTWF0aC5hYnMobCkrTWF0aC5hYnModC1kKTw9MyYmMD09PW8uZ2V0QmxvY2soYSxjLHUpJiZvLnNldEJsb2NrKGEsYyx1LHIpfX1zZWxmLm9ubWVzc2FnZT1lPT57Y29uc3R7Y2h1bmtYOm4sY2h1bmtaOnMsc2VlZDppfT1lLmRhdGEscj1uZXcgbyhuLHMpLHtzZXR0aW5nczpkPXt9fT1lLmRhdGE7IWZ1bmN0aW9uKG8sZSxuPXt9KXtjb25zdHt0ZXJyYWluT2N0YXZlczpzPTQsbW91bnRhaW5TY2FsZTppPTUwLGRlY29yYXRpb25EZW5zaXR5OnI9MTAwLGNhdmVUaHJlc2hvbGQ6ZD01NSx1c2VDYXZlczpsPSEwLGNsb3VkRGVuc2l0eTp0PTEwMH09bjtpZighby5nZW5lcmF0ZWQpe3UoZSk7Zm9yKGxldCBuPTA7bjwxNjtuKyspZm9yKGxldCBhPTA7YTwxNjthKyspe2NvbnN0IHU9by53b3JsZFgrbixoPW8ud29ybGRaK2Esdz1ybyh1LGgsZSksaz1jKHUsaCxlLHMsLjUsLjAxKTtsZXQgZz1NYXRoLmZsb29yKChrKzEpLzIqMzArMzApO2lmKGk+MCl7Y29uc3Qgbz1tKC41KnUsLjUqaCxlKzEwMCwhMSk7bz4uNiYmKGcrPU1hdGguZmxvb3IoKG8tLjYpKmkpKX1NYXRoLmFicyh1KTwzJiZNYXRoLmFicyhoKTwzJiYoZz1NYXRoLm1heChnLDMzKSksZz1NYXRoLm1pbihnLDExOCk7Zm9yKGxldCBpPTA7aTw9Z287aSsrKXtsZXQgcj0wO2lmKGk8PWcpe2NvbnN0IG89Zy1pO2lmKGk8MilyPWNvO2Vsc2UgaWYoaTw1KXI9VG8odSxoLGkrZSk8Ljc/cG86Y287ZWxzZSBpZihpPT09ZylyPWk8MzM/dW86dy5zdXJmYWNlQmxvY2tJZDtlbHNlIGlmKG88NClyPXcuc3ViQmxvY2tJZDtlbHNlIGlmKHI9dG8scz4yKXtjb25zdCBuPUIodSxpLGgsZSk7bz49MzAmJm88PTcwJiZuPi44P3I9Zm86bz49MjAmJm88PTYwJiZuPi42NT9yPWhvOm8+PTEwJiZvPD01MCYmbj4uNTUmJihyPW1vKX1sJiZpPjgmJmk8Zy0yMCYmciE9PWNvJiZyIT09cG8mJmYodSxpLGgsZSk+ZC8xMDAmJihyPTApfWVsc2UgaTw9MzI/cj1hbzooTWF0aC5hYnModSk+Nnx8TWF0aC5hYnMoaCk+NikmJmk+PTEwMCYmaTw9MTIwJiZwKHUsaSxoLGUsdD41MD8yOjEsLjUsLjA1KT4xLXQvMjAwLS4wNSYmKHI9Qm8pOzAhPT1yJiZvLnNldEJsb2NrKG4saSxhLHIpfWc+MzImJih3LnRyZWVzJiYoTWF0aC5hYnModSk+NHx8TWF0aC5hYnMoaCk+NCkmJlRvKHUsaCxlKTxyLzEwMCouMDImJnUlMyE9MCYmaCUzIT0wJiZ2byhvLG4sZysxLGEsd28sa28pLCh3LmNyb3BCbG9ja0lkcy5sZW5ndGg+MCYmVG8odSxoLGUrNTAwKTxyLzEwMCouMDAyJiYhdy50cmVlc3x8dy5jcm9wQmxvY2tJZHMubGVuZ3RoPjAmJlRvKHUsaCxlKzFlMyk8ci8xMDAqNWUtNCkmJlNvKG8sbixnKzEsYSx3LGUsdSxoKSl9by5nZW5lcmF0ZWQ9ITAsby5kaXJ0eT0hMH19KHIsaSxkKTtjb25zdCBsPXIudG9UcmFuc2ZlcmFibGUoKTtzZWxmLnBvc3RNZXNzYWdlKGwsW2wuYmxvY2tzXSl9Owo=",import.meta.url),{type:"module"});e.onmessage=this.handleWorkerMessage.bind(this),this.workers.push(e)}this.nextWorkerIndex=0}handleWorkerMessage(e){const{chunkX:t,chunkZ:n,blocks:o}=e.data,r=this.getChunkKey(t,n),i=this.chunks.get(r);if(i){i.blocks.set(new Uint8Array(o)),i.generated=!0;const e=i.getModifications(),t=i.metadata;e.size>0&&i.applyModifications(e,t),i.dirty=!0}}restoreChunkPersistence(e,t=null,n=null,o=null){const r=this.getChunkKey(e.chunkX,e.chunkZ),i=this.storedChunks.get(r),a=this.storedMetadata.get(r);if(i&&(e.applyModifications(i,a),this.storedChunks.delete(r),this.storedMetadata.delete(r)),this.storedPlantStates.has(r)){console.log(`[Persistence] Restoring plant state for chunk ${r}`);const{timers:e,structures:i}=this.storedPlantStates.get(r);if(t&&Object.assign(t,e),n)for(const[e,t]of Object.entries(i))n[e]=t;if(this.storedPlantStates.delete(r),o&&n){const e=Object.keys(i).filter(e=>n[e]);o(e)}}e.restored=!0,e.dirty=!0}getChunkKey(e,t){return`${e},${t}`}getOrCreateChunk(e,t){const n=this.getChunkKey(e,t);let o=this.chunks.get(n);return o||(o=new h(e,t),this.chunks.set(n,o)),o}getChunk(e,t){return this.chunks.get(this.getChunkKey(e,t))}getBlock(e,t,n){if(t<=0)return 1;if(t>=u)return 0;const o=Math.floor(e),r=Math.floor(t),i=Math.floor(n),{chunkX:a,chunkZ:l,localX:s,localZ:c}=b(o,i),d=this.getChunk(a,l);return d?d.getBlock(s,r,c):0}setBlock(e,t,n,o,r=!1,i=null){if(t<=0||t>=u)return!1;const a=Math.floor(e),l=Math.floor(t),s=Math.floor(n),{chunkX:c,chunkZ:d,localX:g,localZ:I}=b(a,s),h=this.getOrCreateChunk(c,d),m=h.setBlock(g,l,I,o);if(m&&(this.markNeighborsDirty(c,d,g,I),r&&h.markModified(g,l,I,o,i),this.blockTypes&&0!==o)){const e=We(o);e&&e.gravity&&this.gravityQueue.enqueue(a,l,s)}return m}markNeighborsDirty(e,t,n,o){if(0===n){const n=this.getChunk(e-1,t);n&&(n.dirty=!0)}if(15===n){const n=this.getChunk(e+1,t);n&&(n.dirty=!0)}if(0===o){const n=this.getChunk(e,t-1);n&&(n.dirty=!0)}if(15===o){const n=this.getChunk(e,t+1);n&&(n.dirty=!0)}}hasBlock(e,t,n){return 0!==this.getBlock(e,t,n)}deleteBlock(e,t,n,o=!1){const r=Math.floor(e),i=Math.floor(t),a=Math.floor(n),l=this.setBlock(r,i,a,0,o);if(l&&this.blockTypes){const e=this.getBlock(r,i+1,a);if(0!==e){const t=We(e);t&&t.gravity&&this.gravityQueue.enqueue(r,i+1,a)}}return l}clear(){this.chunks.clear(),this.storedChunks.clear(),this.storedPlantStates.clear()}getAllChunks(){return this.chunks.values()}getVisibleChunks(e,t){const{chunkX:n,chunkZ:o}=b(e,t),r=[],i=wt.renderRadius.get();for(const e of this.chunks.values()){const t=Math.abs(e.chunkX-n),a=Math.abs(e.chunkZ-o);t<=i&&a<=i&&r.push(e)}return r}updateVisibleChunks(e,t,n,o,r,i=null,a=null,l=null){const{chunkX:s,chunkZ:c}=b(e,t),d=[],u=wt.cacheRadius.get(),I=wt.worldRadius.get(),h=wt.renderRadius.get(),m=e=>{if(!e.generated&&!e.generating){e.generating=!0;const t=this.workers[this.nextWorkerIndex];return this.nextWorkerIndex=(this.nextWorkerIndex+1)%this.workers.length,void t.postMessage({chunkX:e.chunkX,chunkZ:e.chunkZ,seed:n,settings:{terrainOctaves:wt.terrainOctaves.get(),mountainScale:wt.mountainScale.get(),decorationDensity:wt.decorationDensity.get(),caveThreshold:wt.caveThreshold.get(),useCaves:wt.useCaves.get(),cloudDensity:wt.cloudDensity.get()}})}e.generated&&!e.restored&&this.restoreChunkPersistence(e,i,a,l)};for(let e=0;e<=h;e++)if(0===e){const e=this.getOrCreateChunk(s,c);m(e),e.generated&&d.push(e)}else for(let t=-e;t<=e;t++)for(let n=-e;n<=e;n++){if(Math.abs(t)!==e&&Math.abs(n)!==e)continue;const o=s+t,r=c+n,i=I>2048?null:I;if(null!==i){const e=Math.floor(i/g);if(Math.abs(o)>e||Math.abs(r)>e)continue}const a=this.getOrCreateChunk(o,r);m(a),a.generated&&d.push(a)}const C=[];for(const[e,t]of this.chunks){const n=Math.abs(t.chunkX-s),l=Math.abs(t.chunkZ-c);if(n>u||l>u){const n=t.getModifications();if(n.size>0&&this.storedChunks&&(this.storedChunks.set(e,new Map(n)),t.metadata?.size>0&&this.storedMetadata&&this.storedMetadata.set(e,new Map(t.metadata))),o&&r&&r(o,t),i&&a){const n={},o={};let r=!1;for(const e of Object.keys(i)){const[o,a,l]=e.split(",").map(Number),{chunkX:s,chunkZ:c}=b(o,l);s===t.chunkX&&c===t.chunkZ&&(n[e]=i[e],delete i[e],r=!0)}for(const e of Object.keys(a)){const[n,i,l]=e.split(",").map(Number),{chunkX:s,chunkZ:c}=b(n,l);s===t.chunkX&&c===t.chunkZ&&(o[e]=a[e],delete a[e],r=!0)}r&&(console.log(`[Persistence] Storing plant state for chunk ${e}`),this.storedPlantStates.set(e,{timers:n,structures:o}))}C.push(e)}else(n>h||l>h)&&t.generated&&d.push(t)}for(const e of C)this.chunks.delete(e);return d.sort((e,t)=>Math.abs(e.chunkX-s)+Math.abs(e.chunkZ-c)-(Math.abs(t.chunkX-s)+Math.abs(t.chunkZ-c)))}forEach(e){for(const t of this.chunks.values()){const n=t.worldX,o=t.worldZ;for(let r=1;r<u;r++)for(let i=0;i<I;i++)for(let a=0;a<g;a++){const l=t.getBlock(a,r,i);if(0!==l){e(l,`${n+a},${r},${o+i}`)}}}}*entries(){for(const e of this.chunks.values()){const t=e.worldX,n=e.worldZ;for(let o=1;o<u;o++)for(let r=0;r<I;r++)for(let i=0;i<g;i++){const a=e.getBlock(i,o,r);if(0!==a){const e=`${t+i},${o},${n+r}`;yield[e,a]}}}}has(e){const[t,n,o]=e.split(",").map(Number);return this.hasBlock(t,n,o)}get(e){const[t,n,o]=e.split(",").map(Number),r=this.getBlock(t,n,o);return 0===r?void 0:r}set(e,t,n=!1,o=null){const[r,i,a]=e.split(",").map(Number);return this.setBlock(r,i,a,t,n,o),this}delete(e,t=!1){const[n,o,r]=e.split(",").map(Number);return this.deleteBlock(n,o,r,t)}},seed:vo,yaw:0,pitch:0,x:0,y:99,z:0,dx:0,dy:0,dz:0,gameTime:0,playerHeight:1.8,playerWidth:.6,flySpeed:10,flying:new ft.State(!1),onGround:!1,hit:null,lastSpacePressTime:0,spacePressed:!1,isCanvasActionDisabled:!1,uiButtonActive:!1,plantStructures:{},growthTimers:{},fastGrowth:!1,shouldReset:new ft.State(!1),arrowsControlCamera:new ft.State(!0),actionKeyPressTime:0,hasEnabledExtras:new ft.State(!1),materialsInventory:new ft.State([]),materialBar:new ft.State([Lt("Dirt"),Lt("Sand"),Lt("Mushroom"),Lt("Sunflower"),Lt("Lotus"),Lt("Rose"),Lt("Pine Tree"),Lt("Gold"),Lt("Stone")]),activeMaterialBarSlot:new ft.State(0),armedLinkConfig:new ft.State({worldName:"",params:{}})},So={currentBlock:new ft.Computed(()=>{const e=We(ko.curBlock.get());return e?.name||"Air"})};function Zo(e,t){const n=ko[e]?.get();void 0!==n&&ko[e].set(t(n))}function Wo(e,t){const n=wt[e]?.get();void 0!==n&&wt[e].set(t(n))}function Lo(e,t){return wt[e]?.set(t)}function Ro(e){return wt[e]?.get()}function Bo(e,t){return ko[e]?.set(t)}function xo(e){return ko[e]?.get()}async function To(e,t){wt.version.set(t);const n=wt.blocks.filter(e=>"Air"!==e.name).map(e=>e.id);return ko.materialsInventory.set(n),ko.world.blockTypes=wt.blocks,e.blockGarden={...e?.blockGarden,config:wt,state:ko,computed:So,setConfig:Lo,getConfig:Ro,updateConfig:Wo,setState:Bo,getState:xo,updateState:Zo},{computedSignals:So,gameConfig:wt,gameState:ko,invalidSeedProvided:yo}}var Eo,No={exports:{}},Mo=No.exports;var Yo=(Eo||(Eo=1,function(e){var t,n,o,r;t=Mo||globalThis,n=function e(t){var n=this,o={},r=e;r.getNumberOfInstance=function(){return r._numberOfInstance},n.enable=function(){return o.listenCodeCharSequence(),o.listenCodeGestureSequence(),o.debug&&o.debug("Listener enabled for all."),n},n.enableKeyboardKeys=function(){return o.listenCodeCharSequence(),o.debug&&o.debug("Listener enabled for Keyboard Keys."),n},n.enableTouchGesture=function(){return o.listenCodeGestureSequence(),o.debug&&o.debug("Listener enabled for Touch Gesture."),n},n.disable=function(){return o.stopCodeCharSequence(),o.stopCodeGestureSequence(),o.debug&&o.debug("Listener disabled for all."),n},n.disableKeyboardKeys=function(){return o.stopCodeCharSequence(),o.debug&&o.debug("Listener disabled for Keyboard Keys."),n},n.disableTouchGesture=function(){return o.stopCodeGestureSequence(),o.debug&&o.debug("Listener disabled for Touch Gesture."),n},n.setListener=function(e){return o.stopCodeCharSequence(),o.stopCodeGestureSequence(),o.listener=e||document,o.listenCodeCharSequence(),o.listenCodeGestureSequence(),o.debug&&o.debug("Listener changed.",e),n},n.setCallback=function(e){return o.afterCodeSequenceCallback="function"==typeof e&&e||o.defaultCallback,o.debug&&o.debug("Callback changed.",e),n},n.setOptions=function(e){return o.initOptions(e),n},o.keptLastCodeChar=function(){o.input.length>o.konamiCodeChar.length&&(o.input=o.input.substr(o.input.length-o.konamiCodeChar.length))},o.defaultCallback=function(){o.debug&&o.debug("Konami Code Sequence Entered. There is no action defined.")},o.checkIfCodeCharIsValid=function(){o.input===o.konamiCodeChar&&o.afterCodeSequenceCallback(n)},o.codeSequenceEventKeyDown=function(e){o.input+=e.keyCode,o.keptLastCodeChar(),o.checkIfCodeCharIsValid()},o.codeSequenceEventTouchMove=function(e){var t;1===e.touches.length&&!0===o.capture&&(t=e.touches[0],o.stopX=t.pageX,o.stopY=t.pageY,o.tap=!1,o.capture=!1,o.checkIfCodeGestureIsValid())},o.codeSequenceEventTouchEnd=function(){!0===o.tap&&o.checkIfCodeGestureIsValid()},o.codeSequenceEventTouchStart=function(e){o.startX=e.changedTouches[0].pageX,o.startY=e.changedTouches[0].pageY,o.tap=!0,o.capture=!0},o.stopCodeCharSequence=function(){o.listener.removeEventListener("keydown",o.codeSequenceEventKeyDown)},o.stopCodeGestureSequence=function(){o.listener.removeEventListener("touchstart",o.codeSequenceEventTouchStart),o.listener.removeEventListener("touchmove",o.codeSequenceEventTouchMove),o.listener.removeEventListener("touchend",o.codeSequenceEventTouchEnd)},o.listenCodeCharSequence=function(){o.stopCodeCharSequence(),o.listener.addEventListener("keydown",o.codeSequenceEventKeyDown)},o.listenCodeGestureSequence=function(){o.originalCodeGesture=o.konamiCodeGesture,o.stopCodeGestureSequence(),o.listener.addEventListener("touchstart",o.codeSequenceEventTouchStart),o.listener.addEventListener("touchmove",o.codeSequenceEventTouchMove),o.listener.addEventListener("touchend",o.codeSequenceEventTouchEnd,!1)},o.checkIfCodeGestureIsValid=function(){var e=Math.abs(o.startX-o.stopX),t=Math.abs(o.startY-o.stopY),r=o.startX-o.stopX<0?"rt":"lt",i=o.startY-o.stopY<0?"dn":"up",a=e>t?r:i;(a=!0===o.tap?"tp":a)===o.konamiCodeGesture.substr(0,2)?o.konamiCodeGesture=o.konamiCodeGesture.substr(2,o.konamiCodeGesture.length-2):o.konamiCodeGesture=o.originalCodeGesture,0===o.konamiCodeGesture.length&&(o.konamiCodeGesture=o.originalCodeGesture,o.afterCodeSequenceCallback(n))},o.checkDebugMode=function(e){e&&!0===e.debug?(o.debug=function(e,t){void 0!==t?console.log(e,t):console.log(e)},o.debug&&o.debug("Debug Mode On.")):o.debug=!1},o.initOptions=function(e){o.checkDebugMode(e),o.listener=e&&e.listener||document,o.afterCodeSequenceCallback="function"==typeof e&&e||e&&"function"==typeof e.callback&&e.callback||o.defaultCallback},o.init=function(){o.input="",o.konamiCodeChar="38384040373937396665",o.konamiCodeGesture="upupdndnltrtltrttptp",o.startX=0,o.startY=0,o.stopX=0,o.stopY=0,o.tap=!1,o.capture=!1,r._numberOfInstance=r._numberOfInstance?r._numberOfInstance+1:1,o.initOptions(t),o.listenCodeCharSequence(),o.listenCodeGestureSequence()},o.init()},o=t.KonamiCode,(r=t.KonamiCode=n).noConflict=function(){return t.KonamiCode=o,r},e.exports&&(e.exports=n)}(No)),No.exports),Vo=t(Yo);let Xo=!0;const Do=new ft.subtle.Watcher(()=>{Xo&&(Xo=!1,globalThis.queueMicrotask(Jo))});function Jo(){Xo=!0;for(const e of Do.getPending())e.get();Do.watch()}function zo(e){let t;const n=new ft.Computed(()=>{"function"==typeof t&&t(),t=e()});return Do.watch(n),n.get(),()=>{Do.unwatch(n),"function"==typeof t&&t(),t=void 0}}function Fo(e,t,n,o,r,i,a=Math.PI/3){const l=e.getBoundingClientRect(),s=l.width,c=l.height,d=(t-l.left)/s*2-1,g=-(n-l.top)/c*2+1,u=s/c,I=a,h=Math.tan(I/2),b=-d*(h*u),m=g*h,C=Math.sqrt(b*b+m*m+1),A=b/C,p=m/C,v=1/C,{yaw:y,pitch:f}=i,w=Math.cos(f),G=Math.sin(f),k=Math.cos(y),S=Math.sin(y),Z=-p*G+v*w,W=A*k+Z*S,L=p*w+v*G,R=-A*S+Z*k,B=Math.atan2(W,R),x=Math.asin(L);return{hit:ve(o,r,{yaw:B,pitch:x}),yaw:B,pitch:x}}async function Po(e){const t=J(e.document,"block-garden"),n=new Ae(e,e.document,t);return await n.createDialog(),n.show(),n}function jo(e,t){const{world:n}=t;E(e),t.seed=e,n.clear(),t.plantStructures={},t.growthTimers={},t.y=99,t.x=0,t.z=0,t.dy=0,t.onGround=!1}function Oo(e,t=null){let n;null!==t?(e=t,n=t):n=e,globalThis.blockGarden.gameTime=0,jo(n,globalThis.blockGarden.state)}class Uo{constructor(e,t){this.doc=e,this.shadow=t,this.dialog=null,this.close=this.close.bind(this),this.handleDialogClick=this.handleDialogClick.bind(this)}async createDialog(e){this.dialog&&this.dialog.remove();const t=`${e}-content`;let n=this.shadow.querySelector(`.${t}`);if(!n){n=this.doc.createElement("dialog"),n.setAttribute("class",t);const o=new DOMParser,r=await(await fetch("data:text/html;base64,PCFkb2N0eXBlIGh0bWw+CjxodG1sIGxhbmc9ImVuIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCI+CiAgPGhlYWQ+CiAgICA8dGl0bGU+QmxvY2sgR2FyZGVuIC0gQWJvdXQ8L3RpdGxlPgogICAgPGJhc2UgaHJlZj0iLyIgLz4KICAgIDxtZXRhIGNoYXJzZXQ9InV0Zi04IiAvPgogICAgPG1ldGEKICAgICAgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMCwgdXNlci1zY2FsYWJsZT1ubywgdmlld3BvcnQtZml0PWNvdmVyIgogICAgICBuYW1lPSJ2aWV3cG9ydCIKICAgIC8+CiAgICA8bWV0YQogICAgICBuYW1lPSJkZXNjcmlwdGlvbiIKICAgICAgY29udGVudD0iQWJvdXQgLSBCbG9jayBHYXJkZW4gLSBBIDNEIHNhbmRib3ggZXhwbG9yYXRpb24gYW5kIGZhcm1pbmcgZ2FtZS4gRXhwbG9yZSBwcm9jZWR1cmFsbHkgZ2VuZXJhdGVkIHdvcmxkcywgZGlnIGZvciByZXNvdXJjZXMsIGFuZCBjdWx0aXZhdGUgYSB2YXJpZXR5IG9mIHBsYW50cy4iCiAgICAvPgogICAgPG1ldGEgbmFtZT0idGhlbWUtY29sb3IiIGNvbnRlbnQ9IiMwMDAwMDAiIC8+CiAgICA8bGluayByZWw9Im1hbmlmZXN0IiBocmVmPSJtYW5pZmVzdC5qc29uIiAvPgogICAgPGxpbmsgcmVsPSJpY29uIiBocmVmPSJhc3NldHMvaWNvbnMvZmF2aWNvbi5pY28iIHR5cGU9ImltYWdlL3gtaWNvbiIgLz4KICAgIDxsaW5rIHJlbD0iYXBwbGUtdG91Y2gtaWNvbiIgaHJlZj0iYXNzZXRzL2ljb25zL2FwcGxlLXRvdWNoLWljb24ucG5nIiAvPgogICAgPHN0eWxlPgogICAgICBib2R5IHsKICAgICAgICBmb250LWZhbWlseTogQXJpYWwsIHNhbnMtc2VyaWY7CiAgICAgICAgbWFyZ2luOiAwOwogICAgICAgIHBhZGRpbmc6IDJyZW07CiAgICAgIH0KCiAgICAgIGxpIHsKICAgICAgICBtYXJnaW46IDAuMjVyZW0gMDsKICAgICAgfQogICAgPC9zdHlsZT4KICA8L2hlYWQ+CiAgPGJvZHkgY2xhc3M9ImFib3V0Ij4KICAgIDxkaXYgY2xhc3M9ImFib3V0LWNvbnRlbnQiPgogICAgICA8aGVhZGVyIGNsYXNzPSJhYm91dC1jb250ZW50X2hlYWRlciI+CiAgICAgICAgPGgxPgogICAgICAgICAgPGEKICAgICAgICAgICAgaHJlZj0iaHR0cHM6Ly9raGVycmljay5naXRodWIuaW8vYmxvY2stZ2FyZGVuLyIKICAgICAgICAgICAgcmVsPSJub29wZW5lciBub3JlZmVycmVyIgogICAgICAgICAgICB0YXJnZXQ9Il9ibGFuayIKICAgICAgICAgICAgPkJsb2NrIEdhcmRlbjwvYQogICAgICAgICAgPgogICAgICAgIDwvaDE+CiAgICAgICAgPGJ1dHRvbiBoaWRkZW49ImhpZGRlbiIgY2xhc3M9ImFib3V0LWNvbnRlbnRfY2xvc2UtYnRuIj4mdGltZXM7PC9idXR0b24+CiAgICAgIDwvaGVhZGVyPgoKICAgICAgPGgyPgogICAgICAgIDxhCiAgICAgICAgICBocmVmPSJodHRwczovL2toZXJyaWNrLmdpdGh1Yi5pby9ibG9jay1nYXJkZW4vYWJvdXQvIgogICAgICAgICAgcmVsPSJub29wZW5lciBub3JlZmVycmVyIgogICAgICAgICAgdGFyZ2V0PSJfYmxhbmsiCiAgICAgICAgICA+QWJvdXQ8L2EKICAgICAgICA+CiAgICAgIDwvaDI+CgogICAgICA8ZGl2PgogICAgICAgIDxwPgogICAgICAgICAgQmxvY2sgR2FyZGVuIGlzIGEgM0Qgc2FuZGJveCBleHBsb3JhdGlvbiBhbmQgYnVpbGRpbmcgZ2FtZS4gRXhwbG9yZQogICAgICAgICAgYW5kIGRpc2NvdmVyIHByb2NlZHVyYWxseSBnZW5lcmF0ZWQgd29ybGRzIGFuZCBkaWcgYW4gYXNzb3J0bWVudCBvZgogICAgICAgICAgYmxvY2ssIHdoaWxlIHBsYW50aW5nIGEgdmFyaWV0eSBvZiBzZWVkcy4KICAgICAgICA8L3A+CiAgICAgICAgPGEKICAgICAgICAgIGhyZWY9Imh0dHBzOi8va2hlcnJpY2suZ2l0aHViLmlvL2Jsb2NrLWdhcmRlbi8iCiAgICAgICAgICByZWw9Im5vb3BlbmVyIG5vcmVmZXJyZXIiCiAgICAgICAgICB0YXJnZXQ9Il9ibGFuayIKICAgICAgICA+CiAgICAgICAgICA8aW1nCiAgICAgICAgICAgIHNyYz0iaHR0cHM6Ly9raGVycmljay5naXRodWIuaW8vYmxvY2stZ2FyZGVuL2Fzc2V0cy9ibG9jay1nYXJkZW4tZmlyZXdvcmtzLmdpZiIKICAgICAgICAgICAgZGVzYz0iRmlyZXdvcmtzIGluIEJsb2NrIEdhcmRlbiIKICAgICAgICAgICAgdGl0bGU9IkJsb2NrIEdhcmRlbiAtIEZpcmV3b3JrcyIKICAgICAgICAgIC8+CiAgICAgICAgPC9hPgogICAgICAgIDxoMz5GZWF0dXJlczwvaDM+CiAgICAgICAgPHVsPgogICAgICAgICAgPGxpPgogICAgICAgICAgICA8c3Ryb25nPlByb2NlZHVyYWwgV29ybGQgR2VuZXJhdGlvbjwvc3Ryb25nPiAtIEVhY2ggd29ybGQgaXMgdW5pcXVlLAogICAgICAgICAgICBnZW5lcmF0ZWQgZnJvbSBhIHNoYXJlYWJsZSBzZWVkCiAgICAgICAgICA8L2xpPgogICAgICAgICAgPGxpPgogICAgICAgICAgICA8c3Ryb25nPlBsYW50aW5nIFN5c3RlbTwvc3Ryb25nPiAtIFBsYW50IGRpZmZlcmVudCBzZWVkIHR5cGVzIHdpdGgKICAgICAgICAgICAgcmVhbGlzdGljIGdyb3d0aCBjeWNsZXMKICAgICAgICAgIDwvbGk+CiAgICAgICAgICA8bGk+CiAgICAgICAgICAgIDxzdHJvbmc+UmVzb3VyY2UgTWluaW5nPC9zdHJvbmc+IC0gRGlnIGZvciByZXNvdXJjZXMgbGlrZSBzdG9uZSwKICAgICAgICAgICAgZGlydCwgYW5kIHNhbmQuCiAgICAgICAgICA8L2xpPgogICAgICAgICAgPGxpPgogICAgICAgICAgICA8c3Ryb25nPkJ1aWxkaW5nPC9zdHJvbmc+IC0gVXNlIGNvbGxlY3RlZCBtYXRlcmlhbHMgdG8gcGxhY2UgYmxvY2tzCiAgICAgICAgICAgIGFuZCBzaGFwZSB0aGUgd29ybGQKICAgICAgICAgIDwvbGk+CiAgICAgICAgICA8bGk+CiAgICAgICAgICAgIDxzdHJvbmc+Q2xvdWRzPC9zdHJvbmc+IC0gQ29udGludWUgYnVpbGRpbmcgYW5kIGZhcm1pbmcgd2hpbGUgaW4gdGhlCiAgICAgICAgICAgIHNreQogICAgICAgICAgPC9saT4KICAgICAgICAgIDxsaT4KICAgICAgICAgICAgPHN0cm9uZz5TYXZlICZhbXA7IExvYWQ8L3N0cm9uZz4gLSBZb3VyIHByb2dyZXNzIGNhbiBiZSBzYXZlZCBvbgogICAgICAgICAgICBkZXZpY2Ugb3IgYXMgYSBmaWxlIHRvIHNoYXJlCiAgICAgICAgICA8L2xpPgogICAgICAgIDwvdWw+CgogICAgICAgIDxoMz5Qcml2YWN5IGJ5IERlc2lnbjwvaDM+CiAgICAgICAgPHA+CiAgICAgICAgICBCbG9jayBHYXJkZW4gaXMgPHN0cm9uZz5wcml2YXRlIGJ5IGRlc2lnbjwvc3Ryb25nPi4gQWxsIGdhbWUgZGF0YSBpcwogICAgICAgICAgcHJvY2Vzc2VkIGFuZCBzdG9yZWQgbG9jYWxseSBvbiB5b3VyIGRldmljZS4gTm8gcGVyc29uYWwgaW5mb3JtYXRpb24KICAgICAgICAgIGlzIGNvbGxlY3RlZCwgdHJhbnNtaXR0ZWQsIG9yIHN0b3JlZCBvbiBleHRlcm5hbCBzZXJ2ZXJzLiBZb3VyIGdhbWUKICAgICAgICAgIHdvcmxkcywgcHJvZ3Jlc3MsIGFuZCBwcmVmZXJlbmNlcyBuZXZlciBsZWF2ZSB5b3VyIGRldmljZSwgdW5sZXNzCiAgICAgICAgICBzaGFyZWQgYnkgeW91LgogICAgICAgIDwvcD4KICAgICAgICA8cD4KICAgICAgICAgIFJlYWQgbW9yZSBhYm91dCB0aGUKICAgICAgICAgIDxhCiAgICAgICAgICAgIGhyZWY9Imh0dHBzOi8va2hlcnJpY2suZ2l0aHViLmlvL2Jsb2NrLWdhcmRlbi9wcml2YWN5LyIKICAgICAgICAgICAgcmVsPSJub29wZW5lciBub3JlZmVycmVyIgogICAgICAgICAgICB0YXJnZXQ9Il9ibGFuayIKICAgICAgICAgICAgPkJsb2NrIEdhcmRlbiBQcml2YWN5IFBvbGljeTwvYQogICAgICAgICAgPi4KICAgICAgICA8L3A+CiAgICAgICAgPGgzPkNvbnRyb2xzPC9oMz4KCiAgICAgICAgPHVsIGNsYXNzPSJhYm91dC1jb250cm9scyI+CiAgICAgICAgICA8bGk+CiAgICAgICAgICAgIDxzdHJvbmc+TW92ZW1lbnQ6PC9zdHJvbmc+IDxjb2RlPnc8L2NvZGU+IC8gPGNvZGU+YTwvY29kZT4gLwogICAgICAgICAgICA8Y29kZT5zPC9jb2RlPiAvIDxjb2RlPmQ8L2NvZGU+CiAgICAgICAgICA8L2xpPgogICAgICAgICAgPGxpPjxzdHJvbmc+SW52ZW50b3J5Ojwvc3Ryb25nPiA8Y29kZT5lPC9jb2RlPjwvbGk+CiAgICAgICAgICA8bGk+PHN0cm9uZz5DYW1lcmE6PC9zdHJvbmc+IDxjb2RlPkFycm93IEtleXM8L2NvZGU+PC9saT4KICAgICAgICAgIDxsaT4KICAgICAgICAgICAgPHN0cm9uZz5DaGFuZ2UgQmxvY2s6PC9zdHJvbmc+IDxjb2RlPn48L2NvZGU+IC8gPGNvZGU+YDwvY29kZT4KICAgICAgICAgIDwvbGk+CiAgICAgICAgICA8bGk+PHN0cm9uZz5KdW1wIC8gQXNjZW5kOjwvc3Ryb25nPiA8Y29kZT5TcGFjZTwvY29kZT48L2xpPgogICAgICAgICAgPGxpPjxzdHJvbmc+RGVzY2VuZDo8L3N0cm9uZz4gPGNvZGU+U2hpZnQ8L2NvZGU+PC9saT4KICAgICAgICAgIDxsaT48c3Ryb25nPlBsYWNlIC8gUmVtb3ZlIEJsb2NrOjwvc3Ryb25nPiA8Y29kZT5FbnRlcjwvY29kZT48L2xpPgogICAgICAgICAgPGxpPgogICAgICAgICAgICBDbGljayBHYW1lIENhbnZhcyBUbyBMb2NrIE1vdXNlCiAgICAgICAgICAgIDx1bCBkaXI9ImF1dG8iPgogICAgICAgICAgICAgIDxsaT48c3Ryb25nPlVzZSBjcm9zc2hhaXIgdG8gY2VudGVyIGJsb2NrIHBsYWNlbWVudDwvc3Ryb25nPjwvbGk+CiAgICAgICAgICAgICAgPGxpPjxzdHJvbmc+TGVmdCBDbGljazo8L3N0cm9uZz4gUGxhY2UgQmxvY2s8L2xpPgogICAgICAgICAgICAgIDxsaT48c3Ryb25nPlJpZ2h0IENsaWNrOjwvc3Ryb25nPiBSZW1vdmUgQmxvY2s8L2xpPgogICAgICAgICAgICA8L3VsPgogICAgICAgICAgPC9saT4KICAgICAgICA8L3VsPgogICAgICAgIDxhCiAgICAgICAgICBocmVmPSJodHRwczovL2toZXJyaWNrLmdpdGh1Yi5pby9ibG9jay1nYXJkZW4vIgogICAgICAgICAgcmVsPSJub29wZW5lciBub3JlZmVycmVyIgogICAgICAgICAgdGFyZ2V0PSJfYmxhbmsiCiAgICAgICAgPgogICAgICAgICAgPGltZwogICAgICAgICAgICBzcmM9Imh0dHBzOi8va2hlcnJpY2suZ2l0aHViLmlvL2Jsb2NrLWdhcmRlbi9hc3NldHMvYmxvY2stZ2FyZGVuLWFuaW1hdGlvbi5naWYiCiAgICAgICAgICAgIGRlc2M9IkFuIGFuaW1hdGlvbiBvZiBCbG9jayBHYXJkZW4gZ2FtZXBsYXkiCiAgICAgICAgICAgIHRpdGxlPSJCbG9jayBHYXJkZW4gLSBHYW1lcGxheSBBbmltYXRpb24iCiAgICAgICAgICAvPgogICAgICAgIDwvYT4KICAgICAgICA8aDM+VGlwcyBmb3IgTmV3IFBsYXllcnM8L2gzPgogICAgICAgIDx1bD4KICAgICAgICAgIDxsaT4KICAgICAgICAgICAgU3RhcnQgYnkgZXhwbG9yaW5nIHlvdXIgaW1tZWRpYXRlIHN1cnJvdW5kaW5ncyB0byB1bmRlcnN0YW5kIHRoZQogICAgICAgICAgICBsYXlvdXQgb2YgdGhlIGVudmlyb25tZW50LgogICAgICAgICAgPC9saT4KICAgICAgICAgIDxsaT5Mb29rIGZvciBhIHBsYWNlIHRvIHBsYW50IHNlZWRzIGJsb2NrcyBmcm9tIGludmVudG9yeS48L2xpPgogICAgICAgICAgPGxpPgogICAgICAgICAgICBEaWZmZXJlbnQgcGxhbnRzIGdyb3cgYXQgZGlmZmVyZW50IHJhdGVzIC0gbXVzaHJvb21zIGFyZSBmYXN0ZXN0LAogICAgICAgICAgICB0cmVlcyBhcmUgc2xvd2VzdAogICAgICAgICAgPC9saT4KICAgICAgICAgIDxsaT5QbGFjZSBhbmQgcmVtb3ZlIHZhcmlvdXMgYmxvY2sgdHlwZXMgdG8gc2hhcGUgeW91ciB3b3JsZC48L2xpPgogICAgICAgICAgPGxpPlNhdmUgeW91ciBnYW1lIGZyZXF1ZW50bHkgdXNpbmcgdGhlIFdvcmxkIFN0YXRlIG1lbnUgKEN0cmwrUyk8L2xpPgogICAgICAgICAgPGxpPlNoYXJlIGludGVyZXN0aW5nIHdvcmxkIHNlZWRzIHdpdGggZnJpZW5kcyE8L2xpPgogICAgICAgIDwvdWw+CiAgICAgICAgPGgzPk9wZW4gU291cmNlPC9oMz4KICAgICAgICA8cD4KICAgICAgICAgIEJsb2NrIEdhcmRlbiBpcyBvcGVuIHNvdXJjZSBzb2Z0d2FyZS4gVmlzaXQKICAgICAgICAgIDxhCiAgICAgICAgICAgIGhyZWY9Imh0dHBzOi8vZ2l0aHViLmNvbS9raGVycmljay9ibG9jay1nYXJkZW4iCiAgICAgICAgICAgIHJlbD0ibm9vcGVuZXIgbm9yZWZlcnJlciIKICAgICAgICAgICAgdGFyZ2V0PSJfYmxhbmsiCiAgICAgICAgICAgID50aGUgcHJvamVjdCByZXBvc2l0b3J5PC9hCiAgICAgICAgICA+CiAgICAgICAgICB0byB2aWV3IHRoZSBjb2RlLCByZXBvcnQgaXNzdWVzLCBvciB0byBjb250cmlidXRlLgogICAgICAgIDwvcD4KICAgICAgPC9kaXY+CiAgICA8L2Rpdj4KICA8L2JvZHk+CjwvaHRtbD4K")).text(),i=o.parseFromString(r,"text/html").querySelector(`.${t}`);n.innerHTML=i.innerHTML,this.shadow.append(n),this.shadow.querySelector(`.${e}-content_close-btn`).removeAttribute("hidden")}if(!(n instanceof HTMLDialogElement))throw new Error("Failed to create or find HTMLDialogElement");return this.dialog=n,this.initEventListeners(),this.dialog}handleDialogClick(e){e.target===this.dialog&&this.close()}initEventListeners(){this.dialog.querySelector(".about-content_close-btn").addEventListener("click",this.close),this.dialog.addEventListener("click",this.handleDialogClick)}removeEventListeners(){this.dialog.querySelector(".about-content_close-btn").removeEventListener("click",this.close),this.dialog.removeEventListener("click",this.handleDialogClick)}show(){this.dialog instanceof HTMLDialogElement&&this.dialog.showModal()}close(){this.removeEventListeners(),this.dialog instanceof HTMLDialogElement&&this.dialog.close()}}class Ho{constructor(e,t){this.doc=e,this.shadow=t,this.dialog=null,this.close=this.close.bind(this),this.handleDialogClick=this.handleDialogClick.bind(this)}async createDialog(e,t){this.dialog&&this.dialog.remove();const n=`${e}-content`;let o=this.shadow.querySelector(`.${n}`);if(!o){o=this.doc.createElement("dialog"),o.setAttribute("class",n);const t=new DOMParser,r=await(await fetch("data:text/html;base64,PCFkb2N0eXBlIGh0bWw+CjxodG1sIGxhbmc9ImVuIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCI+CiAgPGhlYWQ+CiAgICA8dGl0bGU+QmxvY2sgR2FyZGVuIC0gQVBJIC0gRXhhbXBsZXM8L3RpdGxlPgogICAgPGJhc2UgaHJlZj0iLyIgLz4KICAgIDxtZXRhIGNoYXJzZXQ9InV0Zi04IiAvPgogICAgPG1ldGEKICAgICAgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMCwgdXNlci1zY2FsYWJsZT1ubywgdmlld3BvcnQtZml0PWNvdmVyIgogICAgICBuYW1lPSJ2aWV3cG9ydCIKICAgIC8+CiAgICA8bWV0YQogICAgICBuYW1lPSJkZXNjcmlwdGlvbiIKICAgICAgY29udGVudD0iRXhhbXBsZXMgLSBCbG9jayBHYXJkZW4gLSBBIDJEIHNhbmRib3ggZXhwbG9yYXRpb24gYW5kIGZhcm1pbmcgZ2FtZS4gRXhwbG9yZSBwcm9jZWR1cmFsbHkgZ2VuZXJhdGVkIHdvcmxkcywgZGlzY292ZXIgZGlmZmVyZW50IGJpb21lcywgbWluZSByZXNvdXJjZXMsIGFuZCBjdWx0aXZhdGUgYSB2YXJpZXR5IG9mIGNyb3BzLiIKICAgIC8+CiAgICA8bWV0YSBuYW1lPSJ0aGVtZS1jb2xvciIgY29udGVudD0iIzAwMDAwMCIgLz4KICAgIDxsaW5rIHJlbD0ibWFuaWZlc3QiIGhyZWY9Im1hbmlmZXN0Lmpzb24iIC8+CiAgICA8bGluayByZWw9Imljb24iIGhyZWY9ImFzc2V0cy9pY29ucy9mYXZpY29uLmljbyIgdHlwZT0iaW1hZ2UveC1pY29uIiAvPgogICAgPGxpbmsgcmVsPSJhcHBsZS10b3VjaC1pY29uIiBocmVmPSJhc3NldHMvaWNvbnMvYXBwbGUtdG91Y2gtaWNvbi5wbmciIC8+CiAgICA8c3R5bGU+CiAgICAgIGJvZHkgewogICAgICAgIGZvbnQtZmFtaWx5OiBBcmlhbCwgc2Fucy1zZXJpZjsKICAgICAgICBtYXJnaW46IDA7CiAgICAgICAgcGFkZGluZzogMnJlbTsKICAgICAgfQoKICAgICAgbGkgewogICAgICAgIG1hcmdpbjogMC4yNXJlbSAwOwogICAgICB9CiAgICA8L3N0eWxlPgogIDwvaGVhZD4KCiAgPGJvZHkgY2xhc3M9ImV4YW1wbGVzIj4KICAgIDxkaXYgY2xhc3M9ImV4YW1wbGVzLWNvbnRlbnQiPgogICAgICA8aGVhZGVyIGNsYXNzPSJleGFtcGxlcy1jb250ZW50X2hlYWRlciI+CiAgICAgICAgPGgxPgogICAgICAgICAgPGEgaHJlZj0iaHR0cHM6Ly9raGVycmljay5naXRodWIuaW8vYmxvY2stZ2FyZGVuLyIgdGFyZ2V0PSJfYmxhbmsiCiAgICAgICAgICAgID5CbG9jayBHYXJkZW48L2EKICAgICAgICAgID4KICAgICAgICA8L2gxPgogICAgICAgIDxidXR0b24gaGlkZGVuPSJoaWRkZW4iIGNsYXNzPSJleGFtcGxlcy1jb250ZW50X2Nsb3NlLWJ0biI+CiAgICAgICAgICAmdGltZXM7CiAgICAgICAgPC9idXR0b24+CiAgICAgIDwvaGVhZGVyPgoKICAgICAgPGgyPgogICAgICAgIDxhCiAgICAgICAgICBocmVmPSJodHRwczovL2toZXJyaWNrLmdpdGh1Yi5pby9ibG9jay1nYXJkZW4vc3JjL2FwaS9leGFtcGxlcy8iCiAgICAgICAgICB0YXJnZXQ9Il9ibGFuayIKICAgICAgICAgID5BUEkgLSBFeGFtcGxlczwvYQogICAgICAgID4KICAgICAgPC9oMj4KCiAgICAgIDxoMyBpZD0iRmlyZXdvcmtzIj5GaXJld29ya3MgLSAzRCBwYXJ0aWNsZSBzeXN0ZW1zLjwvaDM+CiAgICAgIDx1bD4KICAgICAgICA8bGk+CiAgICAgICAgICA8cD4KICAgICAgICAgICAgPGEKICAgICAgICAgICAgICBocmVmPSJodHRwczovL2dpdGh1Yi5jb20va2hlcnJpY2svYmxvY2stZ2FyZGVuL3RyZWUvbWFpbi9zcmMvYXBpL2V4YW1wbGVzL0ZpcmV3b3Jrcy5tanMiCiAgICAgICAgICAgICAgdGFyZ2V0PSJfYmxhbmsiCiAgICAgICAgICAgICAgPlNvdXJjZTwvYQogICAgICAgICAgICA+OgogICAgICAgICAgICA8YQogICAgICAgICAgICAgIGhyZWY9Imh0dHBzOi8va2hlcnJpY2suZ2l0aHViLmlvL2Jsb2NrLWdhcmRlbi9zcmMvYXBpL2V4YW1wbGVzL0ZpcmV3b3Jrcy5tanMiCiAgICAgICAgICAgICAgdGFyZ2V0PSJfYmxhbmsiCiAgICAgICAgICAgICAgPkZpcmV3b3Jrcy5tanM8L2EKICAgICAgICAgICAgPgogICAgICAgICAgPC9wPgogICAgICAgIDwvbGk+CiAgICAgICAgPGxpPgogICAgICAgICAgPHA+CiAgICAgICAgICAgIDxhCiAgICAgICAgICAgICAgaHJlZj0iamF2YXNjcmlwdDp2YXIgZWw9KGZ1bmN0aW9uIGYoZSxuKXtyZXR1cm4hZT9udWxsOmUudGFnTmFtZT09PW4udG9VcHBlckNhc2UoKSYmZS5zaGFkb3dSb290P2U6Wy4uLihlLmNoaWxkcmVufHxbXSksLi4uKGUuc2hhZG93Um9vdD9bZS5zaGFkb3dSb290XTpbXSldLm1hcChjPT5mKGMsbikpLmZpbmQoQm9vbGVhbil8fG51bGx9KShnbG9iYWxUaGlzLmRvY3VtZW50LmJvZHksJTIyYmxvY2stZ2FyZGVuJTIyKT8uc2hhZG93Um9vdDtlbC5xdWVyeVNlbGVjdG9yKCUyMmRpYWxvZy5leGFtcGxlcy1jb250ZW50JTIyKT8uY2xvc2UoKTtpZighZWwuZ2V0RWxlbWVudEJ5SWQoJTIybWFwRWRpdG9yQ29udHJvbHMlMjIpPy5oYXNBdHRyaWJ1dGUoJTIyaGlkZGVuJTIyKSllbC5nZXRFbGVtZW50QnlJZCglMjJ0b2dnbGVNYXBFZGl0b3IlMjIpPy5jbGljaygpO2lmKCFlbC5xdWVyeVNlbGVjdG9yKCUyMiNzZXR0aW5ncyAudWktZ3JpZF9fY29ybmVyLS1jb250YWluZXIlMjIpPy5oYXNBdHRyaWJ1dGUoJTIyaGlkZGVuJTIyKSllbC5xdWVyeVNlbGVjdG9yKCUyMiNzZXR0aW5ncyAudWktZ3JpZF9fY29ybmVyLS1oZWFkaW5nJTIyKT8uY2xpY2soKTt2YXIgZTsoZT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCUyMnNjcmlwdCUyMikpLnNldEF0dHJpYnV0ZSglMjJ0eXBlJTIyLCUyMm1vZHVsZSUyMiksZS5pbm5lckhUTUw9JTIyKGF3YWl0IGltcG9ydCglMjdodHRwczovL2toZXJyaWNrLmdpdGh1Yi5pby9ibG9jay1nYXJkZW4vc3JjL2FwaS9leGFtcGxlcy9GaXJld29ya3MubWpzJTI3KSkuZGVtbygpJTIyLGRvY3VtZW50LmJvZHkuYXBwZW5kKGUpOyIKICAgICAgICAgICAgICByZWw9Im5vZm9sbG93IgogICAgICAgICAgICAgID5CbG9jayBHYXJkZW4gLSBGaXJld29ya3MgLSBCb29rbWFya2xldDwvYQogICAgICAgICAgICA+CiAgICAgICAgICA8L3A+CiAgICAgICAgICA8cCBjbGFzcz0iYm9va21hcmtsZXQiPgogICAgICAgICAgICA8YQogICAgICAgICAgICAgIHRpdGxlPSJCbG9jayBHYXJkZW4gLSBGaXJld29ya3MgLSBCb29rbWFya2xldCIKICAgICAgICAgICAgICBocmVmPSJqYXZhc2NyaXB0OnZhciBlbD0oZnVuY3Rpb24gZihlLG4pe3JldHVybiFlP251bGw6ZS50YWdOYW1lPT09bi50b1VwcGVyQ2FzZSgpJiZlLnNoYWRvd1Jvb3Q/ZTpbLi4uKGUuY2hpbGRyZW58fFtdKSwuLi4oZS5zaGFkb3dSb290P1tlLnNoYWRvd1Jvb3RdOltdKV0ubWFwKGM9PmYoYyxuKSkuZmluZChCb29sZWFuKXx8bnVsbH0pKGdsb2JhbFRoaXMuZG9jdW1lbnQuYm9keSwlMjJibG9jay1nYXJkZW4lMjIpPy5zaGFkb3dSb290O2VsLnF1ZXJ5U2VsZWN0b3IoJTIyZGlhbG9nLmV4YW1wbGVzLWNvbnRlbnQlMjIpPy5jbG9zZSgpO2lmKCFlbC5nZXRFbGVtZW50QnlJZCglMjJtYXBFZGl0b3JDb250cm9scyUyMik/Lmhhc0F0dHJpYnV0ZSglMjJoaWRkZW4lMjIpKWVsLmdldEVsZW1lbnRCeUlkKCUyMnRvZ2dsZU1hcEVkaXRvciUyMik/LmNsaWNrKCk7aWYoIWVsLnF1ZXJ5U2VsZWN0b3IoJTIyI3NldHRpbmdzIC51aS1ncmlkX19jb3JuZXItLWNvbnRhaW5lciUyMik/Lmhhc0F0dHJpYnV0ZSglMjJoaWRkZW4lMjIpKWVsLnF1ZXJ5U2VsZWN0b3IoJTIyI3NldHRpbmdzIC51aS1ncmlkX19jb3JuZXItLWhlYWRpbmclMjIpPy5jbGljaygpO3ZhciBlOyhlPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJTIyc2NyaXB0JTIyKSkuc2V0QXR0cmlidXRlKCUyMnR5cGUlMjIsJTIybW9kdWxlJTIyKSxlLmlubmVySFRNTD0lMjIoYXdhaXQgaW1wb3J0KCUyN2h0dHBzOi8va2hlcnJpY2suZ2l0aHViLmlvL2Jsb2NrLWdhcmRlbi9zcmMvYXBpL2V4YW1wbGVzL0ZpcmV3b3Jrcy5tanMlMjcpKS5kZW1vKCklMjIsZG9jdW1lbnQuYm9keS5hcHBlbmQoZSk7IgogICAgICAgICAgICAgIHJlbD0ibm9mb2xsb3ciCiAgICAgICAgICAgICAgPjxzdmcKICAgICAgICAgICAgICAgIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIKICAgICAgICAgICAgICAgIGhlaWdodD0iMjRweCIKICAgICAgICAgICAgICAgIHZpZXdCb3g9IjAgLTk2MCA5NjAgOTYwIgogICAgICAgICAgICAgICAgd2lkdGg9IjI0cHgiCiAgICAgICAgICAgICAgICBmaWxsPSIjYWFhIgogICAgICAgICAgICAgID4KICAgICAgICAgICAgICAgIDxwYXRoCiAgICAgICAgICAgICAgICAgIGQ9Ik0yMDAtMTIwdi02NDBxMC0zMyAyMy41LTU2LjVUMjgwLTg0MGg0MDBxMzMgMCA1Ni41IDIzLjVUNzYwLTc2MHY2NDBMNDgwLTI0MCAyMDAtMTIwWm04MC0xMjIgMjAwLTg2IDIwMCA4NnYtNTE4SDI4MHY1MThabTAtNTE4aDQwMC00MDBaIgogICAgICAgICAgICAgICAgLz48L3N2ZwogICAgICAgICAgICAgID48c3BhbiBoaWRkZW49ImhpZGRlbiIKICAgICAgICAgICAgICAgID5CbG9jayBHYXJkZW4gLSBGaXJld29ya3MgLSBCb29rbWFya2xldDwvc3BhbgogICAgICAgICAgICAgID48L2EKICAgICAgICAgICAgPgogICAgICAgICAgPC9wPgogICAgICAgIDwvbGk+CiAgICAgIDwvdWw+CgogICAgICA8aDMgaWQ9IkxpbmsiPkxpbmsgLSBVc2luZyBibG9ja3MgYXMgbGlua3MuPC9oMz4KICAgICAgPHVsPgogICAgICAgIDxsaT4KICAgICAgICAgIDxwPgogICAgICAgICAgICA8YQogICAgICAgICAgICAgIGhyZWY9Imh0dHBzOi8vZ2l0aHViLmNvbS9raGVycmljay9ibG9jay1nYXJkZW4vdHJlZS9tYWluL3NyYy9hcGkvZXhhbXBsZXMvTGluay5tanMiCiAgICAgICAgICAgICAgdGFyZ2V0PSJfYmxhbmsiCiAgICAgICAgICAgICAgPlNvdXJjZTwvYQogICAgICAgICAgICA+OgogICAgICAgICAgICA8YQogICAgICAgICAgICAgIGhyZWY9Imh0dHBzOi8va2hlcnJpY2suZ2l0aHViLmlvL2Jsb2NrLWdhcmRlbi9zcmMvYXBpL2V4YW1wbGVzL0xpbmsubWpzIgogICAgICAgICAgICAgIHRhcmdldD0iX2JsYW5rIgogICAgICAgICAgICAgID5MaW5rLm1qczwvYQogICAgICAgICAgICA+CiAgICAgICAgICA8L3A+CiAgICAgICAgPC9saT4KICAgICAgICA8bGk+CiAgICAgICAgICA8cD4KICAgICAgICAgICAgPGEKICAgICAgICAgICAgICBocmVmPSJqYXZhc2NyaXB0OnZhciBlbD0oZnVuY3Rpb24gZihlLG4pe3JldHVybiFlP251bGw6ZS50YWdOYW1lPT09bi50b1VwcGVyQ2FzZSgpJiZlLnNoYWRvd1Jvb3Q/ZTpbLi4uKGUuY2hpbGRyZW58fFtdKSwuLi4oZS5zaGFkb3dSb290P1tlLnNoYWRvd1Jvb3RdOltdKV0ubWFwKGM9PmYoYyxuKSkuZmluZChCb29sZWFuKXx8bnVsbH0pKGdsb2JhbFRoaXMuZG9jdW1lbnQuYm9keSwlMjJibG9jay1nYXJkZW4lMjIpPy5zaGFkb3dSb290O2VsLnF1ZXJ5U2VsZWN0b3IoJTIyZGlhbG9nLmV4YW1wbGVzLWNvbnRlbnQlMjIpPy5jbG9zZSgpO2lmKCFlbC5nZXRFbGVtZW50QnlJZCglMjJtYXBFZGl0b3JDb250cm9scyUyMik/Lmhhc0F0dHJpYnV0ZSglMjJoaWRkZW4lMjIpKWVsLmdldEVsZW1lbnRCeUlkKCUyMnRvZ2dsZU1hcEVkaXRvciUyMik/LmNsaWNrKCk7aWYoIWVsLnF1ZXJ5U2VsZWN0b3IoJTIyI3NldHRpbmdzIC51aS1ncmlkX19jb3JuZXItLWNvbnRhaW5lciUyMik/Lmhhc0F0dHJpYnV0ZSglMjJoaWRkZW4lMjIpKWVsLnF1ZXJ5U2VsZWN0b3IoJTIyI3NldHRpbmdzIC51aS1ncmlkX19jb3JuZXItLWhlYWRpbmclMjIpPy5jbGljaygpO3ZhciBlOyhlPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJTIyc2NyaXB0JTIyKSkuc2V0QXR0cmlidXRlKCUyMnR5cGUlMjIsJTIybW9kdWxlJTIyKSxlLmlubmVySFRNTD0lMjIoYXdhaXQgaW1wb3J0KCUyN2h0dHBzOi8va2hlcnJpY2suZ2l0aHViLmlvL2Jsb2NrLWdhcmRlbi9zcmMvYXBpL2V4YW1wbGVzL0xpbmsubWpzJTI3KSkuZGVtbygpJTIyLGRvY3VtZW50LmJvZHkuYXBwZW5kKGUpOyIKICAgICAgICAgICAgICByZWw9Im5vZm9sbG93IgogICAgICAgICAgICAgID5CbG9jayBHYXJkZW4gLSBMaW5rIC0gQm9va21hcmtsZXQ8L2EKICAgICAgICAgICAgPgogICAgICAgICAgPC9wPgogICAgICAgICAgPHAgY2xhc3M9ImJvb2ttYXJrbGV0Ij4KICAgICAgICAgICAgPGEKICAgICAgICAgICAgICB0aXRsZT0iQmxvY2sgR2FyZGVuIC0gTGluayAtIEJvb2ttYXJrbGV0IgogICAgICAgICAgICAgIGhyZWY9ImphdmFzY3JpcHQ6dmFyIGVsPShmdW5jdGlvbiBmKGUsbil7cmV0dXJuIWU/bnVsbDplLnRhZ05hbWU9PT1uLnRvVXBwZXJDYXNlKCkmJmUuc2hhZG93Um9vdD9lOlsuLi4oZS5jaGlsZHJlbnx8W10pLC4uLihlLnNoYWRvd1Jvb3Q/W2Uuc2hhZG93Um9vdF06W10pXS5tYXAoYz0+ZihjLG4pKS5maW5kKEJvb2xlYW4pfHxudWxsfSkoZ2xvYmFsVGhpcy5kb2N1bWVudC5ib2R5LCUyMmJsb2NrLWdhcmRlbiUyMik/LnNoYWRvd1Jvb3Q7ZWwucXVlcnlTZWxlY3RvciglMjJkaWFsb2cuZXhhbXBsZXMtY29udGVudCUyMik/LmNsb3NlKCk7aWYoIWVsLmdldEVsZW1lbnRCeUlkKCUyMm1hcEVkaXRvckNvbnRyb2xzJTIyKT8uaGFzQXR0cmlidXRlKCUyMmhpZGRlbiUyMikpZWwuZ2V0RWxlbWVudEJ5SWQoJTIydG9nZ2xlTWFwRWRpdG9yJTIyKT8uY2xpY2soKTtpZighZWwucXVlcnlTZWxlY3RvciglMjIjc2V0dGluZ3MgLnVpLWdyaWRfX2Nvcm5lci0tY29udGFpbmVyJTIyKT8uaGFzQXR0cmlidXRlKCUyMmhpZGRlbiUyMikpZWwucXVlcnlTZWxlY3RvciglMjIjc2V0dGluZ3MgLnVpLWdyaWRfX2Nvcm5lci0taGVhZGluZyUyMik/LmNsaWNrKCk7dmFyIGU7KGU9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCglMjJzY3JpcHQlMjIpKS5zZXRBdHRyaWJ1dGUoJTIydHlwZSUyMiwlMjJtb2R1bGUlMjIpLGUuaW5uZXJIVE1MPSUyMihhd2FpdCBpbXBvcnQoJTI3aHR0cHM6Ly9raGVycmljay5naXRodWIuaW8vYmxvY2stZ2FyZGVuL3NyYy9hcGkvZXhhbXBsZXMvTGluay5tanMlMjcpKS5kZW1vKCklMjIsZG9jdW1lbnQuYm9keS5hcHBlbmQoZSk7IgogICAgICAgICAgICAgIHJlbD0ibm9mb2xsb3ciCiAgICAgICAgICAgICAgPjxzdmcKICAgICAgICAgICAgICAgIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIKICAgICAgICAgICAgICAgIGhlaWdodD0iMjRweCIKICAgICAgICAgICAgICAgIHZpZXdCb3g9IjAgLTk2MCA5NjAgOTYwIgogICAgICAgICAgICAgICAgd2lkdGg9IjI0cHgiCiAgICAgICAgICAgICAgICBmaWxsPSIjYWFhIgogICAgICAgICAgICAgID4KICAgICAgICAgICAgICAgIDxwYXRoCiAgICAgICAgICAgICAgICAgIGQ9Ik0yMDAtMTIwdi02NDBxMC0zMyAyMy41LTU2LjVUMjgwLTg0MGg0MDBxMzMgMCA1Ni41IDIzLjVUNzYwLTc2MHY2NDBMNDgwLTI0MCAyMDAtMTIwWm04MC0xMjIgMjAwLTg2IDIwMCA4NnYtNTE4SDI4MHY1MThabTAtNTE4aDQwMC00MDBaIgogICAgICAgICAgICAgICAgLz48L3N2ZwogICAgICAgICAgICAgID48c3BhbiBoaWRkZW49ImhpZGRlbiI+QmxvY2sgR2FyZGVuIC0gTGluayAtIEJvb2ttYXJrbGV0PC9zcGFuPjwvYQogICAgICAgICAgICA+CiAgICAgICAgICA8L3A+CiAgICAgICAgPC9saT4KICAgICAgPC91bD4KCiAgICAgIDxoMyBpZD0iR09MIj5HT0wgLSBDb253YXkncyBHYW1lIG9mIExpZmUgdXNpbmcgYmxvY2sgZW50aXRpZXMuPC9oMz4KICAgICAgPHVsPgogICAgICAgIDxsaT4KICAgICAgICAgIDxwPgogICAgICAgICAgICA8YQogICAgICAgICAgICAgIGhyZWY9Imh0dHBzOi8vZ2l0aHViLmNvbS9raGVycmljay9ibG9jay1nYXJkZW4vdHJlZS9tYWluL3NyYy9hcGkvZXhhbXBsZXMvR09MLm1qcyIKICAgICAgICAgICAgICB0YXJnZXQ9Il9ibGFuayIKICAgICAgICAgICAgICA+U291cmNlPC9hCiAgICAgICAgICAgID46CiAgICAgICAgICAgIDxhCiAgICAgICAgICAgICAgaHJlZj0iaHR0cHM6Ly9raGVycmljay5naXRodWIuaW8vYmxvY2stZ2FyZGVuL3NyYy9hcGkvZXhhbXBsZXMvR09MLm1qcyIKICAgICAgICAgICAgICB0YXJnZXQ9Il9ibGFuayIKICAgICAgICAgICAgICA+R09MLm1qczwvYQogICAgICAgICAgICA+CiAgICAgICAgICA8L3A+CiAgICAgICAgPC9saT4KICAgICAgICA8bGk+CiAgICAgICAgICA8cD4KICAgICAgICAgICAgPGEKICAgICAgICAgICAgICBocmVmPSJqYXZhc2NyaXB0OnZhciBlbD0oZnVuY3Rpb24gZihlLG4pe3JldHVybiFlP251bGw6ZS50YWdOYW1lPT09bi50b1VwcGVyQ2FzZSgpJiZlLnNoYWRvd1Jvb3Q/ZTpbLi4uKGUuY2hpbGRyZW58fFtdKSwuLi4oZS5zaGFkb3dSb290P1tlLnNoYWRvd1Jvb3RdOltdKV0ubWFwKGM9PmYoYyxuKSkuZmluZChCb29sZWFuKXx8bnVsbH0pKGdsb2JhbFRoaXMuZG9jdW1lbnQuYm9keSwlMjJibG9jay1nYXJkZW4lMjIpPy5zaGFkb3dSb290O2VsLnF1ZXJ5U2VsZWN0b3IoJTIyZGlhbG9nLmV4YW1wbGVzLWNvbnRlbnQlMjIpPy5jbG9zZSgpO2lmKCFlbC5nZXRFbGVtZW50QnlJZCglMjJtYXBFZGl0b3JDb250cm9scyUyMik/Lmhhc0F0dHJpYnV0ZSglMjJoaWRkZW4lMjIpKWVsLmdldEVsZW1lbnRCeUlkKCUyMnRvZ2dsZU1hcEVkaXRvciUyMik/LmNsaWNrKCk7aWYoIWVsLnF1ZXJ5U2VsZWN0b3IoJTIyI3NldHRpbmdzIC51aS1ncmlkX19jb3JuZXItLWNvbnRhaW5lciUyMik/Lmhhc0F0dHJpYnV0ZSglMjJoaWRkZW4lMjIpKWVsLnF1ZXJ5U2VsZWN0b3IoJTIyI3NldHRpbmdzIC51aS1ncmlkX19jb3JuZXItLWhlYWRpbmclMjIpPy5jbGljaygpO3ZhciBlOyhlPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJTIyc2NyaXB0JTIyKSkuc2V0QXR0cmlidXRlKCUyMnR5cGUlMjIsJTIybW9kdWxlJTIyKSxlLmlubmVySFRNTD0lMjIoYXdhaXQgaW1wb3J0KCUyN2h0dHBzOi8va2hlcnJpY2suZ2l0aHViLmlvL2Jsb2NrLWdhcmRlbi9zcmMvYXBpL2V4YW1wbGVzL0dPTC5tanMlMjcpKS5kZW1vKCklMjIsZG9jdW1lbnQuYm9keS5hcHBlbmQoZSk7IgogICAgICAgICAgICAgIHJlbD0ibm9mb2xsb3ciCiAgICAgICAgICAgICAgPkJsb2NrIEdhcmRlbiAtIEdPTCAtIEJvb2ttYXJrbGV0PC9hCiAgICAgICAgICAgID4KICAgICAgICAgIDwvcD4KICAgICAgICAgIDxwIGNsYXNzPSJib29rbWFya2xldCI+CiAgICAgICAgICAgIDxhCiAgICAgICAgICAgICAgdGl0bGU9IkJsb2NrIEdhcmRlbiAtIEdPTCAtIEJvb2ttYXJrbGV0IgogICAgICAgICAgICAgIGhyZWY9ImphdmFzY3JpcHQ6dmFyIGVsPShmdW5jdGlvbiBmKGUsbil7cmV0dXJuIWU/bnVsbDplLnRhZ05hbWU9PT1uLnRvVXBwZXJDYXNlKCkmJmUuc2hhZG93Um9vdD9lOlsuLi4oZS5jaGlsZHJlbnx8W10pLC4uLihlLnNoYWRvd1Jvb3Q/W2Uuc2hhZG93Um9vdF06W10pXS5tYXAoYz0+ZihjLG4pKS5maW5kKEJvb2xlYW4pfHxudWxsfSkoZ2xvYmFsVGhpcy5kb2N1bWVudC5ib2R5LCUyMmJsb2NrLWdhcmRlbiUyMik/LnNoYWRvd1Jvb3Q7ZWwucXVlcnlTZWxlY3RvciglMjJkaWFsb2cuZXhhbXBsZXMtY29udGVudCUyMik/LmNsb3NlKCk7aWYoIWVsLmdldEVsZW1lbnRCeUlkKCUyMm1hcEVkaXRvckNvbnRyb2xzJTIyKT8uaGFzQXR0cmlidXRlKCUyMmhpZGRlbiUyMikpZWwuZ2V0RWxlbWVudEJ5SWQoJTIydG9nZ2xlTWFwRWRpdG9yJTIyKT8uY2xpY2soKTtpZighZWwucXVlcnlTZWxlY3RvciglMjIjc2V0dGluZ3MgLnVpLWdyaWRfX2Nvcm5lci0tY29udGFpbmVyJTIyKT8uaGFzQXR0cmlidXRlKCUyMmhpZGRlbiUyMikpZWwucXVlcnlTZWxlY3RvciglMjIjc2V0dGluZ3MgLnVpLWdyaWRfX2Nvcm5lci0taGVhZGluZyUyMik/LmNsaWNrKCk7dmFyIGU7KGU9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCglMjJzY3JpcHQlMjIpKS5zZXRBdHRyaWJ1dGUoJTIydHlwZSUyMiwlMjJtb2R1bGUlMjIpLGUuaW5uZXJIVE1MPSUyMihhd2FpdCBpbXBvcnQoJTI3aHR0cHM6Ly9raGVycmljay5naXRodWIuaW8vYmxvY2stZ2FyZGVuL3NyYy9hcGkvZXhhbXBsZXMvR09MLm1qcyUyNykpLmRlbW8oKSUyMixkb2N1bWVudC5ib2R5LmFwcGVuZChlKTsiCiAgICAgICAgICAgICAgcmVsPSJub2ZvbGxvdyIKICAgICAgICAgICAgICA+PHN2ZwogICAgICAgICAgICAgICAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICAgICAgICAgICAgICAgaGVpZ2h0PSIyNHB4IgogICAgICAgICAgICAgICAgdmlld0JveD0iMCAtOTYwIDk2MCA5NjAiCiAgICAgICAgICAgICAgICB3aWR0aD0iMjRweCIKICAgICAgICAgICAgICAgIGZpbGw9IiNhYWEiCiAgICAgICAgICAgICAgPgogICAgICAgICAgICAgICAgPHBhdGgKICAgICAgICAgICAgICAgICAgZD0iTTIwMC0xMjB2LTY0MHEwLTMzIDIzLjUtNTYuNVQyODAtODQwaDQwMHEzMyAwIDU2LjUgMjMuNVQ3NjAtNzYwdjY0MEw0ODAtMjQwIDIwMC0xMjBabTgwLTEyMiAyMDAtODYgMjAwIDg2di01MThIMjgwdjUxOFptMC01MThoNDAwLTQwMFoiCiAgICAgICAgICAgICAgICAvPjwvc3ZnCiAgICAgICAgICAgICAgPjxzcGFuIGhpZGRlbj0iaGlkZGVuIj5CbG9jayBHYXJkZW4gLSBHT0wgLSBCb29rbWFya2xldDwvc3Bhbj48L2EKICAgICAgICAgICAgPgogICAgICAgICAgPC9wPgogICAgICAgIDwvbGk+CiAgICAgIDwvdWw+CgogICAgICA8aDMgaWQ9IlBob3RvIj4KICAgICAgICBQaG90byAtIERyYXdzIGludGVycHJldGVkIGJpdG1hcCBiYXNlZCBvbiBCbG9jayBHYXJkZW4gYmxvY2tzLgogICAgICA8L2gzPgogICAgICA8dWw+CiAgICAgICAgPGxpPgogICAgICAgICAgPHA+CiAgICAgICAgICAgIDxhCiAgICAgICAgICAgICAgaHJlZj0iaHR0cHM6Ly9naXRodWIuY29tL2toZXJyaWNrL2Jsb2NrLWdhcmRlbi90cmVlL21haW4vc3JjL2FwaS9leGFtcGxlcy9QaG90by5tanMiCiAgICAgICAgICAgICAgdGFyZ2V0PSJfYmxhbmsiCiAgICAgICAgICAgICAgPlNvdXJjZTwvYQogICAgICAgICAgICA+OgogICAgICAgICAgICA8YQogICAgICAgICAgICAgIGhyZWY9Imh0dHBzOi8va2hlcnJpY2suZ2l0aHViLmlvL2Jsb2NrLWdhcmRlbi9zcmMvYXBpL2V4YW1wbGVzL1Bob3RvLm1qcyIKICAgICAgICAgICAgICB0YXJnZXQ9Il9ibGFuayIKICAgICAgICAgICAgICA+UGhvdG8ubWpzPC9hCiAgICAgICAgICAgID4KICAgICAgICAgIDwvcD4KICAgICAgICA8L2xpPgogICAgICAgIDxsaT4KICAgICAgICAgIDxwPgogICAgICAgICAgICA8YQogICAgICAgICAgICAgIGhyZWY9ImphdmFzY3JpcHQ6dmFyIGVsPShmdW5jdGlvbiBmKGUsbil7cmV0dXJuIWU/bnVsbDplLnRhZ05hbWU9PT1uLnRvVXBwZXJDYXNlKCkmJmUuc2hhZG93Um9vdD9lOlsuLi4oZS5jaGlsZHJlbnx8W10pLC4uLihlLnNoYWRvd1Jvb3Q/W2Uuc2hhZG93Um9vdF06W10pXS5tYXAoYz0+ZihjLG4pKS5maW5kKEJvb2xlYW4pfHxudWxsfSkoZ2xvYmFsVGhpcy5kb2N1bWVudC5ib2R5LCUyMmJsb2NrLWdhcmRlbiUyMik/LnNoYWRvd1Jvb3Q7ZWwucXVlcnlTZWxlY3RvciglMjJkaWFsb2cuZXhhbXBsZXMtY29udGVudCUyMik/LmNsb3NlKCk7aWYoIWVsLmdldEVsZW1lbnRCeUlkKCUyMm1hcEVkaXRvckNvbnRyb2xzJTIyKT8uaGFzQXR0cmlidXRlKCUyMmhpZGRlbiUyMikpZWwuZ2V0RWxlbWVudEJ5SWQoJTIydG9nZ2xlTWFwRWRpdG9yJTIyKT8uY2xpY2soKTtpZighZWwucXVlcnlTZWxlY3RvciglMjIjc2V0dGluZ3MgLnVpLWdyaWRfX2Nvcm5lci0tY29udGFpbmVyJTIyKT8uaGFzQXR0cmlidXRlKCUyMmhpZGRlbiUyMikpZWwucXVlcnlTZWxlY3RvciglMjIjc2V0dGluZ3MgLnVpLWdyaWRfX2Nvcm5lci0taGVhZGluZyUyMik/LmNsaWNrKCk7dmFyIGU7KGU9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCglMjJzY3JpcHQlMjIpKS5zZXRBdHRyaWJ1dGUoJTIydHlwZSUyMiwlMjJtb2R1bGUlMjIpLGUuaW5uZXJIVE1MPSUyMihhd2FpdCBpbXBvcnQoJTI3aHR0cHM6Ly9raGVycmljay5naXRodWIuaW8vYmxvY2stZ2FyZGVuL3NyYy9hcGkvZXhhbXBsZXMvUGhvdG8ubWpzJTI3KSkuZGVtbygpJTIyLGRvY3VtZW50LmJvZHkuYXBwZW5kKGUpOyIKICAgICAgICAgICAgICByZWw9Im5vZm9sbG93IgogICAgICAgICAgICAgID5CbG9jayBHYXJkZW4gLSBQaG90byAtIEJvb2ttYXJrbGV0PC9hCiAgICAgICAgICAgID4KICAgICAgICAgIDwvcD4KICAgICAgICAgIDxwIGNsYXNzPSJib29rbWFya2xldCI+CiAgICAgICAgICAgIDxhCiAgICAgICAgICAgICAgdGl0bGU9IkJsb2NrIEdhcmRlbiAtIFBob3RvIC0gQm9va21hcmtsZXQiCiAgICAgICAgICAgICAgaHJlZj0iamF2YXNjcmlwdDp2YXIgZWw9KGZ1bmN0aW9uIGYoZSxuKXtyZXR1cm4hZT9udWxsOmUudGFnTmFtZT09PW4udG9VcHBlckNhc2UoKSYmZS5zaGFkb3dSb290P2U6Wy4uLihlLmNoaWxkcmVufHxbXSksLi4uKGUuc2hhZG93Um9vdD9bZS5zaGFkb3dSb290XTpbXSldLm1hcChjPT5mKGMsbikpLmZpbmQoQm9vbGVhbil8fG51bGx9KShnbG9iYWxUaGlzLmRvY3VtZW50LmJvZHksJTIyYmxvY2stZ2FyZGVuJTIyKT8uc2hhZG93Um9vdDtlbC5xdWVyeVNlbGVjdG9yKCUyMmRpYWxvZy5leGFtcGxlcy1jb250ZW50JTIyKT8uY2xvc2UoKTtpZighZWwuZ2V0RWxlbWVudEJ5SWQoJTIybWFwRWRpdG9yQ29udHJvbHMlMjIpPy5oYXNBdHRyaWJ1dGUoJTIyaGlkZGVuJTIyKSllbC5nZXRFbGVtZW50QnlJZCglMjJ0b2dnbGVNYXBFZGl0b3IlMjIpPy5jbGljaygpO2lmKCFlbC5xdWVyeVNlbGVjdG9yKCUyMiNzZXR0aW5ncyAudWktZ3JpZF9fY29ybmVyLS1jb250YWluZXIlMjIpPy5oYXNBdHRyaWJ1dGUoJTIyaGlkZGVuJTIyKSllbC5xdWVyeVNlbGVjdG9yKCUyMiNzZXR0aW5ncyAudWktZ3JpZF9fY29ybmVyLS1oZWFkaW5nJTIyKT8uY2xpY2soKTt2YXIgZTsoZT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCUyMnNjcmlwdCUyMikpLnNldEF0dHJpYnV0ZSglMjJ0eXBlJTIyLCUyMm1vZHVsZSUyMiksZS5pbm5lckhUTUw9JTIyKGF3YWl0IGltcG9ydCglMjdodHRwczovL2toZXJyaWNrLmdpdGh1Yi5pby9ibG9jay1nYXJkZW4vc3JjL2FwaS9leGFtcGxlcy9QaG90by5tanMlMjcpKS5kZW1vKCklMjIsZG9jdW1lbnQuYm9keS5hcHBlbmQoZSk7IgogICAgICAgICAgICAgIHJlbD0ibm9mb2xsb3ciCiAgICAgICAgICAgICAgPjxzdmcKICAgICAgICAgICAgICAgIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIKICAgICAgICAgICAgICAgIGhlaWdodD0iMjRweCIKICAgICAgICAgICAgICAgIHZpZXdCb3g9IjAgLTk2MCA5NjAgOTYwIgogICAgICAgICAgICAgICAgd2lkdGg9IjI0cHgiCiAgICAgICAgICAgICAgICBmaWxsPSIjYWFhIgogICAgICAgICAgICAgID4KICAgICAgICAgICAgICAgIDxwYXRoCiAgICAgICAgICAgICAgICAgIGQ9Ik0yMDAtMTIwdi02NDBxMC0zMyAyMy41LTU2LjVUMjgwLTg0MGg0MDBxMzMgMCA1Ni41IDIzLjVUNzYwLTc2MHY2NDBMNDgwLTI0MCAyMDAtMTIwWm04MC0xMjIgMjAwLTg2IDIwMCA4NnYtNTE4SDI4MHY1MThabTAtNTE4aDQwMC00MDBaIgogICAgICAgICAgICAgICAgLz48L3N2ZwogICAgICAgICAgICAgID48c3BhbiBoaWRkZW49ImhpZGRlbiIKICAgICAgICAgICAgICAgID5CbG9jayBHYXJkZW4gLSBQaG90byAtIEJvb2ttYXJrbGV0PC9zcGFuCiAgICAgICAgICAgICAgPjwvYQogICAgICAgICAgICA+CiAgICAgICAgICA8L3A+CiAgICAgICAgPC9saT4KICAgICAgPC91bD4KCiAgICAgIDxoMyBpZD0iVmlkZW8iPgogICAgICAgIFZpZGVvIC0gRHJhd3MgaW50ZXJwcmV0ZWQgdmlkZW8gYmFzZWQgb24gQmxvY2sgR2FyZGVuIGJsb2Nrcy4KICAgICAgPC9oMz4KICAgICAgPHVsPgogICAgICAgIDxsaT4KICAgICAgICAgIDxwPgogICAgICAgICAgICA8YQogICAgICAgICAgICAgIGhyZWY9Imh0dHBzOi8vZ2l0aHViLmNvbS9raGVycmljay9ibG9jay1nYXJkZW4vdHJlZS9tYWluL3NyYy9hcGkvZXhhbXBsZXMvVmlkZW8ubWpzIgogICAgICAgICAgICAgIHRhcmdldD0iX2JsYW5rIgogICAgICAgICAgICAgID5Tb3VyY2U8L2EKICAgICAgICAgICAgPjoKICAgICAgICAgICAgPGEKICAgICAgICAgICAgICBocmVmPSJodHRwczovL2toZXJyaWNrLmdpdGh1Yi5pby9ibG9jay1nYXJkZW4vc3JjL2FwaS9leGFtcGxlcy9WaWRlby5tanMiCiAgICAgICAgICAgICAgdGFyZ2V0PSJfYmxhbmsiCiAgICAgICAgICAgICAgPlZpZGVvLm1qczwvYQogICAgICAgICAgICA+CiAgICAgICAgICA8L3A+CiAgICAgICAgPC9saT4KICAgICAgICA8bGk+CiAgICAgICAgICA8cD4KICAgICAgICAgICAgPGEKICAgICAgICAgICAgICBocmVmPSJqYXZhc2NyaXB0OnZhciBlbD0oZnVuY3Rpb24gZihlLG4pe3JldHVybiFlP251bGw6ZS50YWdOYW1lPT09bi50b1VwcGVyQ2FzZSgpJiZlLnNoYWRvd1Jvb3Q/ZTpbLi4uKGUuY2hpbGRyZW58fFtdKSwuLi4oZS5zaGFkb3dSb290P1tlLnNoYWRvd1Jvb3RdOltdKV0ubWFwKGM9PmYoYyxuKSkuZmluZChCb29sZWFuKXx8bnVsbH0pKGdsb2JhbFRoaXMuZG9jdW1lbnQuYm9keSwlMjJibG9jay1nYXJkZW4lMjIpPy5zaGFkb3dSb290O2VsLnF1ZXJ5U2VsZWN0b3IoJTIyZGlhbG9nLmV4YW1wbGVzLWNvbnRlbnQlMjIpPy5jbG9zZSgpO2lmKCFlbC5nZXRFbGVtZW50QnlJZCglMjJtYXBFZGl0b3JDb250cm9scyUyMik/Lmhhc0F0dHJpYnV0ZSglMjJoaWRkZW4lMjIpKWVsLmdldEVsZW1lbnRCeUlkKCUyMnRvZ2dsZU1hcEVkaXRvciUyMik/LmNsaWNrKCk7aWYoIWVsLnF1ZXJ5U2VsZWN0b3IoJTIyI3NldHRpbmdzIC51aS1ncmlkX19jb3JuZXItLWNvbnRhaW5lciUyMik/Lmhhc0F0dHJpYnV0ZSglMjJoaWRkZW4lMjIpKWVsLnF1ZXJ5U2VsZWN0b3IoJTIyI3NldHRpbmdzIC51aS1ncmlkX19jb3JuZXItLWhlYWRpbmclMjIpPy5jbGljaygpO3ZhciBlOyhlPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJTIyc2NyaXB0JTIyKSkuc2V0QXR0cmlidXRlKCUyMnR5cGUlMjIsJTIybW9kdWxlJTIyKSxlLmlubmVySFRNTD0lMjIoYXdhaXQgaW1wb3J0KCUyN2h0dHBzOi8va2hlcnJpY2suZ2l0aHViLmlvL2Jsb2NrLWdhcmRlbi9zcmMvYXBpL2V4YW1wbGVzL1ZpZGVvLm1qcyUyNykpLmRlbW8oKSUyMixkb2N1bWVudC5ib2R5LmFwcGVuZChlKTsiCiAgICAgICAgICAgICAgcmVsPSJub2ZvbGxvdyIKICAgICAgICAgICAgICA+QmxvY2sgR2FyZGVuIC0gVmlkZW8gLSBCb29rbWFya2xldDwvYQogICAgICAgICAgICA+CiAgICAgICAgICA8L3A+CiAgICAgICAgICA8cCBjbGFzcz0iYm9va21hcmtsZXQiPgogICAgICAgICAgICA8YQogICAgICAgICAgICAgIHRpdGxlPSJCbG9jayBHYXJkZW4gLSBWaWRlbyAtIEJvb2ttYXJrbGV0IgogICAgICAgICAgICAgIGhyZWY9ImphdmFzY3JpcHQ6dmFyIGVsPShmdW5jdGlvbiBmKGUsbil7cmV0dXJuIWU/bnVsbDplLnRhZ05hbWU9PT1uLnRvVXBwZXJDYXNlKCkmJmUuc2hhZG93Um9vdD9lOlsuLi4oZS5jaGlsZHJlbnx8W10pLC4uLihlLnNoYWRvd1Jvb3Q/W2Uuc2hhZG93Um9vdF06W10pXS5tYXAoYz0+ZihjLG4pKS5maW5kKEJvb2xlYW4pfHxudWxsfSkoZ2xvYmFsVGhpcy5kb2N1bWVudC5ib2R5LCUyMmJsb2NrLWdhcmRlbiUyMik/LnNoYWRvd1Jvb3Q7ZWwucXVlcnlTZWxlY3RvciglMjJkaWFsb2cuZXhhbXBsZXMtY29udGVudCUyMik/LmNsb3NlKCk7aWYoIWVsLmdldEVsZW1lbnRCeUlkKCUyMm1hcEVkaXRvckNvbnRyb2xzJTIyKT8uaGFzQXR0cmlidXRlKCUyMmhpZGRlbiUyMikpZWwuZ2V0RWxlbWVudEJ5SWQoJTIydG9nZ2xlTWFwRWRpdG9yJTIyKT8uY2xpY2soKTtpZighZWwucXVlcnlTZWxlY3RvciglMjIjc2V0dGluZ3MgLnVpLWdyaWRfX2Nvcm5lci0tY29udGFpbmVyJTIyKT8uaGFzQXR0cmlidXRlKCUyMmhpZGRlbiUyMikpZWwucXVlcnlTZWxlY3RvciglMjIjc2V0dGluZ3MgLnVpLWdyaWRfX2Nvcm5lci0taGVhZGluZyUyMik/LmNsaWNrKCk7dmFyIGU7KGU9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCglMjJzY3JpcHQlMjIpKS5zZXRBdHRyaWJ1dGUoJTIydHlwZSUyMiwlMjJtb2R1bGUlMjIpLGUuaW5uZXJIVE1MPSUyMihhd2FpdCBpbXBvcnQoJTI3aHR0cHM6Ly9raGVycmljay5naXRodWIuaW8vYmxvY2stZ2FyZGVuL3NyYy9hcGkvZXhhbXBsZXMvVmlkZW8ubWpzJTI3KSkuZGVtbygpJTIyLGRvY3VtZW50LmJvZHkuYXBwZW5kKGUpOyIKICAgICAgICAgICAgICByZWw9Im5vZm9sbG93IgogICAgICAgICAgICAgID48c3ZnCiAgICAgICAgICAgICAgICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgICAgICAgICAgICAgICBoZWlnaHQ9IjI0cHgiCiAgICAgICAgICAgICAgICB2aWV3Qm94PSIwIC05NjAgOTYwIDk2MCIKICAgICAgICAgICAgICAgIHdpZHRoPSIyNHB4IgogICAgICAgICAgICAgICAgZmlsbD0iI2FhYSIKICAgICAgICAgICAgICA+CiAgICAgICAgICAgICAgICA8cGF0aAogICAgICAgICAgICAgICAgICBkPSJNMjAwLTEyMHYtNjQwcTAtMzMgMjMuNS01Ni41VDI4MC04NDBoNDAwcTMzIDAgNTYuNSAyMy41VDc2MC03NjB2NjQwTDQ4MC0yNDAgMjAwLTEyMFptODAtMTIyIDIwMC04NiAyMDAgODZ2LTUxOEgyODB2NTE4Wm0wLTUxOGg0MDAtNDAwWiIKICAgICAgICAgICAgICAgIC8+PC9zdmcKICAgICAgICAgICAgICA+PHNwYW4gaGlkZGVuPSJoaWRkZW4iCiAgICAgICAgICAgICAgICA+QmxvY2sgR2FyZGVuIC0gVmlkZW8gLSBCb29rbWFya2xldDwvc3BhbgogICAgICAgICAgICAgID48L2EKICAgICAgICAgICAgPgogICAgICAgICAgPC9wPgogICAgICAgIDwvbGk+CiAgICAgIDwvdWw+CgogICAgICA8aDMgaWQ9IlRpY1RhY1RvZSI+VGljVGFjVG9lIC0gUGxheSBhIGdhbWUgb2YgVGljIFRhYyBUb2UuPC9oMz4KICAgICAgPHVsPgogICAgICAgIDxsaT4KICAgICAgICAgIDxwPgogICAgICAgICAgICA8YQogICAgICAgICAgICAgIGhyZWY9Imh0dHBzOi8vZ2l0aHViLmNvbS9raGVycmljay9ibG9jay1nYXJkZW4vdHJlZS9tYWluL3NyYy9hcGkvZXhhbXBsZXMvVGljVGFjVG9lLm1qcyIKICAgICAgICAgICAgICB0YXJnZXQ9Il9ibGFuayIKICAgICAgICAgICAgICA+U291cmNlPC9hCiAgICAgICAgICAgID46CiAgICAgICAgICAgIDxhCiAgICAgICAgICAgICAgaHJlZj0iaHR0cHM6Ly9raGVycmljay5naXRodWIuaW8vYmxvY2stZ2FyZGVuL3NyYy9hcGkvZXhhbXBsZXMvVGljVGFjVG9lLm1qcyIKICAgICAgICAgICAgICB0YXJnZXQ9Il9ibGFuayIKICAgICAgICAgICAgICA+VGljVGFjVG9lLm1qczwvYQogICAgICAgICAgICA+CiAgICAgICAgICA8L3A+CiAgICAgICAgPC9saT4KICAgICAgICA8bGk+CiAgICAgICAgICA8cD4KICAgICAgICAgICAgPGEKICAgICAgICAgICAgICBocmVmPSJqYXZhc2NyaXB0OnZhciBlbD0oZnVuY3Rpb24gZihlLG4pe3JldHVybiFlP251bGw6ZS50YWdOYW1lPT09bi50b1VwcGVyQ2FzZSgpJiZlLnNoYWRvd1Jvb3Q/ZTpbLi4uKGUuY2hpbGRyZW58fFtdKSwuLi4oZS5zaGFkb3dSb290P1tlLnNoYWRvd1Jvb3RdOltdKV0ubWFwKGM9PmYoYyxuKSkuZmluZChCb29sZWFuKXx8bnVsbH0pKGdsb2JhbFRoaXMuZG9jdW1lbnQuYm9keSwlMjJibG9jay1nYXJkZW4lMjIpPy5zaGFkb3dSb290O2VsLnF1ZXJ5U2VsZWN0b3IoJTIyZGlhbG9nLmV4YW1wbGVzLWNvbnRlbnQlMjIpPy5jbG9zZSgpO2lmKCFlbC5nZXRFbGVtZW50QnlJZCglMjJtYXBFZGl0b3JDb250cm9scyUyMik/Lmhhc0F0dHJpYnV0ZSglMjJoaWRkZW4lMjIpKWVsLmdldEVsZW1lbnRCeUlkKCUyMnRvZ2dsZU1hcEVkaXRvciUyMik/LmNsaWNrKCk7aWYoIWVsLnF1ZXJ5U2VsZWN0b3IoJTIyI3NldHRpbmdzIC51aS1ncmlkX19jb3JuZXItLWNvbnRhaW5lciUyMik/Lmhhc0F0dHJpYnV0ZSglMjJoaWRkZW4lMjIpKWVsLnF1ZXJ5U2VsZWN0b3IoJTIyI3NldHRpbmdzIC51aS1ncmlkX19jb3JuZXItLWhlYWRpbmclMjIpPy5jbGljaygpO3ZhciBlOyhlPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJTIyc2NyaXB0JTIyKSkuc2V0QXR0cmlidXRlKCUyMnR5cGUlMjIsJTIybW9kdWxlJTIyKSxlLmlubmVySFRNTD0lMjIoYXdhaXQgaW1wb3J0KCUyN2h0dHBzOi8va2hlcnJpY2suZ2l0aHViLmlvL2Jsb2NrLWdhcmRlbi9zcmMvYXBpL2V4YW1wbGVzL1RpY1RhY1RvZS5tanMlMjcpKS5kZW1vKCklMjIsZG9jdW1lbnQuYm9keS5hcHBlbmQoZSk7IgogICAgICAgICAgICAgIHJlbD0ibm9mb2xsb3ciCiAgICAgICAgICAgICAgPkJsb2NrIEdhcmRlbiAtIFRpY1RhY1RvZSAtIEJvb2ttYXJrbGV0PC9hCiAgICAgICAgICAgID4KICAgICAgICAgIDwvcD4KICAgICAgICAgIDxwIGNsYXNzPSJib29rbWFya2xldCI+CiAgICAgICAgICAgIDxhCiAgICAgICAgICAgICAgdGl0bGU9IkJsb2NrIEdhcmRlbiAtIFRpY1RhY1RvZSAtIEJvb2ttYXJrbGV0IgogICAgICAgICAgICAgIGhyZWY9ImphdmFzY3JpcHQ6dmFyIGVsPShmdW5jdGlvbiBmKGUsbil7cmV0dXJuIWU/bnVsbDplLnRhZ05hbWU9PT1uLnRvVXBwZXJDYXNlKCkmJmUuc2hhZG93Um9vdD9lOlsuLi4oZS5jaGlsZHJlbnx8W10pLC4uLihlLnNoYWRvd1Jvb3Q/W2Uuc2hhZG93Um9vdF06W10pXS5tYXAoYz0+ZihjLG4pKS5maW5kKEJvb2xlYW4pfHxudWxsfSkoZ2xvYmFsVGhpcy5kb2N1bWVudC5ib2R5LCUyMmJsb2NrLWdhcmRlbiUyMik/LnNoYWRvd1Jvb3Q7ZWwucXVlcnlTZWxlY3RvciglMjJkaWFsb2cuZXhhbXBsZXMtY29udGVudCUyMik/LmNsb3NlKCk7aWYoIWVsLmdldEVsZW1lbnRCeUlkKCUyMm1hcEVkaXRvckNvbnRyb2xzJTIyKT8uaGFzQXR0cmlidXRlKCUyMmhpZGRlbiUyMikpZWwuZ2V0RWxlbWVudEJ5SWQoJTIydG9nZ2xlTWFwRWRpdG9yJTIyKT8uY2xpY2soKTtpZighZWwucXVlcnlTZWxlY3RvciglMjIjc2V0dGluZ3MgLnVpLWdyaWRfX2Nvcm5lci0tY29udGFpbmVyJTIyKT8uaGFzQXR0cmlidXRlKCUyMmhpZGRlbiUyMikpZWwucXVlcnlTZWxlY3RvciglMjIjc2V0dGluZ3MgLnVpLWdyaWRfX2Nvcm5lci0taGVhZGluZyUyMik/LmNsaWNrKCk7dmFyIGU7KGU9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCglMjJzY3JpcHQlMjIpKS5zZXRBdHRyaWJ1dGUoJTIydHlwZSUyMiwlMjJtb2R1bGUlMjIpLGUuaW5uZXJIVE1MPSUyMihhd2FpdCBpbXBvcnQoJTI3aHR0cHM6Ly9raGVycmljay5naXRodWIuaW8vYmxvY2stZ2FyZGVuL3NyYy9hcGkvZXhhbXBsZXMvVGljVGFjVG9lLm1qcyUyNykpLmRlbW8oKSUyMixkb2N1bWVudC5ib2R5LmFwcGVuZChlKTsiCiAgICAgICAgICAgICAgcmVsPSJub2ZvbGxvdyIKICAgICAgICAgICAgICA+PHN2ZwogICAgICAgICAgICAgICAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICAgICAgICAgICAgICAgaGVpZ2h0PSIyNHB4IgogICAgICAgICAgICAgICAgdmlld0JveD0iMCAtOTYwIDk2MCA5NjAiCiAgICAgICAgICAgICAgICB3aWR0aD0iMjRweCIKICAgICAgICAgICAgICAgIGZpbGw9IiNhYWEiCiAgICAgICAgICAgICAgPgogICAgICAgICAgICAgICAgPHBhdGgKICAgICAgICAgICAgICAgICAgZD0iTTIwMC0xMjB2LTY0MHEwLTMzIDIzLjUtNTYuNVQyODAtODQwaDQwMHEzMyAwIDU2LjUgMjMuNVQ3NjAtNzYwdjY0MEw0ODAtMjQwIDIwMC0xMjBabTgwLTEyMiAyMDAtODYgMjAwIDg2di01MThIMjgwdjUxOFptMC01MThoNDAwLTQwMFoiCiAgICAgICAgICAgICAgICAvPjwvc3ZnCiAgICAgICAgICAgICAgPjxzcGFuIGhpZGRlbj0iaGlkZGVuIgogICAgICAgICAgICAgICAgPkJsb2NrIEdhcmRlbiAtIFRpY1RhY1RvZSAtIEJvb2ttYXJrbGV0PC9zcGFuCiAgICAgICAgICAgICAgPjwvYQogICAgICAgICAgICA+CiAgICAgICAgICA8L3A+CiAgICAgICAgPC9saT4KICAgICAgPC91bD4KCiAgICAgIDxoMyBpZD0iS29uYW1pQ29kZSI+CiAgICAgICAgS29uYW1pIENvZGUgLSBTaG93cyBoYW5kbGluZyBvZiBrZXlib2FyZCBzZXF1ZW5jZXMgYW5kIGhpZGRlbgogICAgICAgIGludGVyYWN0aW9ucy4KICAgICAgPC9oMz4KICAgICAgPHVsPgogICAgICAgIDxsaT4KICAgICAgICAgIDxwPgogICAgICAgICAgICA8YQogICAgICAgICAgICAgIGhyZWY9Imh0dHBzOi8vZ2l0aHViLmNvbS9raGVycmljay9ibG9jay1nYXJkZW4vdHJlZS9tYWluL3NyYy9hcGkvZXhhbXBsZXMvS29uYW1pQ29kZS5tanMiCiAgICAgICAgICAgICAgdGFyZ2V0PSJfYmxhbmsiCiAgICAgICAgICAgICAgPlNvdXJjZTwvYQogICAgICAgICAgICA+OgogICAgICAgICAgICA8YQogICAgICAgICAgICAgIGhyZWY9Imh0dHBzOi8va2hlcnJpY2suZ2l0aHViLmlvL2Jsb2NrLWdhcmRlbi9zcmMvYXBpL2V4YW1wbGVzL0tvbmFtaUNvZGUubWpzIgogICAgICAgICAgICAgIHRhcmdldD0iX2JsYW5rIgogICAgICAgICAgICAgID5Lb25hbWlDb2RlLm1qczwvYQogICAgICAgICAgICA+CiAgICAgICAgICA8L3A+CiAgICAgICAgPC9saT4KICAgICAgICA8bGk+CiAgICAgICAgICA8cD4KICAgICAgICAgICAgPGEKICAgICAgICAgICAgICBocmVmPSJqYXZhc2NyaXB0OnZhciBlbD0oZnVuY3Rpb24gZihlLG4pe3JldHVybiFlP251bGw6ZS50YWdOYW1lPT09bi50b1VwcGVyQ2FzZSgpJiZlLnNoYWRvd1Jvb3Q/ZTpbLi4uKGUuY2hpbGRyZW58fFtdKSwuLi4oZS5zaGFkb3dSb290P1tlLnNoYWRvd1Jvb3RdOltdKV0ubWFwKGM9PmYoYyxuKSkuZmluZChCb29sZWFuKXx8bnVsbH0pKGdsb2JhbFRoaXMuZG9jdW1lbnQuYm9keSwlMjJibG9jay1nYXJkZW4lMjIpPy5zaGFkb3dSb290O2VsLnF1ZXJ5U2VsZWN0b3IoJTIyZGlhbG9nLmV4YW1wbGVzLWNvbnRlbnQlMjIpPy5jbG9zZSgpO2lmKCFlbC5nZXRFbGVtZW50QnlJZCglMjJtYXBFZGl0b3JDb250cm9scyUyMik/Lmhhc0F0dHJpYnV0ZSglMjJoaWRkZW4lMjIpKWVsLmdldEVsZW1lbnRCeUlkKCUyMnRvZ2dsZU1hcEVkaXRvciUyMik/LmNsaWNrKCk7aWYoIWVsLnF1ZXJ5U2VsZWN0b3IoJTIyI3NldHRpbmdzIC51aS1ncmlkX19jb3JuZXItLWNvbnRhaW5lciUyMik/Lmhhc0F0dHJpYnV0ZSglMjJoaWRkZW4lMjIpKWVsLnF1ZXJ5U2VsZWN0b3IoJTIyI3NldHRpbmdzIC51aS1ncmlkX19jb3JuZXItLWhlYWRpbmclMjIpPy5jbGljaygpO3ZhciBlOyhlPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJTIyc2NyaXB0JTIyKSkuc2V0QXR0cmlidXRlKCUyMnR5cGUlMjIsJTIybW9kdWxlJTIyKSxlLmlubmVySFRNTD0lMjIoYXdhaXQgaW1wb3J0KCUyN2h0dHBzOi8va2hlcnJpY2suZ2l0aHViLmlvL2Jsb2NrLWdhcmRlbi9zcmMvYXBpL2V4YW1wbGVzL0tvbmFtaUNvZGUubWpzJTI3KSkuZGVtbygpJTIyLGRvY3VtZW50LmJvZHkuYXBwZW5kKGUpOyIKICAgICAgICAgICAgICByZWw9Im5vZm9sbG93IgogICAgICAgICAgICAgID5CbG9jayBHYXJkZW4gLSBLb25hbWkgQ29kZSAtIEJvb2ttYXJrbGV0PC9hCiAgICAgICAgICAgID4KICAgICAgICAgIDwvcD4KICAgICAgICAgIDxwIGNsYXNzPSJib29rbWFya2xldCI+CiAgICAgICAgICAgIDxhCiAgICAgICAgICAgICAgdGl0bGU9IkJsb2NrIEdhcmRlbiAtIEtvbmFtaSBDb2RlIC0gQm9va21hcmtsZXQiCiAgICAgICAgICAgICAgaHJlZj0iamF2YXNjcmlwdDp2YXIgZWw9KGZ1bmN0aW9uIGYoZSxuKXtyZXR1cm4hZT9udWxsOmUudGFnTmFtZT09PW4udG9VcHBlckNhc2UoKSYmZS5zaGFkb3dSb290P2U6Wy4uLihlLmNoaWxkcmVufHxbXSksLi4uKGUuc2hhZG93Um9vdD9bZS5zaGFkb3dSb290XTpbXSldLm1hcChjPT5mKGMsbikpLmZpbmQoQm9vbGVhbil8fG51bGx9KShnbG9iYWxUaGlzLmRvY3VtZW50LmJvZHksJTIyYmxvY2stZ2FyZGVuJTIyKT8uc2hhZG93Um9vdDtlbC5xdWVyeVNlbGVjdG9yKCUyMmRpYWxvZy5leGFtcGxlcy1jb250ZW50JTIyKT8uY2xvc2UoKTtpZighZWwuZ2V0RWxlbWVudEJ5SWQoJTIybWFwRWRpdG9yQ29udHJvbHMlMjIpPy5oYXNBdHRyaWJ1dGUoJTIyaGlkZGVuJTIyKSllbC5nZXRFbGVtZW50QnlJZCglMjJ0b2dnbGVNYXBFZGl0b3IlMjIpPy5jbGljaygpO2lmKCFlbC5xdWVyeVNlbGVjdG9yKCUyMiNzZXR0aW5ncyAudWktZ3JpZF9fY29ybmVyLS1jb250YWluZXIlMjIpPy5oYXNBdHRyaWJ1dGUoJTIyaGlkZGVuJTIyKSllbC5xdWVyeVNlbGVjdG9yKCUyMiNzZXR0aW5ncyAudWktZ3JpZF9fY29ybmVyLS1oZWFkaW5nJTIyKT8uY2xpY2soKTt2YXIgZTsoZT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCUyMnNjcmlwdCUyMikpLnNldEF0dHJpYnV0ZSglMjJ0eXBlJTIyLCUyMm1vZHVsZSUyMiksZS5pbm5lckhUTUw9JTIyKGF3YWl0IGltcG9ydCglMjdodHRwczovL2toZXJyaWNrLmdpdGh1Yi5pby9ibG9jay1nYXJkZW4vc3JjL2FwaS9leGFtcGxlcy9Lb25hbWlDb2RlLm1qcyUyNykpLmRlbW8oKSUyMixkb2N1bWVudC5ib2R5LmFwcGVuZChlKTsiCiAgICAgICAgICAgICAgcmVsPSJub2ZvbGxvdyIKICAgICAgICAgICAgICA+PHN2ZwogICAgICAgICAgICAgICAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICAgICAgICAgICAgICAgaGVpZ2h0PSIyNHB4IgogICAgICAgICAgICAgICAgdmlld0JveD0iMCAtOTYwIDk2MCA5NjAiCiAgICAgICAgICAgICAgICB3aWR0aD0iMjRweCIKICAgICAgICAgICAgICAgIGZpbGw9IiNhYWEiCiAgICAgICAgICAgICAgPgogICAgICAgICAgICAgICAgPHBhdGgKICAgICAgICAgICAgICAgICAgZD0iTTIwMC0xMjB2LTY0MHEwLTMzIDIzLjUtNTYuNVQyODAtODQwaDQwMHEzMyAwIDU2LjUgMjMuNVQ3NjAtNzYwdjY0MEw0ODAtMjQwIDIwMC0xMjBabTgwLTEyMiAyMDAtODYgMjAwIDg2di01MThIMjgwdjUxOFptMC01MThoNDAwLTQwMFoiCiAgICAgICAgICAgICAgICAvPjwvc3ZnCiAgICAgICAgICAgICAgPjxzcGFuIGhpZGRlbj0iaGlkZGVuIgogICAgICAgICAgICAgICAgPkJsb2NrIEdhcmRlbiAtIEtvbmFtaSBDb2RlIC0gQm9va21hcmtsZXQ8L3NwYW4KICAgICAgICAgICAgICA+PC9hCiAgICAgICAgICAgID4KICAgICAgICAgIDwvcD4KICAgICAgICA8L2xpPgogICAgICA8L3VsPgoKICAgICAgPGgzIGlkPSJNZXNzYWdpbmciPk1lc3NhZ2luZyAtIERyYXcgdGV4dCBvbiB0aGUgbWFwLjwvaDM+CiAgICAgIDx1bD4KICAgICAgICA8bGk+CiAgICAgICAgICA8cD4KICAgICAgICAgICAgPGEKICAgICAgICAgICAgICBocmVmPSJodHRwczovL2dpdGh1Yi5jb20va2hlcnJpY2svYmxvY2stZ2FyZGVuL3RyZWUvbWFpbi9zcmMvYXBpL2V4YW1wbGVzL01lc3NhZ2luZy5tanMiCiAgICAgICAgICAgICAgdGFyZ2V0PSJfYmxhbmsiCiAgICAgICAgICAgICAgPlNvdXJjZTwvYQogICAgICAgICAgICA+OgogICAgICAgICAgICA8YQogICAgICAgICAgICAgIGhyZWY9Imh0dHBzOi8va2hlcnJpY2suZ2l0aHViLmlvL2Jsb2NrLWdhcmRlbi9zcmMvYXBpL2V4YW1wbGVzL01lc3NhZ2luZy5tanMiCiAgICAgICAgICAgICAgdGFyZ2V0PSJfYmxhbmsiCiAgICAgICAgICAgICAgPk1lc3NhZ2luZy5tanM8L2EKICAgICAgICAgICAgPgogICAgICAgICAgPC9wPgogICAgICAgIDwvbGk+CiAgICAgICAgPGxpPgogICAgICAgICAgPHA+CiAgICAgICAgICAgIDxhCiAgICAgICAgICAgICAgaHJlZj0iamF2YXNjcmlwdDp2YXIgZWw9KGZ1bmN0aW9uIGYoZSxuKXtyZXR1cm4hZT9udWxsOmUudGFnTmFtZT09PW4udG9VcHBlckNhc2UoKSYmZS5zaGFkb3dSb290P2U6Wy4uLihlLmNoaWxkcmVufHxbXSksLi4uKGUuc2hhZG93Um9vdD9bZS5zaGFkb3dSb290XTpbXSldLm1hcChjPT5mKGMsbikpLmZpbmQoQm9vbGVhbil8fG51bGx9KShnbG9iYWxUaGlzLmRvY3VtZW50LmJvZHksJTIyYmxvY2stZ2FyZGVuJTIyKT8uc2hhZG93Um9vdDtlbC5xdWVyeVNlbGVjdG9yKCUyMmRpYWxvZy5leGFtcGxlcy1jb250ZW50JTIyKT8uY2xvc2UoKTtpZighZWwuZ2V0RWxlbWVudEJ5SWQoJTIybWFwRWRpdG9yQ29udHJvbHMlMjIpPy5oYXNBdHRyaWJ1dGUoJTIyaGlkZGVuJTIyKSllbC5nZXRFbGVtZW50QnlJZCglMjJ0b2dnbGVNYXBFZGl0b3IlMjIpPy5jbGljaygpO2lmKCFlbC5xdWVyeVNlbGVjdG9yKCUyMiNzZXR0aW5ncyAudWktZ3JpZF9fY29ybmVyLS1jb250YWluZXIlMjIpPy5oYXNBdHRyaWJ1dGUoJTIyaGlkZGVuJTIyKSllbC5xdWVyeVNlbGVjdG9yKCUyMiNzZXR0aW5ncyAudWktZ3JpZF9fY29ybmVyLS1oZWFkaW5nJTIyKT8uY2xpY2soKTt2YXIgZTsoZT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCUyMnNjcmlwdCUyMikpLnNldEF0dHJpYnV0ZSglMjJ0eXBlJTIyLCUyMm1vZHVsZSUyMiksZS5pbm5lckhUTUw9JTIyKGF3YWl0IGltcG9ydCglMjdodHRwczovL2toZXJyaWNrLmdpdGh1Yi5pby9ibG9jay1nYXJkZW4vc3JjL2FwaS9leGFtcGxlcy9NZXNzYWdpbmcubWpzJTI3KSkuZGVtbygpJTIyLGRvY3VtZW50LmJvZHkuYXBwZW5kKGUpOyIKICAgICAgICAgICAgICByZWw9Im5vZm9sbG93IgogICAgICAgICAgICAgID5CbG9jayBHYXJkZW4gLSBNZXNzYWdpbmcgLSBCb29rbWFya2xldDwvYQogICAgICAgICAgICA+CiAgICAgICAgICA8L3A+CiAgICAgICAgICA8cCBjbGFzcz0iYm9va21hcmtsZXQiPgogICAgICAgICAgICA8YQogICAgICAgICAgICAgIHRpdGxlPSJCbG9jayBHYXJkZW4gLSBNZXNzYWdpbmcgLSBCb29rbWFya2xldCIKICAgICAgICAgICAgICBocmVmPSJqYXZhc2NyaXB0OnZhciBlbD0oZnVuY3Rpb24gZihlLG4pe3JldHVybiFlP251bGw6ZS50YWdOYW1lPT09bi50b1VwcGVyQ2FzZSgpJiZlLnNoYWRvd1Jvb3Q/ZTpbLi4uKGUuY2hpbGRyZW58fFtdKSwuLi4oZS5zaGFkb3dSb290P1tlLnNoYWRvd1Jvb3RdOltdKV0ubWFwKGM9PmYoYyxuKSkuZmluZChCb29sZWFuKXx8bnVsbH0pKGdsb2JhbFRoaXMuZG9jdW1lbnQuYm9keSwlMjJibG9jay1nYXJkZW4lMjIpPy5zaGFkb3dSb290O2VsLnF1ZXJ5U2VsZWN0b3IoJTIyZGlhbG9nLmV4YW1wbGVzLWNvbnRlbnQlMjIpPy5jbG9zZSgpO2lmKCFlbC5nZXRFbGVtZW50QnlJZCglMjJtYXBFZGl0b3JDb250cm9scyUyMik/Lmhhc0F0dHJpYnV0ZSglMjJoaWRkZW4lMjIpKWVsLmdldEVsZW1lbnRCeUlkKCUyMnRvZ2dsZU1hcEVkaXRvciUyMik/LmNsaWNrKCk7aWYoIWVsLnF1ZXJ5U2VsZWN0b3IoJTIyI3NldHRpbmdzIC51aS1ncmlkX19jb3JuZXItLWNvbnRhaW5lciUyMik/Lmhhc0F0dHJpYnV0ZSglMjJoaWRkZW4lMjIpKWVsLnF1ZXJ5U2VsZWN0b3IoJTIyI3NldHRpbmdzIC51aS1ncmlkX19jb3JuZXItLWhlYWRpbmclMjIpPy5jbGljaygpO3ZhciBlOyhlPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJTIyc2NyaXB0JTIyKSkuc2V0QXR0cmlidXRlKCUyMnR5cGUlMjIsJTIybW9kdWxlJTIyKSxlLmlubmVySFRNTD0lMjIoYXdhaXQgaW1wb3J0KCUyN2h0dHBzOi8va2hlcnJpY2suZ2l0aHViLmlvL2Jsb2NrLWdhcmRlbi9zcmMvYXBpL2V4YW1wbGVzL01lc3NhZ2luZy5tanMlMjcpKS5kZW1vKCklMjIsZG9jdW1lbnQuYm9keS5hcHBlbmQoZSk7IgogICAgICAgICAgICAgIHJlbD0ibm9mb2xsb3ciCiAgICAgICAgICAgICAgPjxzdmcKICAgICAgICAgICAgICAgIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIKICAgICAgICAgICAgICAgIGhlaWdodD0iMjRweCIKICAgICAgICAgICAgICAgIHZpZXdCb3g9IjAgLTk2MCA5NjAgOTYwIgogICAgICAgICAgICAgICAgd2lkdGg9IjI0cHgiCiAgICAgICAgICAgICAgICBmaWxsPSIjYWFhIgogICAgICAgICAgICAgID4KICAgICAgICAgICAgICAgIDxwYXRoCiAgICAgICAgICAgICAgICAgIGQ9Ik0yMDAtMTIwdi02NDBxMC0zMyAyMy41LTU2LjVUMjgwLTg0MGg0MDBxMzMgMCA1Ni41IDIzLjVUNzYwLTc2MHY2NDBMNDgwLTI0MCAyMDAtMTIwWm04MC0xMjIgMjAwLTg2IDIwMCA4NnYtNTE4SDI4MHY1MThabTAtNTE4aDQwMC00MDBaIgogICAgICAgICAgICAgICAgLz48L3N2ZwogICAgICAgICAgICAgID48c3BhbiBoaWRkZW49ImhpZGRlbiIKICAgICAgICAgICAgICAgID5CbG9jayBHYXJkZW4gLSBNZXNzYWdpbmcgLSBCb29rbWFya2xldDwvc3BhbgogICAgICAgICAgICAgID48L2EKICAgICAgICAgICAgPgogICAgICAgICAgPC9wPgogICAgICAgIDwvbGk+CiAgICAgIDwvdWw+CiAgICA8L2Rpdj4KICA8L2JvZHk+CjwvaHRtbD4K")).text(),i=t.parseFromString(r,"text/html").querySelector(`.${n}`);o.innerHTML=i.innerHTML,this.shadow.append(o),this.shadow.querySelector(`.${e}-content_close-btn`).removeAttribute("hidden")}return this.dialog=o,this.initEventListeners(),o}handleDialogClick(e){e.target===this.dialog&&this.close()}initEventListeners(){this.dialog.querySelector(".examples-content_close-btn").addEventListener("click",this.close),this.dialog.addEventListener("click",this.handleDialogClick)}removeEventListeners(){this.dialog.querySelector(".examples-content_close-btn").removeEventListener("click",this.close),this.dialog.removeEventListener("click",this.handleDialogClick)}show(){this.dialog instanceof HTMLDialogElement&&this.dialog.showModal()}close(){this.removeEventListeners(),this.dialog instanceof HTMLDialogElement&&this.dialog.close()}}class _o{constructor(e,t){this.doc=e,this.shadow=t,this.dialog=null,this.close=this.close.bind(this),this.handleDialogClick=this.handleDialogClick.bind(this)}async createDialog(e){this.dialog&&this.dialog.remove();const t=`${e}-content`;let n=this.shadow.querySelector(`.${t}`);if(!n){n=this.doc.createElement("dialog"),n.setAttribute("class",t);const o=new DOMParser,r=await(await fetch("data:text/html;base64,PCFkb2N0eXBlIGh0bWw+CjxodG1sIGxhbmc9ImVuIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCI+CiAgPGhlYWQ+CiAgICA8dGl0bGU+QmxvY2sgR2FyZGVuIC0gUHJpdmFjeSBQb2xpY3k8L3RpdGxlPgogICAgPGJhc2UgaHJlZj0iLyIgLz4KICAgIDxtZXRhIGNoYXJzZXQ9InV0Zi04IiAvPgogICAgPG1ldGEKICAgICAgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEsIG1heGltdW0tc2NhbGU9MSwgdXNlci1zY2FsYWJsZT1ubywgdmlld3BvcnQtZml0PWNvdmVyIgogICAgICBuYW1lPSJ2aWV3cG9ydCIKICAgIC8+CiAgICA8bWV0YQogICAgICBuYW1lPSJkZXNjcmlwdGlvbiIKICAgICAgY29udGVudD0iUHJpdmFjeSBQb2xpY3kgLSBCbG9jayBHYXJkZW4gLSBBIDNEIHNhbmRib3ggZXhwbG9yYXRpb24gYW5kIGZhcm1pbmcgZ2FtZS4gRXhwbG9yZSBwcm9jZWR1cmFsbHkgZ2VuZXJhdGVkIHdvcmxkcywgZGlnIGZvciByZXNvdXJjZXMsIGFuZCBjdWx0aXZhdGUgYSB2YXJpZXR5IG9mIHBsYW50cy4iCiAgICAvPgogICAgPG1ldGEgbmFtZT0idGhlbWUtY29sb3IiIGNvbnRlbnQ9IiMwMDAwMDAiIC8+CiAgICA8bGluayByZWw9Im1hbmlmZXN0IiBocmVmPSJtYW5pZmVzdC5qc29uIiAvPgogICAgPGxpbmsgcmVsPSJpY29uIiBocmVmPSJhc3NldHMvaWNvbnMvZmF2aWNvbi5pY28iIHR5cGU9ImltYWdlL3gtaWNvbiIgLz4KICAgIDxsaW5rIHJlbD0iYXBwbGUtdG91Y2gtaWNvbiIgaHJlZj0iYXNzZXRzL2ljb25zL2FwcGxlLXRvdWNoLWljb24ucG5nIiAvPgogICAgPHN0eWxlPgogICAgICAqIHsKICAgICAgICAtd2Via2l0LXRhcC1oaWdobGlnaHQtY29sb3I6IHRyYW5zcGFyZW50OwogICAgICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7CiAgICAgICAgZm9udC1mYW1pbHk6IEFyaWFsLCBzYW5zLXNlcmlmOwogICAgICB9CgogICAgICBib2R5IHsKICAgICAgICBiYWNrZ3JvdW5kOiB2YXIoLS1iZy1jb2xvci13aGl0ZSwgI2ZmZik7CiAgICAgICAgY29sb3I6IHZhcigtLWJnLWNvbG9yLWJsYWNrLCAjMDAwKTsKICAgICAgICBtYXJnaW46IDA7CiAgICAgICAgcGFkZGluZzogMnJlbTsKICAgICAgfQoKICAgICAgbGkgewogICAgICAgIG1hcmdpbjogMC4yNXJlbSAwOwogICAgICB9CiAgICA8L3N0eWxlPgogIDwvaGVhZD4KICA8Ym9keSBjbGFzcz0icHJpdmFjeSI+CiAgICA8ZGl2IGNsYXNzPSJwcml2YWN5LWNvbnRlbnQiPgogICAgICA8aGVhZGVyIGNsYXNzPSJwcml2YWN5LWNvbnRlbnRfaGVhZGVyIj4KICAgICAgICA8aDE+CiAgICAgICAgICA8YQogICAgICAgICAgICBocmVmPSJodHRwczovL2toZXJyaWNrLmdpdGh1Yi5pby9ibG9jay1nYXJkZW4vIgogICAgICAgICAgICByZWw9Im5vb3BlbmVyIG5vcmVmZXJyZXIiCiAgICAgICAgICAgIHRhcmdldD0iX2JsYW5rIgogICAgICAgICAgICA+QmxvY2sgR2FyZGVuPC9hCiAgICAgICAgICA+CiAgICAgICAgPC9oMT4KICAgICAgICA8YnV0dG9uIGNsYXNzPSJwcml2YWN5LWNvbnRlbnRfY2xvc2UtYnRuIiBoaWRkZW49ImhpZGRlbiI+CiAgICAgICAgICAmdGltZXM7CiAgICAgICAgPC9idXR0b24+CiAgICAgIDwvaGVhZGVyPgoKICAgICAgPGgyPgogICAgICAgIDxhCiAgICAgICAgICBocmVmPSJodHRwczovL2toZXJyaWNrLmdpdGh1Yi5pby9ibG9jay1nYXJkZW4vcHJpdmFjeS8iCiAgICAgICAgICByZWw9Im5vb3BlbmVyIG5vcmVmZXJyZXIiCiAgICAgICAgICB0YXJnZXQ9Il9ibGFuayIKICAgICAgICAgID5Qcml2YWN5IFBvbGljeTwvYQogICAgICAgID4KICAgICAgPC9oMj4KCiAgICAgIDxkaXY+CiAgICAgICAgPHA+PHN0cm9uZz5MYXN0IHVwZGF0ZWQ6PC9zdHJvbmc+IERlY2VtYmVyIDIwLCAyMDI1PC9wPgoKICAgICAgICA8cD4KICAgICAgICAgIFRoaXMgUHJpdmFjeSBQb2xpY3kgZGVzY3JpYmVzIE91ciBwb2xpY2llcyBhbmQgcHJvY2VkdXJlcyBvbiB0aGUKICAgICAgICAgIGNvbGxlY3Rpb24sIHVzZSBhbmQgZGlzY2xvc3VyZSBvZiBZb3VyIGluZm9ybWF0aW9uIHdoZW4gWW91IHVzZSB0aGUKICAgICAgICAgIFNlcnZpY2UuCiAgICAgICAgPC9wPgoKICAgICAgICA8cD4KICAgICAgICAgIDxzdHJvbmcKICAgICAgICAgICAgPldlIGRvIG5vdCBjb2xsZWN0LCBzdG9yZSwgdXNlLCBvciBkaXNzZW1pbmF0ZSBZb3VyIFBlcnNvbmFsCiAgICAgICAgICAgIERhdGEuPC9zdHJvbmcKICAgICAgICAgID4KICAgICAgICA8L3A+CgogICAgICAgIDxoMz5JbnRlcnByZXRhdGlvbiBhbmQgRGVmaW5pdGlvbnM8L2gzPgoKICAgICAgICA8aDQ+SW50ZXJwcmV0YXRpb248L2g0PgogICAgICAgIDxwPgogICAgICAgICAgVGhlIHdvcmRzIG9mIHdoaWNoIHRoZSBpbml0aWFsIGxldHRlciBpcyBjYXBpdGFsaXplZCBoYXZlIG1lYW5pbmdzCiAgICAgICAgICBkZWZpbmVkIHVuZGVyIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9ucy4gVGhlIGZvbGxvd2luZyBkZWZpbml0aW9ucwogICAgICAgICAgc2hhbGwgaGF2ZSB0aGUgc2FtZSBtZWFuaW5nIHJlZ2FyZGxlc3Mgb2Ygd2hldGhlciB0aGV5IGFwcGVhciBpbgogICAgICAgICAgc2luZ3VsYXIgb3IgaW4gcGx1cmFsLgogICAgICAgIDwvcD4KCiAgICAgICAgPGg0PkRlZmluaXRpb25zPC9oND4KICAgICAgICA8cD5Gb3IgdGhlIHB1cnBvc2VzIG9mIHRoaXMgUHJpdmFjeSBQb2xpY3k6PC9wPgoKICAgICAgICA8dWw+CiAgICAgICAgICA8bGk+CiAgICAgICAgICAgIDxzdHJvbmc+QXBwbGljYXRpb248L3N0cm9uZz4gcmVmZXJzIHRvIEJsb2NrIEdhcmRlbiwgdGhlIHNvZnR3YXJlCiAgICAgICAgICAgIHByb2dyYW0gcHJvdmlkZWQgYnkgdGhlIENvbXBhbnkuCiAgICAgICAgICA8L2xpPgogICAgICAgICAgPGxpPgogICAgICAgICAgICA8c3Ryb25nPkNvbXBhbnk8L3N0cm9uZz4gKHJlZmVycmVkIHRvIGFzIGVpdGhlciAidGhlIENvbXBhbnkiLCAiV2UiLAogICAgICAgICAgICAiVXMiIG9yICJPdXIiIGluIHRoaXMgQWdyZWVtZW50KSByZWZlcnMgdG8gQmxvY2sgR2FyZGVuLgogICAgICAgICAgPC9saT4KICAgICAgICAgIDxsaT4KICAgICAgICAgICAgPHN0cm9uZz5EZXZpY2U8L3N0cm9uZz4gbWVhbnMgYW55IGRldmljZSB0aGF0IGNhbiBhY2Nlc3MgdGhlIFNlcnZpY2UKICAgICAgICAgICAgc3VjaCBhcyBhIGNvbXB1dGVyLCBhIGNlbGxwaG9uZSBvciBhIGRpZ2l0YWwgdGFibGV0LgogICAgICAgICAgPC9saT4KICAgICAgICAgIDxsaT4KICAgICAgICAgICAgPHN0cm9uZz5QZXJzb25hbCBEYXRhPC9zdHJvbmc+IGlzIGFueSBpbmZvcm1hdGlvbiB0aGF0IHJlbGF0ZXMgdG8gYW4KICAgICAgICAgICAgaWRlbnRpZmllZCBvciBpZGVudGlmaWFibGUgaW5kaXZpZHVhbC4KICAgICAgICAgIDwvbGk+CiAgICAgICAgICA8bGk+PHN0cm9uZz5TZXJ2aWNlPC9zdHJvbmc+IHJlZmVycyB0byB0aGUgQXBwbGljYXRpb24uPC9saT4KICAgICAgICAgIDxsaT4KICAgICAgICAgICAgPHN0cm9uZz5Vc2FnZSBEYXRhPC9zdHJvbmc+IHJlZmVycyB0byBkYXRhIGNvbGxlY3RlZCBhdXRvbWF0aWNhbGx5LAogICAgICAgICAgICBlaXRoZXIgZ2VuZXJhdGVkIGJ5IHRoZSB1c2Ugb2YgdGhlIFNlcnZpY2Ugb3IgZnJvbSB0aGUgU2VydmljZQogICAgICAgICAgICBpbmZyYXN0cnVjdHVyZSBpdHNlbGYuCiAgICAgICAgICA8L2xpPgogICAgICAgICAgPGxpPgogICAgICAgICAgICA8c3Ryb25nPllvdTwvc3Ryb25nPiBtZWFucyB0aGUgaW5kaXZpZHVhbCBhY2Nlc3Npbmcgb3IgdXNpbmcgdGhlCiAgICAgICAgICAgIFNlcnZpY2UsIG9yIHRoZSBjb21wYW55LCBvciBvdGhlciBsZWdhbCBlbnRpdHkgb24gYmVoYWxmIG9mIHdoaWNoCiAgICAgICAgICAgIHN1Y2ggaW5kaXZpZHVhbCBpcyBhY2Nlc3Npbmcgb3IgdXNpbmcgdGhlIFNlcnZpY2UsIGFzIGFwcGxpY2FibGUuCiAgICAgICAgICA8L2xpPgogICAgICAgIDwvdWw+CgogICAgICAgIDxoMz5Db2xsZWN0aW5nIGFuZCBVc2luZyBZb3VyIFBlcnNvbmFsIERhdGE8L2gzPgoKICAgICAgICA8aDQ+VHlwZXMgb2YgRGF0YSBOb3QgQ29sbGVjdGVkPC9oND4KCiAgICAgICAgPGg1PlBlcnNvbmFsIERhdGE8L2g1PgogICAgICAgIDxwPgogICAgICAgICAgV2hpbGUgdXNpbmcgT3VyIFNlcnZpY2UsIFdlIHdpbGwgbm90IGFzayBZb3UgdG8gcHJvdmlkZSBVcyB3aXRoCiAgICAgICAgICBwZXJzb25hbGx5IGlkZW50aWZpYWJsZSBpbmZvcm1hdGlvbiB0aGF0IHdvdWxkIGJlIHVzZWQgdG8gY29udGFjdCBvcgogICAgICAgICAgaWRlbnRpZnkgWW91LgogICAgICAgIDwvcD4KCiAgICAgICAgPGg1PlVzYWdlIERhdGE8L2g1PgogICAgICAgIDxwPlVzYWdlIERhdGEgaXMgbm90IGNvbGxlY3RlZCBhdXRvbWF0aWNhbGx5IHdoZW4gdXNpbmcgdGhlIFNlcnZpY2UuPC9wPgoKICAgICAgICA8aDU+TG9jYWwgU3RvcmFnZTwvaDU+CiAgICAgICAgPHA+CiAgICAgICAgICBCbG9jayBHYXJkZW4gdXNlcyB5b3VyIGJyb3dzZXIncyBsb2NhbCBzdG9yYWdlIHRvIHNhdmUgeW91ciBnYW1lCiAgICAgICAgICBkZXRhaWxzIG9uIHlvdXIgZGV2aWNlLiBUaGlzIGRhdGEgbmV2ZXIgbGVhdmVzIHlvdXIgZGV2aWNlIGFuZCBpcyBub3QKICAgICAgICAgIHRyYW5zbWl0dGVkIHRvIGFueSBzZXJ2ZXJzLiBZb3UgaGF2ZSBmdWxsIGNvbnRyb2wgb3ZlciB0aGlzIGRhdGEgYW5kCiAgICAgICAgICBjYW4gY2xlYXIgaXQgYXQgYW55IHRpbWUgdGhyb3VnaCB5b3VyIGJyb3dzZXIgc2V0dGluZ3MuCiAgICAgICAgPC9wPgoKICAgICAgICA8aDQ+VHJhY2tpbmcgVGVjaG5vbG9naWVzPC9oND4KICAgICAgICA8cD4KICAgICAgICAgIFdlIGRvIG5vdCB1c2UgQ29va2llcyBvciBzaW1pbGFyIHRyYWNraW5nIHRlY2hub2xvZ2llcyB0byB0cmFjawogICAgICAgICAgYWN0aXZpdHkgb24gT3VyIFNlcnZpY2UuCiAgICAgICAgPC9wPgoKICAgICAgICA8aDM+VXNlIG9mIFlvdXIgUGVyc29uYWwgRGF0YTwvaDM+CiAgICAgICAgPHA+VGhlIENvbXBhbnkgZG9lcyBub3QgdXNlIFBlcnNvbmFsIERhdGEgZm9yIGFueSBwdXJwb3Nlcy48L3A+CgogICAgICAgIDxoMz5SZXRlbnRpb24gb2YgWW91ciBQZXJzb25hbCBEYXRhPC9oMz4KICAgICAgICA8cD4KICAgICAgICAgIFRoZSBDb21wYW55IGRvZXMgbm90IHJldGFpbiBZb3VyIFBlcnNvbmFsIERhdGEuIEFsbCBnYW1lIGRhdGEgaXMKICAgICAgICAgIHN0b3JlZCBsb2NhbGx5IG9uIHlvdXIgZGV2aWNlIG9ubHkuCiAgICAgICAgPC9wPgoKICAgICAgICA8aDM+RGlzY2xvc3VyZSBvZiBZb3VyIFBlcnNvbmFsIERhdGE8L2gzPgoKICAgICAgICA8aDQ+QnVzaW5lc3MgVHJhbnNhY3Rpb25zPC9oND4KICAgICAgICA8cD4KICAgICAgICAgIElmIHRoZSBDb21wYW55IGlzIGludm9sdmVkIGluIGEgbWVyZ2VyLCBhY3F1aXNpdGlvbiBvciBhc3NldCBzYWxlLAogICAgICAgICAgWW91ciBQZXJzb25hbCBEYXRhIHdpbGwgbm90IGJlIHRyYW5zZmVycmVkLgogICAgICAgIDwvcD4KCiAgICAgICAgPGgzPlNlY3VyaXR5IG9mIFlvdXIgUGVyc29uYWwgRGF0YTwvaDM+CiAgICAgICAgPHA+CiAgICAgICAgICBUaGUgc2VjdXJpdHkgb2YgWW91ciBQZXJzb25hbCBEYXRhIGlzIGltcG9ydGFudCB0byBVcy4gU2luY2UgYWxsIGdhbWUKICAgICAgICAgIGRhdGEgaXMgc3RvcmVkIGxvY2FsbHkgb24geW91ciBkZXZpY2UgYW5kIG5ldmVyIHRyYW5zbWl0dGVkIHRvCiAgICAgICAgICBleHRlcm5hbCBzZXJ2ZXJzLCB0aGUgc2VjdXJpdHkgb2YgeW91ciBkYXRhIGlzIGxhcmdlbHkgZGVwZW5kZW50IG9uCiAgICAgICAgICB5b3VyIGRldmljZSdzIHNlY3VyaXR5IG1lYXN1cmVzLgogICAgICAgIDwvcD4KCiAgICAgICAgPGgzPkxpbmtzIHRvIE90aGVyIFdlYnNpdGVzPC9oMz4KICAgICAgICA8cD4KICAgICAgICAgIE91ciBTZXJ2aWNlIG1heSBjb250YWluIGxpbmtzIHRvIG90aGVyIHdlYnNpdGVzIHRoYXQgYXJlIG5vdCBvcGVyYXRlZAogICAgICAgICAgYnkgVXMuIElmIFlvdSBjbGljayBvbiBhIHRoaXJkIHBhcnR5IGxpbmssIFlvdSB3aWxsIGJlIGRpcmVjdGVkIHRvCiAgICAgICAgICB0aGF0IHRoaXJkIHBhcnR5J3Mgc2l0ZS4gV2Ugc3Ryb25nbHkgYWR2aXNlIFlvdSB0byByZXZpZXcgdGhlIFByaXZhY3kKICAgICAgICAgIFBvbGljeSBvZiBldmVyeSBzaXRlIFlvdSB2aXNpdC4KICAgICAgICA8L3A+CgogICAgICAgIDxwPgogICAgICAgICAgV2UgaGF2ZSBubyBjb250cm9sIG92ZXIgYW5kIGFzc3VtZSBubyByZXNwb25zaWJpbGl0eSBmb3IgdGhlIGNvbnRlbnQsCiAgICAgICAgICBwcml2YWN5IHBvbGljaWVzIG9yIHByYWN0aWNlcyBvZiBhbnkgdGhpcmQgcGFydHkgc2l0ZXMgb3Igc2VydmljZXMuCiAgICAgICAgPC9wPgoKICAgICAgICA8aDM+Q2hhbmdlcyB0byB0aGlzIFByaXZhY3kgUG9saWN5PC9oMz4KICAgICAgICA8cD4KICAgICAgICAgIFdlIG1heSB1cGRhdGUgT3VyIFByaXZhY3kgUG9saWN5IGZyb20gdGltZSB0byB0aW1lLiBXZSB3aWxsIG5vdGlmeSBZb3UKICAgICAgICAgIG9mIGFueSBjaGFuZ2VzIGJ5IHBvc3RpbmcgdGhlIG5ldyBQcml2YWN5IFBvbGljeSB3aXRoaW4gdGhlCiAgICAgICAgICBhcHBsaWNhdGlvbi4KICAgICAgICA8L3A+CgogICAgICAgIDxwPgogICAgICAgICAgV2Ugd2lsbCB1cGRhdGUgdGhlICJMYXN0IHVwZGF0ZWQiIGRhdGUgYXQgdGhlIHRvcCBvZiB0aGlzIFByaXZhY3kKICAgICAgICAgIFBvbGljeS4KICAgICAgICA8L3A+CgogICAgICAgIDxwPgogICAgICAgICAgWW91IGFyZSBhZHZpc2VkIHRvIHJldmlldyB0aGlzIFByaXZhY3kgUG9saWN5IHBlcmlvZGljYWxseSBmb3IgYW55CiAgICAgICAgICBjaGFuZ2VzLiBDaGFuZ2VzIHRvIHRoaXMgUHJpdmFjeSBQb2xpY3kgYXJlIGVmZmVjdGl2ZSB3aGVuIHRoZXkgYXJlCiAgICAgICAgICBwb3N0ZWQuCiAgICAgICAgPC9wPgoKICAgICAgICA8aDM+Q29udGFjdCBVczwvaDM+CiAgICAgICAgPHA+CiAgICAgICAgICBJZiB5b3UgaGF2ZSBhbnkgcXVlc3Rpb25zIGFib3V0IHRoaXMgUHJpdmFjeSBQb2xpY3ksIFlvdSBjYW4gY29udGFjdAogICAgICAgICAgdXM6CiAgICAgICAgPC9wPgogICAgICAgIDx1bD4KICAgICAgICAgIDxsaT5CeSBlbWFpbDogYWRtaW5AY3JlYXRpdmVpbmR1c3RyaWFsLmNvbTwvbGk+CiAgICAgICAgPC91bD4KICAgICAgPC9kaXY+CiAgICA8L2Rpdj4KICA8L2JvZHk+CjwvaHRtbD4K")).text(),i=o.parseFromString(r,"text/html").querySelector(`.${t}`);n.innerHTML=i.innerHTML,this.shadow.append(n),this.shadow.querySelector(`.${e}-content_close-btn`).removeAttribute("hidden")}return this.dialog=n,this.initEventListeners(),n}handleDialogClick(e){e.target===this.dialog&&this.close()}initEventListeners(){this.dialog.querySelector(".privacy-content_close-btn").addEventListener("click",this.close),this.dialog.addEventListener("click",this.handleDialogClick)}removeEventListeners(){this.dialog.querySelector(".privacy-content_close-btn").removeEventListener("click",this.close),this.dialog.removeEventListener("click",this.handleDialogClick)}show(){this.dialog instanceof HTMLDialogElement&&this.dialog.showModal()}close(){this.removeEventListeners(),this.dialog instanceof HTMLDialogElement&&this.dialog.close()}}class Ko{constructor(e,t,n){this.gThis=e,this.doc=t,this.shadow=n,this.dialog=null,this.close=this.close.bind(this),this.handleLoad=this.handleLoad.bind(this)}async createDialog(){this.dialog&&this.dialog.remove();const e=this.doc.createElement("dialog");e.setAttribute("id","urlDialog"),e.style.cssText="\n      background: var(--bg-color-gray-50);\n      border-radius: 0.5rem;\n      border: 0.125rem solid var(--bg-color-gray-900);\n      color: var(--bg-color-gray-900);\n      font-family: monospace;\n      max-width: 31.25rem;\n      padding: 1.25rem;\n      width: 90%;\n    ",e.innerHTML='\n      <div style="align-items: center; display: flex; justify-content: space-between; margin-bottom: 0.9375rem;">\n        <h3 style="margin: 0">Load Game From URL</h3>\n        <button id="closeUrlDialog" style="background: var(--bg-color-red-500); border-radius: 0.25rem; border: none; color: white; cursor: pointer; padding: 0.3125rem 0.625rem;">\n          &times;\n        </button>\n      </div>\n      <div style="display: flex; flex-direction: column; gap: 0.9375rem;">\n        <div>\n          <h4 style="margin: 0 0 0.625rem 0">Example Game States</h4>\n          <div style="display: flex; gap: 0.625rem;">\n            <button id="exampleGame1" style="background: var(--bg-color-emerald-700); border-radius: 0.25rem; border: none; color: white; cursor: pointer; flex: 1; padding: 0.5rem;">\n              Game 1 (Flowers)\n            </button>\n            <button id="exampleGame2" style="background: var(--bg-color-emerald-700); border-radius: 0.25rem; border: none; color: white; cursor: pointer; flex: 1; padding: 0.5rem;">\n              Game 2 (Gateway)\n            </button>\n            <button id="exampleGame3" style="background: var(--bg-color-emerald-700); border-radius: 0.25rem; border: none; color: white; cursor: pointer; flex: 1; padding: 0.5rem;">\n              Game 3 (Caves)\n            </button>\n            <button id="exampleGame4" style="background: var(--bg-color-emerald-700); border-radius: 0.25rem; border: none; color: white; cursor: pointer; flex: 1; padding: 0.5rem;">\n              Game 4 (Garden)\n            </button>\n          </div>\n        </div>\n        <div style="display: flex; flex-direction: column; gap: 0.625rem;">\n          <h4 style="margin: 0">Custom URL</h4>\n          <input type="url" id="saveUrlInput" placeholder="https://example.com/save.bgs" style="border-radius: 0.25rem; border: 0.0625rem solid var(--bg-color-gray-500); padding: 0.5rem;" />\n          <button id="loadUrlBtn" style="background: var(--bg-color-blue-500); border-radius: 0.25rem; border: none; color: white; cursor: pointer; padding: 0.5rem 0.9375rem;">\n            Load\n          </button>\n        </div>\n      </div>\n    ',this.shadow.append(e),this.dialog=e;e.querySelector("#closeUrlDialog").addEventListener("click",this.close);e.querySelector("#exampleGame1").addEventListener("click",()=>{e.querySelector("#saveUrlInput").value="https://kherrick.github.io/block-garden/assets/game-saves/Flowers.pdf"});e.querySelector("#exampleGame2").addEventListener("click",()=>{e.querySelector("#saveUrlInput").value="https://kherrick.github.io/block-garden/assets/game-saves/Gateway-To-The-Clouds.pdf"});e.querySelector("#exampleGame3").addEventListener("click",()=>{e.querySelector("#saveUrlInput").value="https://kherrick.github.io/block-garden/assets/game-saves/Caves.pdf"});e.querySelector("#exampleGame4").addEventListener("click",()=>{e.querySelector("#saveUrlInput").value="https://kherrick.github.io/block-garden/assets/game-saves/The-Garden.pdf"});e.querySelector("#loadUrlBtn").addEventListener("click",this.handleLoad);return e.querySelector("#saveUrlInput").addEventListener("keydown",e=>{e instanceof KeyboardEvent&&"Enter"===e.key&&this.handleLoad()}),e}async handleLoad(){const e=this.dialog.querySelector("#saveUrlInput").value.trim();if(!e)return void P(this.shadow,"Please enter a valid URL.");const t=this.dialog.querySelector("#loadUrlBtn");t.disabled=!0,t.textContent="Loading...";try{const t=await fetch(e);if(!t.ok)throw new Error(`Failed to fetch from URL: ${t.statusText}`);const n=await t.blob(),o=e.split("/").pop()||"save.bgs",r=await z(n,o,this.gThis),i=JSON.parse(r);if(await N(this.gThis,this.shadow,i))P(this.shadow,"Game loaded successfully from URL!"),this.close();else{P(this.shadow,"Oops! This URL save state appears to be broken. Use a valid game save file!",{stack:!0,useSingle:!1,duration:5e3});const e=this.dialog.querySelector("#loadUrlBtn");e&&(e.disabled=!1,e.textContent="Load")}}catch(e){console.error("Failed to load game from URL:",e),P(this.shadow,`Error: ${e.message}`);const t=this.dialog.querySelector("#loadUrlBtn");t&&(t.disabled=!1,t.textContent="Load")}}show(){this.dialog instanceof HTMLDialogElement&&(this.doc.pointerLockElement&&this.doc.exitPointerLock(),globalThis.blockGarden.state.isCanvasActionDisabled=!0,this.dialog.showModal())}close(){this.dialog instanceof HTMLDialogElement&&(this.dialog.close(),this.dialog.remove(),setTimeout(()=>{globalThis.blockGarden.state.isCanvasActionDisabled=!1},500))}}class Qo{constructor(e,t,n){this.gThis=e,this.doc=t,this.shadow=n,this.dialog=null,this.params=[],this.close=this.close.bind(this),this.save=this.save.bind(this),this.addParam=this.addParam.bind(this)}async createDialog(){this.dialog&&this.dialog.remove();const e=this.doc.createElement("dialog");e.setAttribute("id","linkConfigDialog"),e.style.cssText="\n      background: var(--bg-color-gray-50);\n      border-radius: 0.5rem;\n      border: 0.125rem solid var(--bg-color-gray-900);\n      color: var(--bg-color-gray-900);\n      font-family: monospace;\n      max-width: 31.25rem;\n      padding: 1.25rem;\n      width: 90%;\n    ";const t=this.gThis.blockGarden.state.armedLinkConfig.get(),n=t.worldName||"";this.params=Object.entries(t.params||{}).map(([e,t])=>({key:e,value:t})),e.innerHTML=`\n      <div style="align-items: center; display: flex; justify-content: space-between; margin-bottom: 0.9375rem;">\n        <h3 style="margin: 0">Configure Link Block</h3>\n        <button id="closeLinkConfigDialog" style="background: var(--bg-color-red-500); border-radius: 0.25rem; border: none; color: white; cursor: pointer; padding: 0.3125rem 0.625rem;">\n          &times;\n        </button>\n      </div>\n      <div style="display: flex; flex-direction: column; gap: 0.9375rem;">\n        <div style="display: flex; flex-direction: column; gap: 0.3125rem;">\n          <label style="font-weight: bold;">Target World Name:</label>\n          <input type="text" id="targetWorldName" value="${n}" placeholder="e.g. Gateway To The Clouds" required pattern="[A-Za-z0-9 \\-]+" style="border-radius: 0.25rem; border: 0.0625rem solid var(--bg-color-gray-500); padding: 0.5rem;" />\n          <small style="color: var(--bg-color-gray-800);">Will load: https://kherrick.github.io/block-garden/assets/game-saves/<span id="previewFilename">${X(n)}.pdf</span></small>\n        </div>\n\n        <div style="display: flex; flex-wrap: wrap; gap: 0.5rem; margin-bottom: 0.5rem;">\n          ${["Gateway To The Clouds","Flowers","Caves","The Garden"].map(e=>`\n            <button class="quickSelectBtn" data-name="${e}" style="background: var(--bg-color-blue-500); border-radius: 0.25rem; border: none; color: white; cursor: pointer; padding: 0.4rem 0.8rem; font-size: 0.75rem; transition: background 0.2s, transform 0.1s; font-weight: bold; box-shadow: 0 0.125rem 0.25rem rgba(0,0,0,0.1);">\n              ${e}\n            </button>\n          `).join("")}\n        </div>\n\n        <div>\n          <label style="font-weight: bold;">GET Parameters:</label>\n          <div id="paramsList" style="display: flex; flex-direction: column; gap: 0.3125rem; margin-top: 0.3125rem;">\n            \x3c!-- Params will be added here --\x3e\n          </div>\n          <small style="color: var(--bg-color-gray-800);">example params: x=100, y=100, z=100, pitch=-1.5, yaw=0, flying=true</span></small>\n          <button id="addParamBtn" style="background: var(--bg-color-blue-500); border-radius: 0.25rem; border: none; color: white; cursor: pointer; margin-top: 0.625rem; padding: 0.3125rem 0.625rem; font-size: 0.75rem;">\n            + Add parameter\n          </button>\n        </div>\n\n        <button id="saveLinkConfigBtn" ${n?"":"disabled"} style="background: ${n?"var(--bg-color-green-500)":"var(--bg-color-gray-500)"}; border-radius: 0.25rem; border: none; color: white; cursor: ${n?"pointer":"not-allowed"}; margin-top: 0.625rem; padding: 0.625rem; font-weight: bold; opacity: ${n?"1":"0.6"}; transition: all 0.2s;">\n          Save & Arm Link Block\n        </button>\n      </div>\n    `,this.shadow.append(e),this.dialog=e;e.querySelector("#closeLinkConfigDialog").addEventListener("click",this.close);const o=e.querySelector("#saveLinkConfigBtn");o.addEventListener("click",this.save);e.querySelector("#addParamBtn").addEventListener("click",this.addParam);const r=e.querySelector("#targetWorldName"),i=e.querySelector("#previewFilename"),a=()=>{const e=r.checkValidity()&&r.value.trim().length>0;o.disabled=!e,o.style.background=e?"var(--bg-color-green-500)":"var(--bg-color-gray-500)",o.style.cursor=e?"pointer":"not-allowed",o.style.opacity=e?"1":"0.6",r.style.borderColor=r.checkValidity()?"var(--bg-color-gray-500)":"var(--bg-color-red-500)"};r.addEventListener("input",e=>{const t=e.target.value;i.textContent=X(t)+".pdf",a()});return e.querySelectorAll(".quickSelectBtn").forEach(e=>{e.addEventListener("click",()=>{const t=e.getAttribute("data-name");r.value=t,i.textContent=X(t)+".pdf",a()}),e.addEventListener("mouseenter",()=>{e.style.background="var(--bg-color-blue-700)"}),e.addEventListener("mouseleave",()=>{e.style.background="var(--bg-color-blue-500)"}),e.addEventListener("mousedown",()=>{e.style.transform="scale(0.95)"}),e.addEventListener("mouseup",()=>{e.style.transform="scale(1)"})}),this.renderParams(),e}renderParams(){const e=this.dialog.querySelector("#paramsList");e.innerHTML="",this.params.forEach((t,n)=>{const o=this.doc.createElement("div");o.style.display="flex",o.style.gap="0.3125rem";const r=this.doc.createElement("input");r.type="text",r.placeholder="key",r.value=t.key,r.style.flex="1",r.style.padding="0.25rem",r.style.borderRadius="0.25rem",r.style.border="1px solid var(--bg-color-gray-500)",r.addEventListener("input",e=>this.params[n].key=e.target.value);const i=this.doc.createElement("input");i.type="text",i.placeholder="value",i.value=t.value,i.style.flex="1",i.style.padding="0.25rem",i.style.borderRadius="0.25rem",i.style.border="1px solid var(--bg-color-gray-500)",i.addEventListener("input",e=>this.params[n].value=e.target.value);const a=this.doc.createElement("button");a.innerHTML="&times;",a.style.background="var(--bg-color-red-500)",a.style.color="white",a.style.border="none",a.style.borderRadius="0.125rem",a.style.cursor="pointer",a.style.padding="0 0.5rem",a.addEventListener("click",()=>{this.params.splice(n,1),this.renderParams()}),o.append(r,i,a),e.append(o)})}addParam(){this.params.push({key:"",value:""}),this.renderParams()}save(){const e=this.dialog.querySelector("#targetWorldName").value.trim();if(!e)return void alert("Please enter a target world name.");const t={};this.params.forEach(e=>{e.key.trim()&&(t[e.key.trim()]=e.value.trim())}),this.gThis.blockGarden.state.armedLinkConfig.set({worldName:e,params:t}),Promise.resolve().then(function(){return j}).then(({showToast:t})=>{t(this.shadow,`Link block armed for "${e}"!`)}),this.close()}show(){this.dialog instanceof HTMLDialogElement&&(this.doc.pointerLockElement&&this.doc.exitPointerLock(),this.gThis.blockGarden.state.isCanvasActionDisabled=!0,this.dialog.showModal())}close(){this.dialog instanceof HTMLDialogElement&&(this.dialog.close(),this.dialog.remove(),setTimeout(()=>{this.gThis.blockGarden.state.isCanvasActionDisabled=!1},500))}}function qo(e,t){const n=e.getElementById("canvas");if(n instanceof HTMLCanvasElement){const o=t.get();if("fullscreen"===o)return e.host.classList.remove("resolution","resolution-400","resolution-600","resolution-800"),n.width=globalThis.innerWidth,n.height=globalThis.innerHeight,n.style.width="100vw",n.style.width="100dvw",n.style.height="100vh",void(n.style.height="100dvh");e.host.classList.add("resolution"),e.host.classList.remove("resolution-400","resolution-600","resolution-800");const r=parseInt(o);n.width=r,n.height=r,n.style.width=r+"px",n.style.height=r+"px",e.host.classList.add(`resolution-${r}`)}}class $o{constructor(e,t,n){this.gThis=e,this.doc=t,this.shadow=n,this.dialog=null,this.isOpen=!1,this.blockColors={},this.initBlockColors()}async initBlockColors(){try{const e=await Promise.resolve().then(function(){return oe});this.blockColors=e.colors.block||{}}catch(e){console.error("Failed to load block colors",e)}}async createDialog(){if(this.dialog)return this.dialog;const e=this.doc.createElement("dialog");e.setAttribute("id","inventoryDialog"),e.style.cssText="\n      background: var(--bg-color-gray-800);\n      border-radius: 0.5rem;\n      border: 0.125rem solid var(--bg-color-gray-900);\n      color: var(--bg-color-white);\n      font-family: monospace;\n      max-height: 80vh;\n      max-width: 50rem;\n      overflow-y: auto;\n      padding: 1.25rem;\n      width: 90%;\n      z-index: 10000;\n    ",e.innerHTML='\n      <style>\n        .inventory-slot {\n          align-items: center;\n          background-color: rgba(0, 0, 0, 0.3);\n          border-radius: 0.25rem;\n          cursor: pointer;\n          display: flex;\n          flex-direction: column;\n          gap: 0.5rem;\n          justify-content: center;\n          padding: 0.5rem;\n          transition: all 0.2s;\n        }\n\n        .inventory-slot:hover {\n          background-color: rgba(255, 255, 255, 0.1);\n          transform: translateY(-0.25rem);\n        }\n\n        .inventory-slot-cube {\n          height: 2rem;\n          perspective: 62.5rem;\n          position: relative;\n          transform-style: preserve-3d;\n          transform: rotateX(20deg) rotateY(-30deg);\n          width: 2rem;\n        }\n\n        .cube-face {\n          border: 0.0625rem solid rgba(0, 0, 0, 0.3);\n          height: 2rem;\n          position: absolute;\n          width: 2rem;\n        }\n\n        .cube-front {\n          transform: translateZ(1rem);\n        }\n\n        .cube-top {\n          filter: brightness(1.2);\n          transform: rotateX(90deg) translateZ(1rem);\n        }\n\n        .cube-right {\n            filter: brightness(0.8);\n            transform: rotateY(90deg) translateZ(1rem);\n        }\n\n        .inventory-slot-name {\n          color: var(--bg-color-white);\n          font-size: 0.625rem;\n          line-height: 1;\n          max-width: 3rem;\n          text-align: center;\n          text-shadow: 0 0 2px black;\n          word-break: break-word;\n        }\n      </style>\n      <div style="display: flex; justify-content: space-between; margin-bottom: 1rem;">\n        <h3 style="margin: 0">Material Inventory</h3>\n        <button id="closeInventoryDialog" style="background: var(--bg-color-red-500); border: none; color: white; border-radius: 0.25rem; cursor: pointer; padding: 0.25rem 0.5rem;">&times;</button>\n      </div>\n      <div id="inventoryGrid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(4rem, 1fr)); gap: 0.5rem;">\n        \x3c!-- Blocks will be populated here --\x3e\n      </div>\n    ',this.shadow.append(e),this.dialog=e,this.renderInventory();return e.querySelector("#closeInventoryDialog").addEventListener("click",()=>this.close()),e.addEventListener("cancel",()=>this.close()),e}renderInventory(){const e=this.dialog.querySelector("#inventoryGrid"),t=wt.blocks;e.innerHTML=t.filter(e=>"Air"!==e.name).map(e=>{const t=e.name.toLowerCase().replace(/ /g,"-"),n=this.blockColors[t]||"var(--bg-color-gray-500)";return`\n         <div\n            class="inventory-slot"\n            data-id="${Lt(e.name)}"\n            title="${e.name}"\n         >\n            <div class="inventory-slot-cube">\n              <div class="cube-face cube-front" style="background-color: ${n};"></div>\n              <div class="cube-face cube-top" style="background-color: ${n};"></div>\n              <div class="cube-face cube-right" style="background-color: ${n};"></div>\n            </div>\n            <div class="inventory-slot-name">${e.name}</div>\n         </div>\n       `}).join(""),e.querySelectorAll(".inventory-slot").forEach(e=>{e.addEventListener("click",e=>{const t=e.currentTarget instanceof HTMLElement?e.currentTarget:null;if(t){const e=Number(t.dataset.id);this.handleBlockClick(e)}})})}handleBlockClick(e){Go(e),this.close()}handleClose(){setTimeout(()=>{globalThis.blockGarden.state.isCanvasActionDisabled=!1,this.dialog.removeEventListener("close",this.handleClose.bind(this))},500)}open(){this.dialog||this.createDialog(),this.dialog.showModal(),this.isOpen=!0,this.doc.pointerLockElement&&this.doc.exitPointerLock(),globalThis.blockGarden.state.isCanvasActionDisabled=!0,this.dialog.addEventListener("close",this.handleClose.bind(this))}close(){this.dialog&&this.dialog.close(),this.isOpen=!1}toggle(){this.isOpen?this.close():this.open()}}const er=e=>Se.find(t=>t.name===e)?.id??-1;function tr(e,t){if(e.style.color="var(--bg-color-white)",t)return e.textContent=" Disable Flight",void(e.style.backgroundColor="var(--bg-color-red-500)");e.textContent=" Enable Flight",e.style.backgroundColor="var(--bg-color-green-500)"}let nr=0;function or(e,t,n){const o=globalThis.blockGarden.state,r=e.host,i=new $o(globalThis,globalThis.document,e);new Vo(t=>{e.getElementById("examplesBtnContainer").removeAttribute("hidden"),e.getElementById("fastGrowthButton").removeAttribute("hidden"),e.getElementById("gameSaveLinkingButton").removeAttribute("hidden"),e.getElementById("randomPlantButton").removeAttribute("hidden"),e.getElementById("toggleAODebug").removeAttribute("hidden"),e.getElementById("customizeColorsBtnContainer").removeAttribute("hidden"),e.querySelector('block-garden-option[value="fullscreen"]').removeAttribute("hidden");const n=e.getElementById("customizeColorsDialog");n&&n.querySelectorAll("[hidden]").forEach(e=>e.removeAttribute("hidden"));e.querySelector('#settings > [class="ui-grid__corner--container"]').removeAttribute("hidden"),o.hasEnabledExtras.set(!0),t.disable()}),function(e){const t=globalThis.blockGarden.config,n=[{id:"viewRadius",signal:t.viewRadius},{id:"cacheRadius",signal:t.cacheRadius},{id:"renderRadius",signal:t.renderRadius},{id:"worldRadius",signal:t.worldRadius}];n.forEach(({id:t,signal:n})=>{const o=e.getElementById(`${t}Input`),r=e.getElementById(`${t}Display`);o instanceof HTMLInputElement&&r&&(zo(()=>{const e=n.get();o.value=String(e),r.textContent=String(null===e||e>2048?"":e)}),o.addEventListener("input",e=>{e.target instanceof HTMLInputElement&&n.set(parseInt(e.target.value,10))}))})}(e),function(e){const t=globalThis.blockGarden.config,n=[{id:"terrainOctaves",signal:t.terrainOctaves,unit:""},{id:"mountainScale",signal:t.mountainScale,unit:"%"},{id:"caveThreshold",signal:t.caveThreshold,unit:"%",displayId:"caveDensity"},{id:"decorationDensity",signal:t.decorationDensity,unit:"%"},{id:"cloudDensity",signal:t.cloudDensity,unit:"%"}];n.forEach(({id:t,signal:n,unit:o,displayId:r})=>{const i=e.getElementById(`${t}Input`),a=e.getElementById(`${r||t}Display`);i instanceof HTMLInputElement&&a&&(zo(()=>{const e=n.get();i.value=String(e),a.textContent=`${e}${o}`}),i.addEventListener("input",e=>{e.target instanceof HTMLInputElement&&n.set(parseInt(e.target.value,10))}))});const o=e.getElementById("toggleCaves"),r=e.getElementById("caveThresholdInput"),i=e.getElementById("caveThresholdInputContainer");o&&(zo(()=>{const e=t.useCaves.get();o.textContent=e?"Disable Caves":"Enable Caves",o.style.backgroundColor=e?"var(--bg-color-red-500)":"var(--bg-color-green-500)",o.style.color="var(--bg-color-white)",e?(r.removeAttribute("disabled"),i.removeAttribute("hidden")):(r.setAttribute("disabled","disabled"),i.setAttribute("hidden","hidden"))}),o.addEventListener("click",()=>{const e=t.useCaves.get();t.useCaves.set(!e),e?(r.removeAttribute("disabled"),i.removeAttribute("hidden")):(r.setAttribute("disabled","disabled"),i.setAttribute("hidden","hidden"))}));const a=e.getElementById("applyLowDetailPreset");a&&a.addEventListener("click",()=>{t.terrainOctaves.set(1),t.mountainScale.set(0),t.decorationDensity.set(10),t.caveThreshold.set(100),t.useCaves.set(!1),t.cloudDensity.set(0),t.useTextureAtlas.set(!1),t.useAmbientOcclusion.set(!1),t.useDynamicLighting.set(!1),P(e,"Applied Low Detail Preset")})}(e);const a=e.querySelector("#material .ui-grid__corner--heading");a.addEventListener("click",t=>{e.getElementById("materialBar").toggleAttribute("hidden"),e.getElementById("materialBar").hasAttribute("hidden")?a.textContent=" Material":a.textContent=" Material"});const l=e.getElementById("fastGrowthButton");l&&l.addEventListener("click",()=>{o.fastGrowth=!o.fastGrowth,l.textContent=o.fastGrowth?"Disable Fast Growth":"Enable Fast Growth",l.style.backgroundColor=o.fastGrowth?"var(--bg-color-red-500)":"var(--bg-color-green-500)",l.style.color="var(--bg-color-white)",e.dispatchEvent(new CustomEvent("block-garden-reset"))});const s=e.getElementById("gameSaveLinkingButton");if(s){const e=globalThis.blockGarden.config;s.addEventListener("click",()=>{const t=!e.linkGameSave.get();e.linkGameSave.set(t),s.textContent=t?"Disable Game Save Linking":"Enable Game Save Linking",s.style.backgroundColor=t?"var(--bg-color-red-500)":"var(--bg-color-green-500)",s.style.color="var(--bg-color-white)"})}const c=e.getElementById("toggleSplitControls");if(c){const e=globalThis.blockGarden.config;c.addEventListener("click",()=>{e.useSplitControls.set(!e.useSplitControls.get())}),zo(()=>{const t=e.useSplitControls.get();c.textContent=t?"Disable Split Controls":"Enable Split Controls",c.style.backgroundColor=t?"var(--bg-color-red-500)":"var(--bg-color-green-500)",c.style.color="var(--bg-color-white)"})}const d=e.querySelector("#toggleFlight");d&&(d.addEventListener("click",()=>{const e=o.flying.get();o.flying.set(!e)}),zo(()=>{tr(d,o.flying.get())}));const g=e.getElementById("configureLinkBlock");g&&g.addEventListener("click",()=>{!async function(e,t,n){const o=new Qo(e,t,n);await o.createDialog(),o.show()}(globalThis,globalThis.document,e)});const u=globalThis.blockGarden.config,I=(t,n,o)=>{const r=e.getElementById(t);if(r){const e=()=>{const e=n.get();r.textContent=e?`Disable ${o}`:`Enable ${o}`,r.style.backgroundColor=e?"var(--bg-color-red-500)":"var(--bg-color-green-500)",r.style.color="var(--bg-color-white)"};zo(()=>{e()}),r.addEventListener("click",()=>{n.set(!n.get())})}};I("toggleTextures",u.useTextureAtlas,"Textures"),I("toggleAO",u.useAmbientOcclusion,"Ambient Occlusion"),I("toggleDynamicLighting",u.useDynamicLighting,"Light Cycle"),I("togglePerFaceLighting",u.usePerFaceLighting,"Per-Face Lighting"),I("toggleAODebug",u.useAODebug,"AO Debug");const h=e.getElementById("randomPlantButton");function b(){return()=>{i.toggle()}}h&&h.addEventListener("click",()=>{Y(),P(e,"Random planting at complete!")});const C=e.querySelector('[data-key="e"]');C.addEventListener("click",b()),C.addEventListener("touchstart",b()),e.addEventListener("keyup",e=>{e.key&&(r.keys[e.key.toLowerCase()]=!1,e.target instanceof HTMLInputElement||e.target instanceof HTMLTextAreaElement||e.target instanceof HTMLSelectElement||e.preventDefault())});const A=e.getElementById("closeWorldGeneration");A&&A.addEventListener("click",()=>{e.querySelector('[class="seed-controls"]').setAttribute("hidden","hidden"),setTimeout(()=>{globalThis.blockGarden.state.isCanvasActionDisabled=!1},500)});const v=e.getElementById("aboutBtn");v&&v.addEventListener("click",async function(){try{await async function(e,t){const n=new Uo(e,t);return await n.createDialog("about"),n.show(),n}(globalThis.document,e)}catch(e){console.error("Failed to open about dialog:",e),alert("Failed to open about dialog. Check console for details.")}});const y=e.getElementById("examplesBtn");y&&y.addEventListener("click",async function(){try{await async function(e,t){const n=new Ho(e,t);return await n.createDialog("examples","src/api"),n.show(),n}(globalThis.document,e)}catch(e){console.error("Failed to open examples dialog:",e),alert("Failed to open examples dialog. Check console for details.")}});const w=e.getElementById("privacyBtn");w&&w.addEventListener("click",async function(){try{await async function(e,t){const n=new _o(e,t);return await n.createDialog("privacy"),n.show(),n}(globalThis.document,e)}catch(e){console.error("Failed to open privacy dialog:",e),alert("Failed to open privacy dialog. Check console for details.")}});const k=e.getElementById("customizeColorsBtn");if(k){const t=globalThis.blockGarden.config;k.addEventListener("click",async()=>{const n=t.currentResolution.get();if("400"===n){t.currentResolution.set("800"),qo(e,t.currentResolution);return void(await Po(globalThis)).dialog.addEventListener("close",()=>{t.currentResolution.set(n),qo(e,t.currentResolution)})}await Po(globalThis)})}globalThis.addEventListener("blur",()=>{Object.keys(r.keys).forEach(e=>{r.keys[e]=!1})}),e.addEventListener("keydown",async t=>{if(!t.key)return;const n=t.key.toLowerCase();e.host.keys[n]=!0;const r=t.target instanceof HTMLInputElement||t.target instanceof HTMLTextAreaElement||t.target instanceof HTMLSelectElement;if("escape"===n){const t=e.querySelector('[class="seed-controls"]');if(!t.hasAttribute("hidden"))return t.setAttribute("hidden","hidden"),void setTimeout(()=>{globalThis.blockGarden.state.isCanvasActionDisabled=!1},500)}if("s"===n&&t.ctrlKey){t.preventDefault();const n=e.querySelector('[class="seed-controls"]');return n.toggleAttribute("hidden"),n.hasAttribute("hidden")?setTimeout(()=>{globalThis.blockGarden.state.isCanvasActionDisabled=!1},500):globalThis.blockGarden.state.isCanvasActionDisabled=!0,void globalThis.document.exitPointerLock()}if("enter"===n&&t.target instanceof HTMLInputElement&&"worldSeedInput"===t.target.getAttribute("id"))Z();else if(!r&&!globalThis.blockGarden.state.isCanvasActionDisabled&&"backspace"!==n&&"delete"!==n&&"escape"!==n){if("e"===n)return t.preventDefault(),void i.toggle();if(n>="1"&&n<="9")return t.preventDefault(),void wo(parseInt(n)-1);if(("`"===n||"~"===n)&&(t.preventDefault(),"Backquote"===t.code||"Accent"===t.code)){const e=function(e,t,n){const o=t.findIndex(t=>t.id===e),r=t.length;return t[n?o===r-1?1:o+1:1===o?r-1:o-1].id}(o.curBlock.get(),wt.blocks,!t.shiftKey);o.curBlock.set(e),Go(e)}}});const S=e.getElementById("resolutionSelect");S&&S.addEventListener("change",t=>{wt.currentResolution.set(t.detail.value),qo(e,wt.currentResolution)}),e.addEventListener("mousemove",n=>{if(e.pointerLockElement===t||e.pointerLockElement===e.host||globalThis.document.pointerLockElement===t||globalThis.document.pointerLockElement===e.host){o.yaw-=.0025*n.movementX;const e=Math.PI/2-.01;o.pitch=Math.max(-e,Math.min(e,o.pitch-.0025*n.movementY))}}),e.addEventListener("touchstart",t=>{nr=Date.now(),(t.target instanceof HTMLDivElement&&t.target.closest(".touch-controls")||t.target===e.getElementById("canvas"))&&t.cancelable&&t.preventDefault()},{passive:!1}),e.addEventListener("touchmove",t=>{nr=Date.now(),(t.target instanceof HTMLDivElement&&t.target.closest(".touch-controls")||t.target===e.getElementById("canvas"))&&t.cancelable&&t.preventDefault()},{passive:!1}),e.addEventListener("touchend",t=>{nr=Date.now(),(t.target instanceof HTMLDivElement&&t.target.closest(".touch-controls")||t.target===e.getElementById("canvas"))&&t.cancelable&&t.preventDefault()},{passive:!1}),e.addEventListener("contextmenu",t=>{(t.target instanceof HTMLDivElement&&t.target.closest(".touch-controls")||t.target===e.getElementById("canvas"))&&t.preventDefault()}),t.addEventListener("mousedown",e=>{if(Date.now()-nr<1e3)return;const n=globalThis.blockGarden.state,o=globalThis.blockGarden.config;let r=n.hit;if(!o.useSplitControls.get()){const o=n.y-n.playerHeight/2+1.62,{hit:i}=Fo(t,e.clientX,e.clientY,n.world,{x:n.x,y:o,z:n.z},{yaw:n.yaw,pitch:n.pitch});r=i}2===e.button&&ze(n,r)}),e.addEventListener("dblclick",t=>{(t.target instanceof HTMLDivElement&&t.target.closest(".touch-controls")||t.target===e.getElementById("canvas"))&&t.preventDefault()});function Z(){let t=null;const n=e.getElementById("worldSeedInput");n instanceof HTMLInputElement&&(t=n.value);const o=e.getElementById("currentSeed"),r=Number(t);p(r)&&!isNaN(r)?r<1||r>Number.MAX_SAFE_INTEGER?P(e,`Seed must be between 1 and ${Number.MAX_SAFE_INTEGER}.`):(jo(r,globalThis.blockGarden.state),console.log(`Generated new world with seed: ${r}`),o.textContent=String(r)):P(e,"Invalid seed. Please enter a number.")}e.getElementById("worldState").addEventListener("click",function(){const t=e.querySelector('[class="seed-controls"]');t.toggleAttribute("hidden"),t.hasAttribute("hidden")?setTimeout(()=>{globalThis.blockGarden.state.isCanvasActionDisabled=!1},500):globalThis.blockGarden.state.isCanvasActionDisabled=!0});e.getElementById("generateWithSeed").addEventListener("click",Z);e.getElementById("randomSeed").addEventListener("click",function(){const t=e.getElementById("currentSeed"),n=e.getElementById("worldSeedInput"),o=mo();n instanceof HTMLInputElement&&(n.value=String(o)),t.textContent=String(o),jo(o,globalThis.blockGarden.state),console.log(`Generated new world with random seed: ${o}`)});e.getElementById("copySeed").addEventListener("click",async function(){const t=e.getElementById("worldSeedInput");t instanceof HTMLInputElement&&(await async function(e,t){const n=e.navigator;if(n.clipboard&&e.isSecureContext)try{await n.clipboard.writeText(t)}catch(e){}}(globalThis,t.value),P(e,`Game seed, ${t.value}, has been copied successfully`))});const W=e.getElementById("saveModeToggle");_().then(async e=>{const t="auto"===e?"auto":"manual";if(console.log("Save Mode:",t),"auto"===t)return W.innerText="Save Mode Auto",void(W.style.backgroundColor="var(--bg-color-green-500)");W.innerText="Save Mode Manual",W.style.backgroundColor="var(--bg-color-red-500)"}),W.addEventListener("click",async function(){const e="auto"===await _()?"auto":"manual";if("manual"===e)return W.innerText="Save Mode Auto",W.style.backgroundColor="var(--bg-color-green-500)",await K("auto"),void await q(globalThis);"auto"===e&&(W.innerText="Save Mode Manual",W.style.backgroundColor="var(--bg-color-red-500)",await K("manual"))});e.getElementById("saveExternalGameFile").addEventListener("click",async function(){try{const e=m(globalThis.blockGarden.state.world),t=JSON.stringify(e);await V(globalThis,t),console.log("Game state saved successfully")}catch(e){console.error("Failed to save game state:",e),alert("Failed to save game state. Check console for details.")}});e.getElementById("loadExternalGameFile").addEventListener("click",async function(){let t;if(e.getElementById("currentSeed"),e.getElementById("worldSeedInput"),globalThis.showOpenFilePicker){const[e]=await globalThis.showOpenFilePicker({types:[{description:"Block Garden Save Game Files",accept:{"application/gzip":[".bgs"],"application/pdf":[".pdf"],"text/plain":[".txt"]}}]});t=await e.getFile()}else{const n=globalThis.document.createElement("input");n.type="file",n.accept=".bgs,.pdf,.txt,text/plain,application/pdf,application/gzip,application/*",n.style.display="none",e.append(n);const o=new Promise(e=>{n.onchange=()=>e(n.files[0])});n.click(),t=await o,e.removeChild(n)}try{const n=await z(t,t.name,globalThis),o=JSON.parse(n);await N(globalThis,e,o)||(P(e,"Oops! This save state appears to be broken. Loading a new world...",{stack:!0,useSingle:!1,duration:5e3}),Oo(globalThis.blockGarden.state.seed))}catch(t){console.error("Failed to load external game file:",t),P(e,"Oops! Failed to load file. Loading a new world...",{stack:!0,useSingle:!1,duration:5e3}),Oo(globalThis.blockGarden.state.seed)}});let L=!1;const R=e.getElementById("shareExternalGameFile");if("undefined"!=typeof navigator&&void 0!==navigator.canShare)try{L=navigator.canShare({files:[new File([],"test")]})}catch(e){console.info(`File sharing is not enabled. ${JSON.stringify(e)}`)}L&&(e.querySelectorAll(".seed-controls--share").forEach(e=>e.removeAttribute("hidden")),R.addEventListener("click",async function(){try{let t;if(globalThis.showOpenFilePicker){const[e]=await globalThis.showOpenFilePicker({types:[{description:"Block Garden Save Game Files",accept:{"application/octet-stream":[".bgs"],"application/pdf":[".pdf"],"text/plain":[".txt"]}},{description:"All files (*.*)",accept:{"*/*":[]}}],excludeAcceptAllOption:!1});t=await e.getFile()}else{const n=globalThis.document.createElement("input");n.type="file",n.multiple=!1,n.style.display="none",n.accept=".bgs,.pdf,.txt,application/octet-stream,application/pdf,text/plain,*/*",e.appendChild(n);const o=new Promise((e,t)=>{n.onchange=()=>{n.files&&n.files[0]?e(n.files[0]):t(new DOMException("No file selected","AbortError"))},n.onerror=()=>t(new Error("File input failed"))});n.click(),t=await o,e.removeChild(n)}let n,o="{}";if(t.name.toLowerCase().endsWith(".txt"))o=(await t.text()).replace(/\s+/g,"");else if(t.name.toLowerCase().endsWith(".pdf")){const[e]=await f(t);o=await G(new Blob([e.data]))}else{if(!t.name.toLowerCase().endsWith(".bgs"))throw new Error(`Unsupported file type: ${t.name}`);{const e=t.stream().pipeThrough(new globalThis.DecompressionStream("gzip")),n=await new globalThis.Response(e).blob();o=await n.text()}}try{n=JSON.parse(o)}catch(e){throw new Error("Invalid game state file: not valid JSON.")}const r=new File([o],`BlockGarden-${t.name.replace(/\.[^.]+$/,"")}-save.json.txt`,{type:"text/plain",lastModified:Date.now()});if(navigator.canShare&&navigator.canShare({files:[r]}))await navigator.share({files:[r],title:"Block Garden Game Save",text:`Block Garden save from ${t.name}\nVisit https://kherrick.github.io/block-garden and click 'Load' to play!`,url:"https://kherrick.github.io/block-garden"}),console.log("Game state shared successfully");else{const e=URL.createObjectURL(r),t=document.createElement("a");t.href=e,t.download=r.name,document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(e),console.log("Game state downloaded:",r.name)}}catch(e){"AbortError"!==e.name?(console.error("Share failed:",e),alert(`Share failed: ${e.message}`)):console.log("User cancelled file selection")}}));const B=e.getElementById("openStorageBtn");B&&B.addEventListener("click",async function(){try{await async function(e,t,n){const o=new te(e,t,n);return await o.createDialog(),o.show(),o}(globalThis,globalThis.document,e)}catch(e){console.error("Failed to open storage dialog:",e),alert("Failed to open storage dialog. Check console for details.")}});const x=e.getElementById("loadExternalGameUrl");x&&x.addEventListener("click",async function(){try{await async function(e,t,n){const o=new Ko(e,t,n);return await o.createDialog(),o.show(),o}(globalThis,globalThis.document,e)}catch(e){console.error("Failed to open URL dialog:",e),alert("Failed to open URL dialog. Check console for details.")}});e.querySelectorAll(".ui-grid__corner").forEach(e=>{e.querySelector(".ui-grid__corner--heading").addEventListener("click",e=>function(e){e.preventDefault(),e.stopPropagation();const t=e.currentTarget;if(t instanceof HTMLDivElement){const e=t.nextElementSibling,n=e?.getAttribute("hidden");if(n&&null!==n)return void e.removeAttribute("hidden");e?.setAttribute("hidden","hidden")}}(e))});const T={TOSS_COUNT:5,TOSS_RADIUS:20,MIN_DISTANCE_FROM_PLAYER:2,BANNED_SURFACES:new Set([er(ye.WATER),er(ye.LAVA)])};function E(e){for(const t of Object.values(Ao))if(t.surfaceBlockId===e)return t;return e===er(ye.CLOUD)?{name:"Clouds",cropBlockIds:Se.filter(e=>e.isSeed).map(e=>e.id)}:null}function M(e,t,n){if(0===t.length)return;const r=t[Math.floor(Math.random()*t.length)],i=We(r);n.set(e,r,!0),o.plantStructures[e]={type:i.name,blocks:[e]},o.growthTimers[e]=o.fastGrowth?30:i.growthTime||10}function Y(){const{world:t}=o,n=Math.floor(o.x),r=Math.floor(o.y),i=Math.floor(o.z),a=new Set;let l=0;for(let e=0;e<T.TOSS_COUNT;e++){const e=Math.random()*Math.PI*2,o=Math.sqrt(Math.random())*T.TOSS_RADIUS;if(o<T.MIN_DISTANCE_FROM_PLAYER)continue;const s=n+Math.round(Math.cos(e)*o),c=i+Math.round(Math.sin(e)*o);for(let e=r+5;e>=0;e--){const n=`${s},${e},${c}`,o=t.get(n);if(void 0===o||o===er(ye.AIR))continue;if(T.BANNED_SURFACES.has(o))break;const r=We(o);if(!r||!r.solid)continue;const i=E(o);if(i&&!a.has(n)){const o=`${s},${e+1},${c}`,r=t.get(o);void 0!==r&&r!==er(ye.AIR)||(M(n,i.cropBlockIds,t),a.add(n),l++)}break}}console.log(`[Interaction] Randomly tossed seeds. Placed ${l} plants.`),o.fastGrowth&&e.dispatchEvent(new CustomEvent("block-garden-reset"))}const X=me(()=>{qo(e,n)},200);new ResizeObserver(e=>{X()}).observe(e.host);const D=e.getElementById("toggleTouchControls");D&&(D.addEventListener("click",()=>{wt.useTouchControls.set(!wt.useTouchControls.get())}),zo(()=>{const e=wt.useTouchControls.get();D.textContent=e?"Disable Touch Controls":"Enable Touch Controls",D.style.backgroundColor=e?"var(--bg-color-red-500)":"var(--bg-color-green-500)",D.style.color="var(--bg-color-white)"}))}function rr(e,t){zo(()=>{e.getElementById("blockName").textContent=t.get()}),zo(()=>{const t=e.querySelector(".touch-controls");t&&wt.useTouchControls.get()?t.removeAttribute("hidden"):t.setAttribute("hidden","")}),zo(()=>{const t=e.getElementById("toggleFlight"),n=e.getElementById("fly"),o=e.getElementById("descend");if(t&&n&&o){const e=ko.flying.get();e?(o.removeAttribute("hidden"),n.removeAttribute("hidden")):(o.setAttribute("hidden","hidden"),n.setAttribute("hidden","hidden")),tr(t,e)}}),zo(()=>{const t=e.getElementById("worldSeedInput");if(t instanceof HTMLInputElement&&!t.value){const n=e.getElementById("currentSeed"),o=globalThis.blockGarden.state.seed;if(n&&o)return t.value=o,void(n.textContent=o);const r=String(mo());t.value=r,n.textContent=r}})}function ir(e,t,n){const o=e.createShader(t);return e.shaderSource(o,n),e.compileShader(o),e.getShaderParameter(o,e.COMPILE_STATUS)||console.error(e.getShaderInfoLog(o)),o}function ar(e,t,n,o=3){const r=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,r),e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW),e.enableVertexAttribArray(n),e.vertexAttribPointer(n,o,e.FLOAT,!1,0,0)}function lr(e){const t=16,n=document.createElement("canvas");n.width=256,n.height=256;const o=n.getContext("2d");return e.forEach((e,n)=>{if("Air"===e.name)return;const r=e.id||0,i=r%16*t,a=Math.floor(r/16)*t,l=(e=>{const t=e.toLowerCase().replace(/ /g,"-"),n=ne.block[t];if(n&&n.startsWith("var(--bg-color-")){const e=n.replace("var(--bg-color-","").replace(")","");return ne.color[e]||"#ffffff"}return"#ffffff"})(e.name);o.fillStyle=l,o.fillRect(i,a,t,t),o.fillStyle="rgba(0,0,0,0.1)",o.fillRect(i,a,t,1),o.fillRect(i,a,1,t),o.fillStyle="rgba(255,255,255,0.1)",o.fillRect(i+t-1,a,1,t),o.fillRect(i,a+t-1,t,1);for(let e=0;e<4;e++){const n=Math.floor(Math.random()*t),r=Math.floor(Math.random()*t);o.fillStyle=e%2==0?"rgba(0,0,0,0.05)":"rgba(255,255,255,0.05)",o.fillRect(i+n,a+r,2,2)}}),n}function sr(e,t=[]){const n=e.getContext("webgl2",{alpha:!1,preserveDrawingBuffer:!0});if(!n)return void console.error("WebGL 2 not supported.");const o=function(e,t,n){const o=e.createProgram(),r=ir(e,e.VERTEX_SHADER,t),i=ir(e,e.FRAGMENT_SHADER,n);return e.attachShader(o,r),e.attachShader(o,i),e.linkProgram(o),e.useProgram(o),o}(n,"#version 300 es\n    layout(location=0)in vec3 p;\n    layout(location=1)in vec3 n;\n    layout(location=2)in vec4 c;\n    layout(location=3)in vec2 uv;\n    layout(location=4)in float ao;\n    layout(location=5)in vec2 localUV;\n    layout(location=6)in vec4 cornerAO;\n\n    uniform mat4 MVP, M;\n    uniform vec3 L;\n    uniform float uULG; // Use Per-Face Lighting (1.0 or 0.0)\n\n    out vec4 C;\n    out vec2 Vuv;\n    out float Lg;\n    out float Vao;\n    out vec2 VlocalUV;\n    out vec4 VcornerAO;\n\n    void main(){\n      vec3 nn=normalize((M*vec4(n,0)).xyz);\n      float d=max(dot(nn,-L),0.);\n      // Per-face lighting (directional) + ambient term\n      // If uULG is 0, Lg will be 1.0 (flat)\n      Lg = mix(1.0, .2 + d*0.8, uULG);\n      C=c;\n      Vuv=uv;\n      Vao=ao;\n      VlocalUV = localUV;\n      VcornerAO = cornerAO;\n      gl_Position=MVP*vec4(p,1);\n    }",'#version 300 es\n    precision highp float;\n\n    uniform sampler2D T;\n    uniform float uUT;  // Use Texture (1.0 or 0.0)\n    uniform float uUAO; // Use AO (1.0 or 0.0)\n    uniform float uUAOD; // Use AO Debug (1.0 or 0.0)\n\n    in vec4 C;\n    in vec2 Vuv;\n    in float Lg;\n    in float Vao;\n    in vec2 VlocalUV;\n    in vec4 VcornerAO;\n\n    out vec4 o;\n\n    void main(){\n      vec4 texColor = texture(T, Vuv);\n      // Mix texture with vertex color (tinting)\n      // If uUT is 0, texColor is effectively white\n      vec4 baseColor = mix(vec4(1.0), texColor, uUT) * C;\n\n      // Radial AO Calculation using Bilinear Interpolation\n      // VcornerAO contains AO for corners in order: (0,0), (1,0), (1,1), (0,1)\n      // Which maps to XYZW as: [AO(0,0), AO(1,0), AO(1,1), AO(0,1)]\n      // Bilinear: interpolate along y first (vertical edges), then x (horizontal)\n      float aoLeft = mix(VcornerAO.x, VcornerAO.w, VlocalUV.y);   // Left edge: mix (0,0) and (0,1) by y\n      float aoRight = mix(VcornerAO.y, VcornerAO.z, VlocalUV.y);  // Right edge: mix (1,0) and (1,1) by y\n      float aoBilinear = mix(aoLeft, aoRight, VlocalUV.x);       // Final: mix left and right using x\n\n      // Apply a slight radial curve to make it look "softer"\n      // This emphasizes the corners/edges\n      float radialAO = pow(aoBilinear, 1.2);\n\n      // Apply lighting and Ambient Occlusion\n      // If uUAO is 0, aoBilinear is effectively 1.0\n      float aoVal = mix(1.0, radialAO, uUAO);\n\n      // AO Debug mode: if uUAOD is 1.0, show only AO values as grayscale\n      vec3 color = mix(baseColor.rgb * Lg * aoVal, vec3(aoVal), uUAOD);\n      o = vec4(color, baseColor.a);\n    }\n  '),r=n.getUniformLocation(o,"MVP"),i=n.getUniformLocation(o,"M"),a=n.getUniformLocation(o,"L"),l=n.getUniformLocation(o,"T"),s=n.getUniformLocation(o,"uUT"),c=n.getUniformLocation(o,"uUAO"),d=n.getUniformLocation(o,"uULG"),g=n.getUniformLocation(o,"uUAOD"),u=function(){const e=[],t=[],n=[[-.5,-.5,-.5],[.5,-.5,-.5],[.5,.5,-.5],[-.5,.5,-.5],[-.5,-.5,.5],[.5,-.5,.5],[.5,.5,.5],[-.5,.5,.5]],o=[[1,5,6,1,6,2],[4,0,3,4,3,7],[3,2,6,3,6,7],[4,5,1,4,1,0],[5,4,7,5,7,6],[0,1,2,0,2,3]];return[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]].forEach((r,i)=>o[i].forEach(o=>{e.push(...n[o]),t.push(...r)})),{p:new Float32Array(e),n:new Float32Array(t),cnt:e.length/3}}(),I=n.createVertexArray();n.bindVertexArray(I),ar(n,u.p,0),ar(n,u.n,1);const h=n.createBuffer();n.bindBuffer(n.ARRAY_BUFFER,h),n.enableVertexAttribArray(2),n.vertexAttribPointer(2,4,n.FLOAT,!1,0,0);const b=n.createBuffer();n.bindBuffer(n.ARRAY_BUFFER,b),n.enableVertexAttribArray(3),n.vertexAttribPointer(3,2,n.FLOAT,!1,0,0);const m=n.createBuffer();n.bindBuffer(n.ARRAY_BUFFER,m),n.enableVertexAttribArray(4),n.vertexAttribPointer(4,1,n.FLOAT,!1,0,0);const C=n.createBuffer();n.bindBuffer(n.ARRAY_BUFFER,C),n.enableVertexAttribArray(5),n.vertexAttribPointer(5,2,n.FLOAT,!1,0,0);const A=n.createBuffer();if(n.bindBuffer(n.ARRAY_BUFFER,A),n.enableVertexAttribArray(6),n.vertexAttribPointer(6,4,n.FLOAT,!1,0,0),t.length>0){const e=lr(t),o=n.createTexture();n.bindTexture(n.TEXTURE_2D,o),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,e),n.generateMipmap(n.TEXTURE_2D),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST_MIPMAP_LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST)}return{gl:n,cbuf:h,uvbuf:b,aobuf:m,cube:u,uL:a,uM:i,uMVP:r,uT:l,uUT:s,uUAO:c,uULG:d,uUAOD:g,luvbuf:C,caoful:A}}function cr(e,t,n){const o=e.get("pan"),r=e.get("press"),i=e.get("tap");o.set({direction:ce.DIRECTION_ALL,threshold:10}),r.set({time:500}).recognizeWith(o),i.set({interval:50,threshold:5}),i.requireFailure(r),i.requireFailure(o);let a=0,l=0,s={x:0,y:0};t.addEventListener("pointermove",e=>{const t=e;s.x=t.clientX,s.y=t.clientY},{passive:!0});const c=e=>{const n=t.elementFromPoint(e.center.x,e.center.y);return!!n&&(globalThis.blockGarden.state.isCanvasActionDisabled||null!==n.closest("\n        dialog,\n        #materialBar,\n        .touch-btn,\n        .seed-controls,\n        .settings-menu,\n        .ui-grid__corner,\n        .ui-grid__corner--container\n      ")||n.closest("block-garden")&&"panstart"!==e.type&&"panmove"!==e.type)};e.on("panstart",e=>{c(e)||(a=0,l=0)}),e.on("panmove",e=>{if(c(e))return;const t=e.deltaX-a,o=e.deltaY-l;a=e.deltaX,l=e.deltaY;n.yaw-=.005*t;const r=Math.PI/2-.01;n.pitch=Math.max(-r,Math.min(r,n.pitch-.005*o))}),e.on("panend",()=>{a=0,l=0}),e.on("tap",e=>{if(c(e))return;if(n.uiButtonActive)return;e.srcEvent&&e.srcEvent.cancelable&&e.srcEvent.preventDefault();let o=n.hit;if(!wt.useSplitControls.get()){const r=t.getElementById("canvas"),i=n.y-n.playerHeight/2+1.62,{hit:a}=Fo(r,e.center.x,e.center.y,n.world,{x:n.x,y:i,z:n.z},{yaw:n.yaw,pitch:n.pitch});o=a}wt.useSplitControls.get()?Je(n):o&&Je(n,o)});let d=null;const g=()=>{d&&(clearInterval(d),d=null)};e.on("press",e=>{if(c(e))return;let o=n.hit;if(!wt.useSplitControls.get()){const r=t.getElementById("canvas"),i=n.y-n.playerHeight/2+1.62,{hit:a}=Fo(r,e.center.x,e.center.y,n.world,{x:n.x,y:i,z:n.z},{yaw:n.yaw,pitch:n.pitch});o=a}o&&ze(n,o),g(),d=setInterval(()=>{let o=n.hit;if(!wt.useSplitControls.get()){const r=t.getElementById("canvas"),i="mouse"===e.pointerType?s.x:e.center.x,a="mouse"===e.pointerType?s.y:e.center.y,l=n.y-n.playerHeight/2+1.62,{hit:c}=Fo(r,i,a,n.world,{x:n.x,y:l,z:n.z},{yaw:n.yaw,pitch:n.pitch});o=c}o&&ze(n,o)},500)}),e.on("pressup",g),e.on("panend",g)}function dr(e){const t=e.host;e.querySelectorAll(".touch-btn").forEach(e=>{const n=e.getAttribute("data-key");let o=!1;function r(){if(!o&&(o=!0,ko.uiButtonActive=!0,t.touchKeys[n]=!0,e instanceof HTMLButtonElement&&(e.style.background="var(--bg-color-gray-alpha-30)"),"backspace"===n)){const e=ko.hit;e&&ko.world.delete(`${e.x},${e.y},${e.z}`,!0)}}function i(){o=!1,ko.uiButtonActive=!1,t.touchKeys[n]=!1,e instanceof HTMLButtonElement&&(e.style.background="var(--bg-ui-touch-btn-background-color)")}e.addEventListener("touchstart",e=>{e.preventDefault(),e.stopPropagation(),r()}),e.addEventListener("touchend",e=>{e.preventDefault(),e.stopPropagation(),i()}),e.addEventListener("touchcancel",e=>{e.preventDefault(),e.stopPropagation(),i()}),e.addEventListener("mousedown",e=>{e.preventDefault(),e.stopPropagation(),r()}),e.addEventListener("mouseup",e=>{e.preventDefault(),e.stopPropagation(),i()}),e.addEventListener("mouseleave",e=>{e.preventDefault(),e.stopPropagation(),i()}),e.addEventListener("pointerdown",e=>{e.stopPropagation()})}),e.addEventListener("touchstart",t=>{(t.target instanceof HTMLDivElement&&t.target.closest(".touch-controls")||t.target===e.getElementById("canvas"))&&t.preventDefault()},{passive:!1}),e.addEventListener("touchmove",t=>{(t.target instanceof HTMLDivElement&&t.target.closest(".touch-controls")||t.target===e.getElementById("canvas"))&&t.preventDefault()},{passive:!1}),e.addEventListener("touchend",t=>{(t.target instanceof HTMLDivElement&&t.target.closest(".touch-controls")||t.target===e.getElementById("canvas"))&&t.preventDefault()},{passive:!1}),e.addEventListener("contextmenu",t=>{(t.target instanceof HTMLDivElement&&t.target.closest(".touch-controls")||t.target===e.getElementById("canvas"))&&t.preventDefault()}),e.addEventListener("dblclick",t=>{(t.target instanceof HTMLDivElement&&t.target.closest(".touch-controls")||t.target===e.getElementById("canvas"))&&t.preventDefault()})}async function gr(e,t,n){if(oo&&cancelAnimationFrame(oo),P(t,"Initializing Block Garden..."),await new Promise(e=>setTimeout(e,0)),t.dispatchEvent(new CustomEvent("block-garden-load",{detail:{isLoading:!0,error:null},bubbles:!0,composed:!0})),!n){const e="HTML canvas is required to init Block Garden.";return console.error(e),void t.dispatchEvent(new CustomEvent("block-garden-load",{detail:{isLoading:!1,error:e},bubbles:!0,composed:!0}))}t.addEventListener("focusout",e=>{const t=e;t.relatedTarget instanceof HTMLInputElement||t.relatedTarget instanceof HTMLTextAreaElement||t.relatedTarget instanceof HTMLSelectElement||t.relatedTarget?.closest?.(".seed-controls")||n.focus()}),n.focus();let o={},r="1";try{o=await(await fetch("data:application/json;base64,ewogICJuYW1lIjogImJsb2NrLWdhcmRlbiIsCiAgInZlcnNpb24iOiAiMS44LjEiLAogICJkZXNjcmlwdGlvbiI6ICJCbG9jayBHYXJkZW4gLSBBIDNEIHNhbmRib3ggZXhwbG9yYXRpb24gYW5kIGZhcm1pbmcgZ2FtZS4gRXhwbG9yZSBwcm9jZWR1cmFsbHkgZ2VuZXJhdGVkIHdvcmxkcywgZGlnIGZvciByZXNvdXJjZXMsIGFuZCBjdWx0aXZhdGUgYSB2YXJpZXR5IG9mIHBsYW50cy4iLAogICJob21lcGFnZSI6ICJodHRwczovL2dpdGh1Yi5jb20va2hlcnJpY2svYmxvY2stZ2FyZGVuLyNibG9jay1nYXJkZW4iLAogICJsaWNlbnNlIjogIkFHUEwtMy4wIiwKICAiYXV0aG9yIjogIkthcmwgSGVycmljayA8bWVAa2FybGhlcnJpY2suY29tPiIsCiAgInR5cGUiOiAibW9kdWxlIiwKICAibWFpbiI6ICJiaW4vc2VydmUubWpzIiwKICAibW9kdWxlIjogImluZGV4Lm1qcyIsCiAgImV4cG9ydHMiOiB7CiAgICAiLiI6IHsKICAgICAgImltcG9ydCI6ICIuL2Jsb2NrLWdhcmRlbi1idW5kbGUtbWluLm1qcyIKICAgIH0KICB9LAogICJzY3JpcHRzIjogewogICAgImJ1aWxkOmJhc2U6YWJvdXQiOiAiYmluL2J1aWxkLWh0bWwubWpzIGRpc3QvYWJvdXQvaW5kZXguaHRtbCBiYXNlIGhyZWYgL2Jsb2NrLWdhcmRlbi8iLAogICAgImJ1aWxkOmJhc2U6ZXhhbXBsZXMiOiAiYmluL2J1aWxkLWh0bWwubWpzIGRpc3Qvc3JjL2FwaS9leGFtcGxlcy9pbmRleC5odG1sIGJhc2UgaHJlZiAvYmxvY2stZ2FyZGVuLyIsCiAgICAiYnVpbGQ6YmFzZTppbmRleDp1bmJ1bmRsZWQiOiAiYmluL2J1aWxkLWh0bWwubWpzIGRpc3QvaW5kZXhfdW5idW5kbGVkLmh0bWwgYmFzZSBocmVmIC9ibG9jay1nYXJkZW4vIiwKICAgICJidWlsZDpiYXNlOmluZGV4IjogImJpbi9idWlsZC1odG1sLm1qcyBkaXN0L2luZGV4Lmh0bWwgYmFzZSBocmVmIC9ibG9jay1nYXJkZW4vIiwKICAgICJidWlsZDpiYXNlOnByaXZhY3kiOiAiYmluL2J1aWxkLWh0bWwubWpzIGRpc3QvcHJpdmFjeS9pbmRleC5odG1sIGJhc2UgaHJlZiAvYmxvY2stZ2FyZGVuLyIsCiAgICAiYnVpbGQ6YmFzZTpzaGFyZS10YXJnZXQiOiAiYmluL2J1aWxkLWh0bWwubWpzIGRpc3Qvc2hhcmUvc2hhcmUtdGFyZ2V0Lmh0bWwgYmFzZSBocmVmIC9ibG9jay1nYXJkZW4vIiwKICAgICJidWlsZDpjaSI6ICJucHggY29uY3VycmVudGx5IC0ta2lsbC1vdGhlcnMgLS1zdWNjZXNzIGZpcnN0IFwibnBtIHJ1biBidWlsZCBzaW5nbGVcIiBcIm5wbSBydW4gc3RhcnQ6ZGV2XCIiLAogICAgImJ1aWxkOmdoLXBhZ2VzOm5vamVreWxsIjogIm5vZGUgYmluL3RvdWNoLW5vamVreWxsLm1qcyIsCiAgICAiYnVpbGQ6cGtnOmdldDptZXRhIjogImdpdCByZXYtcGFyc2UgSEVBRCIsCiAgICAiYnVpbGQ6cGtnOm1ldGEiOiAibm9kZSAtZSBcImltcG9ydCBmcyBmcm9tICdub2RlOmZzL3Byb21pc2VzJzsgaW1wb3J0IHBrZyBmcm9tICcuL3BhY2thZ2UuanNvbicgd2l0aCB7IHR5cGU6ICdqc29uJyB9OyAoYXN5bmMgKCkgPT4geyBjb25zdCBtZXRhID0gcHJvY2Vzcy5hcmd2WzFdOyBwa2dbJ2Jsb2NrLWdhcmRlbiddID0geyBtZXRhIH07IGF3YWl0IGZzLndyaXRlRmlsZSgnZGlzdC9wYWNrYWdlLmpzb24nLCBKU09OLnN0cmluZ2lmeShwa2csIG51bGwsIDIpKTsgfSkoKVwiIiwKICAgICJidWlsZDpzY3JpcHQ6aW5kZXgiOiAiYmluL2J1aWxkLWh0bWwubWpzIGRpc3QvaW5kZXguaHRtbCBzY3JpcHQgc3JjIGJsb2NrLWdhcmRlbi1idW5kbGUtbWluLm1qcyIsCiAgICAiYnVpbGQ6c2VydmljZS13b3JrZXIiOiAiY2QgZGlzdCAmJiB3b3JrYm94IGdlbmVyYXRlU1cgc2VydmljZS13b3JrZXIvd29ya2JveC1jb25maWcuY2pzIiwKICAgICJidWlsZDpzaW5nbGU6YnVuZGxlOmNsZWFuIjogImdpdCBjaGVja291dCBIRUFEIC0tIHNyYyIsCiAgICAiYnVpbGQ6c2luZ2xlOmJ1bmRsZSI6ICJiaW4vYmFzZTY0LWVuY29kZS1idW5kbGUtcmVxdWVzdHMuc2giLAogICAgImJ1aWxkOnNpbmdsZTppbmRleDpjbGVhbiI6ICJnaXQgY2hlY2tvdXQgSEVBRCAtLSBpbmRleC5odG1sIiwKICAgICJidWlsZDpzaW5nbGU6aW5kZXgiOiAiYmluL2Jhc2U2NC1lbmNvZGUtaW5kZXgtcmVxdWVzdHMuc2giLAogICAgImJ1aWxkOnppcCI6ICJnaXQgYXJjaGl2ZSAtLWZvcm1hdCB6aXAgLS1vdXRwdXQgXCJibG9jay1nYXJkZW4tYnVpbGQtJChucG0gcnVuIC1zIGJ1aWxkOnBrZzpnZXQ6bWV0YSkuemlwXCIgSEVBRCIsCiAgICAiYnVpbGQiOiAiYmFzaCBiaW4vYnVpbGQuc2giLAogICAgImJ1bmRsZSI6ICJyb2xsdXAgLWMiLAogICAgImNsZWFuOnNlcnZpY2Utd29ya2VyIjogIm5vZGUgYmluL3JpbXJhZi5tanMgZGlzdC9zZXJ2aWNlLXdvcmtlci8qLmNqcyIsCiAgICAiY2xlYW4iOiAibm9kZSBiaW4vcmltcmFmLm1qcyBkaXN0IiwKICAgICJjb3B5OjQwNCI6ICJub2RlIGJpbi9uY3AubWpzIDQwNC5odG1sIGRpc3QvNDA0Lmh0bWwiLAogICAgImNvcHk6YWJvdXQiOiAibm9kZSBiaW4vbmNwLm1qcyBhYm91dC9pbmRleC5odG1sIGRpc3QvYWJvdXQvaW5kZXguaHRtbCIsCiAgICAiY29weTpkZXBzIjogIm5vZGUgYmluL25jcC5tanMgZGVwcyBkaXN0L2RlcHMiLAogICAgImNvcHk6aW5kZXg6YXNzZXRzIjogIm5vZGUgYmluL25jcC5tanMgYXNzZXRzIGRpc3QvYXNzZXRzIiwKICAgICJjb3B5OmluZGV4OmxpY2Vuc2UiOiAibm9kZSBiaW4vbmNwLm1qcyBMSUNFTlNFIGRpc3QvTElDRU5TRSIsCiAgICAiY29weTppbmRleDpsbG1zIjogIm5vZGUgYmluL25jcC5tanMgbGxtcy50eHQgZGlzdC9sbG1zLnR4dCIsCiAgICAiY29weTppbmRleDptYW5pZmVzdCI6ICJub2RlIGJpbi9uY3AubWpzIG1hbmlmZXN0Lmpzb24gZGlzdC9tYW5pZmVzdC5qc29uIiwKICAgICJjb3B5OmluZGV4OnJlYWRtZSI6ICJub2RlIGJpbi9uY3AubWpzIFJFQURNRS5tZCBkaXN0L1JFQURNRS5tZCIsCiAgICAiY29weTppbmRleDpyb2JvdHMiOiAibm9kZSBiaW4vbmNwLm1qcyByb2JvdHMudHh0IGRpc3Qvcm9ib3RzLnR4dCIsCiAgICAiY29weTppbmRleDpzaXRlbWFwIjogIm5vZGUgYmluL25jcC5tanMgc2l0ZW1hcC50eHQgZGlzdC9zaXRlbWFwLnR4dCIsCiAgICAiY29weTppbmRleDp1bmJ1bmRsZWQiOiAibm9kZSBiaW4vbmNwLm1qcyBpbmRleC5odG1sIGRpc3QvaW5kZXhfdW5idW5kbGVkLmh0bWwiLAogICAgImNvcHk6aW5kZXgiOiAibm9kZSBiaW4vbmNwLm1qcyBpbmRleC5odG1sIGRpc3QvaW5kZXguaHRtbCIsCiAgICAiY29weTpwa2ciOiAibm9kZSBiaW4vbmNwLm1qcyBwYWNrYWdlLmpzb24gZGlzdC9wYWNrYWdlLmpzb24iLAogICAgImNvcHk6cHJpdmFjeSI6ICJub2RlIGJpbi9uY3AubWpzIHByaXZhY3kvaW5kZXguaHRtbCBkaXN0L3ByaXZhY3kvaW5kZXguaHRtbCIsCiAgICAiY29weTpzZXJ2aWNlLXdvcmtlciI6ICJub2RlIGJpbi9uY3AubWpzIHNlcnZpY2Utd29ya2VyL3dvcmtib3gtY29uZmlnLmNqcyBkaXN0L3NlcnZpY2Utd29ya2VyL3dvcmtib3gtY29uZmlnLmNqcyIsCiAgICAiY29weTpzaGFyZS10YXJnZXQiOiAibm9kZSBiaW4vbmNwLm1qcyBzaGFyZSBkaXN0L3NoYXJlIiwKICAgICJjb3B5OnNyYzppbmRleCI6ICJub2RlIGJpbi9uY3AubWpzIGluZGV4Lm1qcyBkaXN0L2luZGV4Lm1qcyIsCiAgICAiY29weTpzcmMiOiAibm9kZSBiaW4vbmNwLm1qcyBzcmMgZGlzdC9zcmMiLAogICAgImRlcGxveTpnaC1wYWdlcyI6ICJnaC1wYWdlcyAtLW5vLWhpc3RvcnkgLS1kb3RmaWxlcyAtLWRpc3QgZGlzdCAtLXJlcG8gZ2l0QGdpdGh1Yi5jb206a2hlcnJpY2svYmxvY2stZ2FyZGVuLmdpdCAtLXJlbW90ZSB1cHN0cmVhbSIsCiAgICAiZm9ybWF0IjogInByZXR0aWVyICoqLyoue2h0bWwsY3NzLGpzLG1qc30gLS13cml0ZSIsCiAgICAibWluaWZ5OjQwNCI6ICJwb3N0aHRtbCBkaXN0LzQwNC5odG1sIC11IGh0bWxuYW5vIiwKICAgICJtaW5pZnk6YWJvdXQiOiAicG9zdGh0bWwgZGlzdC9hYm91dC8qLmh0bWwgLXUgaHRtbG5hbm8iLAogICAgIm1pbmlmeTppbmRleCI6ICJwb3N0aHRtbCBkaXN0L2luZGV4Lmh0bWwgLXUgaHRtbG5hbm8iLAogICAgIm1pbmlmeTpwcml2YWN5IjogInBvc3RodG1sIGRpc3QvcHJpdmFjeS8qLmh0bWwgLXUgaHRtbG5hbm8iLAogICAgIm1pbmlmeTpzaGFyZS10YXJnZXQiOiAicG9zdGh0bWwgZGlzdC9zaGFyZS8qLmh0bWwgLXUgaHRtbG5hbm8iLAogICAgInN0YXJ0OmRldiI6ICJucG0gc3RhcnQgODA4MCIsCiAgICAic3RhcnQiOiAibm9kZSBiaW4vc2VydmUubWpzIiwKICAgICJ0ZXN0IjogIk5PREVfT1BUSU9OUz0tLWV4cGVyaW1lbnRhbC12bS1tb2R1bGVzIGplc3QiCiAgfSwKICAiZGV2RGVwZW5kZW5jaWVzIjogewogICAgIkBwbGF5d3JpZ2h0L3Rlc3QiOiAiXjEuNTYuMSIsCiAgICAiQHJvbGx1cC9wbHVnaW4tY29tbW9uanMiOiAiXjI5LjAuMCIsCiAgICAiQHJvbGx1cC9wbHVnaW4tbm9kZS1yZXNvbHZlIjogIl4xNi4wLjMiLAogICAgIkByb2xsdXAvcGx1Z2luLXRlcnNlciI6ICJeMC40LjQiLAogICAgIkByb2xsdXAvcGx1Z2luLXR5cGVzY3JpcHQiOiAiXjEyLjMuMCIsCiAgICAiQHhtbGRvbS94bWxkb20iOiAiXjAuOC4xMSIsCiAgICAiYmFzZWxpbmUtYnJvd3Nlci1tYXBwaW5nIjogIl4yLjkuNyIsCiAgICAiY29tcHJlc3Npb24iOiAiXjEuOC4xIiwKICAgICJjb25jdXJyZW50bHkiOiAiXjkuMi4xIiwKICAgICJjb3JzIjogIl4yLjguNSIsCiAgICAiY3NzbmFubyI6ICJeNy4xLjIiLAogICAgImV4cHJlc3MiOiAiXjUuMS4wIiwKICAgICJleHByZXNzLXVybHJld3JpdGUiOiAiXjIuMC4zIiwKICAgICJnaC1wYWdlcyI6ICJeNi4zLjAiLAogICAgImh0bWxuYW5vIjogIl4yLjEuNSIsCiAgICAiamVzdCI6ICJeMzAuMi4wIiwKICAgICJqZXN0LWVudmlyb25tZW50LWpzZG9tIjogIl4zMC4yLjAiLAogICAgInBvc3Rjc3MiOiAiXjguNS42IiwKICAgICJwb3N0Y3NzLWNsaSI6ICJeMTEuMC4xIiwKICAgICJwb3N0aHRtbC1jbGkiOiAiXjAuMTAuMCIsCiAgICAicHJldHRpZXIiOiAiXjMuNi4yIiwKICAgICJyb2xsdXAiOiAiXjIuNzkuMiIsCiAgICAic3ZnbyI6ICJeMy4zLjIiLAogICAgInRjcC1wb3J0LXVzZWQiOiAiXjEuMC4yIiwKICAgICJ0eXBlc2NyaXB0IjogIl41LjkuMyIsCiAgICAid29ya2JveC1jbGkiOiAiXjcuMy4wIgogIH0sCiAgImRlcGVuZGVuY2llcyI6IHsKICAgICJhbGVhIjogIl4xLjAuMSIsCiAgICAiaGFtbWVyanMiOiAiXjIuMC44IiwKICAgICJrb25hbWktY29kZS1qcyI6ICJeMC44LjMiLAogICAgImxvY2FsZm9yYWdlIjogIl4xLjEwLjAiLAogICAgImxvZGFzaC5pc251bWJlciI6ICJeMy4wLjMiLAogICAgInBkZi1saWIiOiAiXjEuMTcuMSIsCiAgICAic2lnbmFsLXBvbHlmaWxsIjogIl4wLjIuMiIsCiAgICAic2ltcGxleC1ub2lzZSI6ICJeNC4wLjMiLAogICAgIndvcmtib3gtd2luZG93IjogIl43LjQuMCIKICB9Cn0K")).json(),r=o.version}catch(e){console.log(`continuing with static version: ${r}`)}P(t,"Generating World..."),await new Promise(e=>setTimeout(e,0));const{computedSignals:i,gameConfig:l,gameState:s,invalidSeedProvided:c}=await To(e,r);c&&P(t,"Invalid seed provided in URL. Using a random seed instead.",{stack:!0,useSingle:!1,duration:5e3});const d=t.host;d.keys={},d.touchKeys={};const g=await async function(e){try{const t=await a.getItem(e);if(t&&"object"==typeof t)return console.log("Loaded custom colors:",Object.keys(t).length,"properties"),t}catch(e){console.error("Failed to load saved colors:",e)}return null}(Ce),u=Ie(e,t);de(t,g??u);const I=e.getComputedStyle(t.host),h=Object.fromEntries(Object.entries(function(e,t,n="",o=""){let r;for(const i of t){r||(r={});let t=i.slice(n.length);t=t.slice(0,o.length>0?-o.length:void 0),r[t]=e.getPropertyValue(i)}return r}(I,Object.keys(ne.block).map(e=>`--bg-block-${e}-color`),"--bg-block-","-color")).map(([t,n])=>[t.replaceAll("-"," ").toLowerCase().split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "),he(ge(e.document,n))]));var b;rr(t,i.currentBlock),or(t,n,l.currentResolution),function(e,t){t.addEventListener("click",()=>{globalThis.blockGarden.config.useSplitControls.get()&&t?.requestPointerLock()}),t.addEventListener("contextmenu",e=>{e.preventDefault()})}(0,n,l.blocks,s.curBlock),cr(ce(t.host),t,s),dr(t),function(e,t){const n=globalThis.blockGarden?.state,o=globalThis.blockGarden?.config;n&&o?zo(()=>{t(e,n.materialBar.get(),n.activeMaterialBarSlot.get(),o.blocks)}):console.error("Game state or config not initialized for material bar effects")}(t,(b=ne,function(e,t,n,o){const r=e.getElementById("materialBar");r&&(r.innerHTML=t.map((e,t)=>{const o=We(e),r=o?.name.toLowerCase().replace(/ /g,"-")||"air",i=o?.name||"Air",a=b.block[r]||"var(--bg-color-gray-500)";return`\n          <div class="materialBar-slot ${t===n?"active":""}" data-index="${t}" title="${i}">\n            <div class="materialBar-slot-number">${t+1}</div>\n            <div class="materialBar-slot-cube">\n              <div class="materialBar-cube-face materialBar-cube-front" style="background-color: ${a};"></div>\n              <div class="materialBar-cube-face materialBar-cube-top" style="background-color: ${a};"></div>\n              <div class="materialBar-cube-face materialBar-cube-right" style="background-color: ${a};"></div>\n            </div>\n            <div class="materialBar-slot-name">${i}</div>\n          </div>\n        `}).join(""))})),function(e){const t=e.getElementById("materialBar");t&&t.addEventListener("click",e=>{const t=e.target instanceof Element?e.target.closest(".materialBar-slot"):null;t instanceof HTMLElement&&wo(parseInt(t.dataset.index))})}(t),P(t,"Preparing Graphics..."),await new Promise(e=>setTimeout(e,0));const{gl:m,cbuf:C,uvbuf:A,aobuf:p,cube:v,uL:f,uM:w,uMVP:G,uT:k,uUT:S,uUAO:Z,uULG:W,uUAOD:L}=sr(n,l.blocks),R={playerX:t.getElementById("playerX"),playerY:t.getElementById("playerY"),playerZ:t.getElementById("playerZ")};t.addEventListener("block-garden-reset",o=>{const{blocks:r}=l,{growthTimers:i,plantStructures:a}=s,c=r.FAST_GROWTH_TIME||30;let d,g;Object.keys(i).forEach(e=>{if(s.fastGrowth)i[e]=c;else{const t=a[e]?.type,n=r.find(e=>e.name===t);i[e]=n?.growthTime||10}}),o instanceof CustomEvent&&(d=o?.detail?.colors??{}),g=Object.keys(d).length&&d.constructor===Object?be(d,"--bg-block-","-color"):be(u,"--bg-block-","-color");const I=Object.fromEntries(Object.entries(g).map(([t,n])=>[t.replaceAll("-"," ").toLowerCase().split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "),he(ge(e.document,n))]));bo(t,n,I,s,l,R,m,C,A,p,v,f,w,G,k,S,Z,W,L),s.shouldReset.set(!0)});let B=await $(e,t),x=!1;B||(x=await async function(e,t){try{const n=await a.getItem(O),o="auto"===await a.getItem(U);if(!n||!o)return!1;e.blockGarden.state.isCanvasActionDisabled=!0;const r=e.document.createElement("dialog");r.style.cssText="\n      background: var(--bg-color-gray-50);\n      border-radius: 0.5rem;\n      border: 0.125rem solid var(--bg-color-gray-900);\n      color: var(--bg-color-gray-900);\n      font-family: monospace;\n      padding: 1.25rem;\n      max-width: 25rem;\n      z-index: 10000;\n    ";const i=new Date(n.timestamp).toLocaleString();return r.innerHTML=`\n      <h3 style="margin: 0 0 1rem 0">Auto Save Detected</h3>\n      <p style="margin: 0 0 1rem 0">\n        A saved game from ${i} was found. Would you like to load it?\n      </p>\n      <div style="display: flex; gap: 0.625rem; justify-content: flex-end">\n        <button id="autoSaveNo" style="\n          background: var(--bg-color-red-500);\n          border-radius: 0.25rem;\n          border: none;\n          color: white;\n          cursor: pointer;\n          padding: 0.5rem 0.9375rem;\n        ">No</button>\n        <button id="autoSaveYes" style="\n          background: var(--bg-color-green-500);\n          border-radius: 0.25rem;\n          border: none;\n          color: white;\n          cursor: pointer;\n          padding: 0.5rem 0.9375rem;\n        ">Yes</button>\n      </div>\n    `,r.addEventListener("cancel",()=>{setTimeout(()=>{e.blockGarden.state.isCanvasActionDisabled=!1},500)}),r.addEventListener("close",()=>{setTimeout(()=>{e.blockGarden.state.isCanvasActionDisabled=!1},500)}),t.append(r),r.showModal(),new Promise(o=>{const i=r.querySelector("#autoSaveNo"),a=r.querySelector("#autoSaveYes");a.addEventListener("click",async()=>{i.setAttribute("disabled","disabled");try{const i=y(e,n.data,"application/gzip");let a;if(!("DecompressionStream"in e))throw new Error("DecompressionStream not supported");{const t=i.stream().pipeThrough(new e.DecompressionStream("gzip")),n=await new e.Response(t).blob();a=await n.text()}const l=JSON.parse(a);if(!await N(e,t,l))return P(t,"Oops! This auto-save appears to be broken. Continuing with normal load...",{stack:!0,useSingle:!1,duration:5e3}),r.close(),r.remove(),void o(!1);const s=t.getElementById("worldSeedInput"),c=t.getElementById("currentSeed");s instanceof HTMLInputElement&&(s.value=e.blockGarden.state.seed),c&&(c.textContent=e.blockGarden.state.seed),console.log("Auto save loaded successfully")}catch(e){return console.error("Failed to load auto save:",e),P(t,"Oops! Failed to load auto-save. Continuing...",{stack:!0,useSingle:!1,duration:5e3}),r.close(),r.remove(),void o(!1)}r.close(),r.remove(),o(!0)}),i.addEventListener("click",()=>{a.setAttribute("disabled","disabled"),r.close(),r.remove(),o(!1)}),r.addEventListener("cancel",()=>{setTimeout(()=>{e.blockGarden.state.isCanvasActionDisabled=!1},500),o(!1)})})}catch(e){return console.error("Failed to check for auto save:",e),!1}}(e,t));let T=!1;B||x||(T=await ee(e,t)),B||x||T||Oo(s.seed);const E=function(){try{const e=new URLSearchParams(location.search),t={};for(const n of["x","y","z","pitch","yaw"]){const o=D(e,n);void 0!==o&&(t[n]=o)}const n=e.get("flying");return"true"!==n&&"false"!==n||(t.flying="true"===n),t}catch(e){return console.warn("Failed to parse player params from URL:",e),{}}}();void 0!==E.x&&(s.x=Number(E.x)),void 0!==E.y&&(s.y=Number(E.y)),void 0!==E.z&&(s.z=Number(E.z)),void 0!==E.pitch&&(s.pitch=Number(E.pitch)),void 0!==E.yaw&&(s.yaw=Number(E.yaw)),void 0!==E.flying&&s.flying.set(Boolean(E.flying)),function(e){try{const t=new e.URL(e.location.href),n=new e.URLSearchParams(t.search);let o=!1;if(n.has("seed")&&(n.delete("seed"),o=!0),n.has("gameSave")&&(n.delete("gameSave"),o=!0),n.has("x")&&(n.delete("x"),o=!0),n.has("y")&&(n.delete("y"),o=!0),n.has("z")&&(n.delete("z"),o=!0),n.has("pitch")&&(n.delete("pitch"),o=!0),n.has("yaw")&&(n.delete("yaw"),o=!0),n.has("flying")&&(n.delete("flying"),o=!0),o){const o=n.toString(),r=t.origin+t.pathname+(o?"?"+o:"");e.history.replaceState({},"",r)}}catch(e){}}(e),setInterval(async()=>{"auto"===await _()&&await q(e)},6e4);const M=await a.setItem("block-garden-version",r);console.log(`Block Garden version: ${M}`),P(t,"Starting Game..."),await new Promise(e=>setTimeout(e,0)),bo(t,n,h,s,l,R,m,C,A,p,v,f,w,G,k,S,Z,W,L),t.dispatchEvent(new CustomEvent("block-garden-load",{detail:{isLoading:!1,pkg:o,error:null},bubbles:!0,composed:!0}))}const ur="block-garden-select";class Ir extends HTMLElement{#e;#t;#n;#o;#r;#i=[];constructor(){super();const e=globalThis.document.createElement("template");e.innerHTML='\n      <style>\n        [hidden] {\n          display: none !important;\n        }\n\n        .block-garden-select {\n          align-items: center;\n          background: var(--bg-color-green-500);\n          border-radius: 0.25rem;\n          border: none;\n          color: var(--bg-color-white);\n          cursor: pointer;\n          display: flex;\n          font-size: 0.625rem;\n          justify-content: space-between;\n          min-height: 2.125rem;\n          padding: 0.375rem 0.75rem;\n          text-align: center;\n          transition: all 0.2s;\n          user-select: none;\n          width: 100%;\n          box-sizing: border-box;\n          overflow: hidden;\n        }\n\n        .block-garden-select > * {\n          flex-shrink: 0;\n        }\n\n        .selected-text {\n          flex: 1;\n          overflow: hidden;\n          text-overflow: ellipsis;\n          white-space: nowrap;\n        }\n\n        .block-garden-select:hover {\n          background: var(--bg-color-green-600);\n        }\n\n        .block-garden-select:focus {\n          outline-offset: -0.125rem;\n          outline: 0.125rem solid var(--bg-color-green-500);\n        }\n\n        .block-garden-select[aria-expanded="true"] {\n          border-radius: 0.25rem 0.25rem 0 0;\n        }\n\n        .chevron {\n          flex-shrink: 0;\n          font-size: 0.75rem;\n          margin-left: 0.25rem;\n          padding-left: 0.25rem;\n          transition: transform 0.2s;\n        }\n\n        .block-garden-select[aria-expanded="true"] .chevron {\n          transform: rotate(180deg);\n        }\n\n        .placeholder {\n          opacity: 0.8;\n        }\n\n        .select-list {\n          background: var(--bg-color-gray-900);\n          border-radius: 0 0 0.25rem 0.25rem;\n          border-top: none;\n          border: 0.0625rem solid var(--bg-color-neutral-950);\n          left: 0;\n          list-style: none;\n          margin: 0;\n          max-height: 12rem;\n          overflow-y: auto;\n          padding: 0;\n          position: absolute;\n          right: 0;\n          top: 100%;\n          z-index: 1000;\n        }\n\n        .select-list[hidden] {\n          display: none;\n        }\n\n        .select-item {\n          border-bottom: 1px solid rgba(255,255,255,0.05);\n          color: var(--bg-color-white);\n          cursor: pointer;\n          font-size: 0.625rem;\n          padding: 0.375rem 0.75rem;\n          transition: all 0.2s;\n        }\n\n        .select-item:last-child {\n          border-bottom: none;\n        }\n\n        .select-item:hover,\n        .select-item:focus,\n        .select-item[aria-selected="true"] {\n          background: var(--bg-color-green-500);\n          outline: none;\n        }\n\n        .select-item:focus {\n          outline: 2px solid var(--bg-color-green-500);\n          outline-offset: -2px;\n        }\n\n        /* scrollbar */\n        .select-list {\n          scrollbar-color: var(--bg-color-gray-700) var(--bg-color-gray-900);\n          scrollbar-width: thin;\n        }\n\n        .select-list::-webkit-scrollbar {\n          width: 0.625rem;\n        }\n\n        .select-list::-webkit-scrollbar-track {\n          background: var(--bg-color-gray-900);\n        }\n\n        .select-list::-webkit-scrollbar-thumb {\n          background: var(--bg-color-gray-700);\n          border-radius: 0.625rem;\n          border: 0.125rem solid var(--bg-color-gray-900);\n        }\n\n        .select-list::-webkit-scrollbar-thumb:hover {\n          background: var(--bg-color-neutral-950);\n        }\n      </style>\n\n      <div\n        aria-expanded="false"\n        aria-haspopup="listbox"\n        aria-labelledby="selectedValue"\n        class="block-garden-select"\n        role="combobox"\n        tabindex="0"\n      >\n        <span class="selected-text placeholder" id="selectedValue">Choose resolution</span>\n        <span aria-hidden="true" class="chevron"></span>\n      </div>\n\n      <ul class="select-list" hidden id="selectList" role="listbox"></ul>\n\n      <input id="valueInput" type="hidden">\n    ',this.#e=this.attachShadow({mode:"open"}),this.#e.appendChild(e.content.cloneNode(!0)),this.#t=this.#e.querySelector(".block-garden-select"),this.#n=this.#e.querySelector("#selectList"),this.#o=this.#e.querySelector("#selectedValue"),this.#r=this.#e.querySelector("#valueInput")}connectedCallback(){requestAnimationFrame(()=>this.#a())}#a(){if(this.#i.length>0)return;0===this.querySelectorAll("block-garden-option").length&&(this.innerHTML='\n        <block-garden-option value="400">400x400</block-garden-option>\n        <block-garden-option value="600">600x600</block-garden-option>\n        <block-garden-option value="800">800x800</block-garden-option>\n        <block-garden-option hidden="hidden" value="fullscreen">Fullscreen</block-garden-option>\n      '),this.#l();let e=-1;const t=()=>{this.#l(),this.#n.hidden=!1,this.#t.setAttribute("aria-expanded","true"),this.#i[0]?.focus(),e=0},n=()=>{this.#n.hidden=!0,this.#t.setAttribute("aria-expanded","false"),this.#t.focus(),e=-1},o=e=>{const t=e.dataset.value,o=e.textContent.trim();this.#o.textContent=o,this.#o.classList.remove("placeholder"),this.#r.value=t,this.#i.forEach(e=>e.setAttribute("aria-selected","false")),e.setAttribute("aria-selected","true"),n(),this.dispatchEvent(new CustomEvent("change",{detail:{value:t,label:o},bubbles:!0,composed:!0}))};this.#t.addEventListener("keydown",e=>{switch(e.key){case"Enter":case" ":e.preventDefault(),this.#n.hidden?t():n();break;case"ArrowDown":case"ArrowUp":e.preventDefault(),t();break;case"Escape":n()}}),this.#n.addEventListener("keydown",t=>{const r=t.target.closest(".select-item");if(r)switch(t.stopPropagation(),t.key){case"Enter":case" ":t.preventDefault(),o(r);break;case"Escape":n();break;case"ArrowDown":t.preventDefault(),e=(e+1)%this.#i.length,this.#i[e].focus();break;case"ArrowUp":t.preventDefault(),e=0===e?this.#i.length-1:e-1,this.#i[e].focus();break;case"Home":t.preventDefault(),this.#i[0].focus(),e=0;break;case"End":t.preventDefault(),this.#i[this.#i.length-1].focus(),e=this.#i.length-1}}),this.#t.addEventListener("click",e=>{e.stopPropagation(),this.#n.hidden?t():n()}),this.#e.addEventListener("click",e=>{const t=e.target.closest(".select-item");t&&(e.stopPropagation(),o(t))}),globalThis.document.addEventListener("click",e=>{this.contains(e.target)||n()}),Object.defineProperty(this,"value",{get:()=>this.#r.value,set:e=>{this.#r.value=e;const t=this.#n.querySelector(`[data-value="${e}"]`);t?(this.#o.textContent=t.textContent.trim(),this.#o.classList.remove("placeholder")):(this.#o.textContent=e,this.#o.classList.remove("placeholder"))}}),this.getAttribute("value")&&(this.value=this.getAttribute("value"))}#l(){this.#n.innerHTML="",this.#i=[],Array.from(this.querySelectorAll("block-garden-option")).forEach(e=>{if(e.hasAttribute("hidden"))return;const t=globalThis.document.createElement("li");t.className="select-item",t.setAttribute("role","option"),t.tabIndex=-1;const n=e.getAttribute("value")||"";t.dataset.value=n,t.textContent=e.textContent.trim(),this.#n.appendChild(t),this.#i.push(t)})}static get observedAttributes(){return["value"]}attributeChangedCallback(e){"value"===e&&(this.value=this.getAttribute("value"))}}globalThis.customElements?.get(ur)||globalThis.customElements.define(ur,Ir);const hr="block-garden";class br extends HTMLElement{constructor(){if(super(),!this.shadowRoot){const e=globalThis.document.createElement("template");e.innerHTML=`\n        <style>\n          [hidden] {\n            display: none !important;\n          }\n\n          :focus {\n            outline: none;\n          }\n\n          :host {\n            align-items: center;\n            display: flex;\n            height: var(--bg-ui-host-height, 100vh);\n            height: var(--bg-ui-host-height, 100dvh);\n            justify-content: center;\n            overflow: var(--bg-ui-host-overflow, hidden);\n            position: relative;\n            width: var(--bg-ui-host-width, 100vw);\n            width: var(--bg-ui-host-width, 100dvw);\n\n            ${re("--bg-color-",ne.color)}\n            ${re("--bg-block-",ne.block)}\n            ${re("--bg-ui-",ne.ui)}\n            touch-action: none;\n          }\n\n          canvas {\n            background-color: var(--bg-color-black);\n            height: 25rem;\n            width: 25rem;\n            touch-action: none;\n          }\n\n          .ui-grid {\n            display: grid;\n            grid-template-columns: 1fr 1fr;\n            grid-template-rows: 1fr 1fr;\n            height: var(--bg-ui-grid-height, calc(100vh - 1rem));\n            height: var(--bg-ui-grid-height, calc(100dvh - 1rem));\n            margin: 0.5rem;\n            pointer-events: none;\n            position: absolute;\n            top: 0;\n            width: var(--bg-ui-grid-width, calc(100vw - 1rem));\n            width: var(--bg-ui-grid-width, calc(100dvw - 1rem));\n          }\n\n          .ui-grid__corner {\n            max-height: var(--bg-ui-grid-corner-max-height, calc(100vh - 1rem));\n            max-height: var(--bg-ui-grid-corner-max-height, calc(100dvh - 1rem));\n            overflow-y: auto;\n            pointer-events: auto;\n            transition: height 0.35s cubic-bezier(0.68, -0.55, 0.27, 1.5);\n          }\n\n          .ui-grid__corner--heading {\n            color: var(--bg-ui-grid-corner-heading-color);\n            backdrop-filter: blur(0.3125rem);\n            background-color: var(--bg-ui-grid-corner-heading-background-color);\n            border-radius: 0.5rem;\n            border-width: 0.0625rem;\n            border-style: solid;\n            border-color: var(--bg-ui-grid-corner-heading-border-color);\n            cursor: pointer;\n            font-size: 0.75rem;\n            padding: 0.75rem;\n          }\n\n          .ui-grid__corner--container {\n            color: var(--bg-ui-grid-corner-container-color);\n            padding: 0.5rem;\n          }\n\n          .ui-grid__corner--sub-heading {\n            color: var(--bg-ui-grid-corner-heading-color);\n            margin: 1rem 0 0.3125rem 0;\n          }\n\n          .ui-grid__corner--sub-section {\n            overflow: auto;\n          }\n\n          .ui-grid__corner {\n            scrollbar-width: thin; /* Slim scrollbar */\n            scrollbar-color: var(--bg-color-gray-700) var(--bg-color-stone-100); /* Handle and track colors */\n          }\n\n          .ui-grid__corner::-webkit-scrollbar {\n            width: 0.625rem; /* Custom width */\n          }\n\n          .ui-grid__corner::-webkit-scrollbar-track {\n            background: var(--bg-color-stone-100); /* Track background */\n          }\n\n          .ui-grid__corner::-webkit-scrollbar-thumb {\n            background: var(--bg-color-gray-700); /* Handle color */\n            border-radius: 0.625rem; /* Rounded edges */\n            border: 0.125rem solid var(--bg-color-stone-100); /* Padding around handle */\n          }\n\n          .ui-grid__corner::-webkit-scrollbar-thumb:hover {\n            background: var(--bg-color-neutral-950); /* Highlight on hover */\n          }\n\n          /* Element modifiers for sticky corners */\n          .ui-grid__corner--top-left {\n            align-self: start;\n            grid-column: 1;\n            grid-row: 1;\n            justify-self: start;\n          }\n\n          .ui-grid__corner--top-right {\n            align-self: start;\n            grid-column: 2;\n            grid-row: 1;\n            justify-self: end;\n            z-index: 1;\n          }\n\n          .ui-grid__corner--bottom-left {\n            align-self: end;\n            grid-column: 1;\n            grid-row: 2;\n            justify-self: start;\n          }\n\n          .ui-grid__corner--bottom-right {\n            align-self: end;\n            grid-column: 2;\n            grid-row: 2;\n            justify-self: end;\n            max-width: 15.625rem;\n          }\n\n          /* Center position for material button */\n          .ui-grid__corner--center {\n            align-self: start;\n            grid-column: 1 / 3;\n            grid-row: 1 / 3;\n            justify-self: center;\n            max-height: 80dvh;\n            max-height: 80vh;\n            max-width: 90dvw;\n            max-width: 90vw;\n            z-index: 100;\n          }\n\n          /* Material Button */\n          #material {\n            backdrop-filter: blur(0.3125rem);\n            background: var(--bg-color-black-alpha-80);\n            border-radius: 0.5rem;\n            border: 0.0625rem solid var(--bg-color-gray-alpha-10);\n            color: var(--bg-color-white);\n            font-size: 0.5625rem;\n          }\n\n          .materialBar {\n            backdrop-filter: blur(0.3125rem);\n            background: var(--bg-color-black-alpha-60);\n            border-radius: 0.3125rem;\n            border: 0.125rem solid var(--bg-color-gray-alpha-30);\n            bottom: 1rem;\n            display: flex;\n            gap: 0.3125rem;\n            left: 50%;\n            max-width: 95%;\n            overflow: hidden;\n            padding: 0.3125rem;\n            pointer-events: auto;\n            position: absolute;\n            transform: translateX(-50%);\n            z-index: 50;\n          }\n\n          .materialBar-slot {\n            align-items: center;\n            background-color: var(--bg-color-black-alpha-60);\n            border: 0.125rem solid var(--bg-color-gray-600);\n            cursor: pointer;\n            display: flex;\n            flex-direction: column;\n            font-size: 0.5rem;\n            gap: 0.25rem;\n            height: 3rem;\n            justify-content: center;\n            padding: 0.25rem;\n            position: relative;\n            transition: all 0.1s;\n            width: 3rem;\n          }\n\n          .materialBar-slot-cube {\n            height: 1.5rem;\n            perspective: 1000px;\n            position: relative;\n            transform-style: preserve-3d;\n            transform: rotateX(20deg) rotateY(-30deg);\n            width: 1.5rem;\n          }\n\n          .materialBar-cube-face {\n            border: 0.0625rem solid rgba(0, 0, 0, 0.3);\n            height: 1.5rem;\n            position: absolute;\n            width: 1.5rem;\n          }\n\n          .materialBar-cube-front {\n            transform: translateZ(0.75rem);\n          }\n\n          .materialBar-cube-top {\n            filter: brightness(1.2);\n            transform: rotateX(90deg) translateZ(0.75rem);\n          }\n\n          .materialBar-cube-right {\n            filter: brightness(0.8);\n            transform: rotateY(90deg) translateZ(0.75rem);\n          }\n\n          .materialBar-slot-name {\n            color: var(--bg-color-white);\n            font-size: 0.5rem;\n            line-height: 1;\n            max-width: 2.5rem;\n            text-align: center;\n            text-shadow: 0 0 2px black;\n            word-break: break-word;\n          }\n\n          .materialBar-slot.active {\n            border-color: var(--bg-color-white);\n            box-shadow: 0 0 0.625rem rgba(255, 255, 255, 0.2);\n            transform: scale(1.15);\n            z-index: 10;\n          }\n\n          .materialBar-slot:hover {\n            border-color: var(--bg-color-gray-400);\n          }\n\n          .materialBar-slot-number {\n            background-color: rgba(0, 0, 0, 0.5);\n            border-radius: 0.125rem;\n            color: white;\n            font-size: 0.375rem;\n            padding: 0.0625rem 0.125rem;\n            position: absolute;\n            right: 0.125rem;\n            text-shadow: 0 0 2px black;\n            top: 0.125rem;\n            z-index: 1;\n          }\n\n          #stats,\n          #settings,\n          .seed-controls {\n            font-size: 0.5625rem;\n          }\n\n          #generateWithSeed {\n            background: var(--bg-color-blue-400);\n          }\n\n          #randomSeed {\n            background: var(--bg-color-amber-500);\n          }\n\n          #copySeed {\n            background: var(--bg-color-emerald-700);\n          }\n\n          .seed-controls button {\n            border-radius: 0.1875rem;\n            border: none;\n            color: var(--bg-color-white);\n            cursor: pointer;\n            font-size: 0.75rem;\n            padding: 0.3125rem 0.625rem;\n          }\n\n          .seed-controls button:hover {\n            opacity: 0.8;\n            transform: translateY(-0.0625rem);\n          }\n\n          .seed-controls button:active {\n            transform: translateY(0);\n          }\n\n          .current-seed {\n            color: var(--bg-color-gray-600);\n            font-size: 0.6875rem;\n            margin-top: 0.5rem;\n          }\n\n          .seed-controls {\n            background: rgba(0, 0, 0, 0.7);\n            border-radius: 0.3125rem;\n            bottom: 2rem;\n            color: var(--bg-color-white);\n            margin: 0.625rem 0;\n            padding: 0.625rem;\n            position: absolute;\n            z-index: 2;\n          }\n\n          .seed-controls__actions {\n            align-items: center;\n            display: flex;\n            flex-wrap: wrap;\n            gap: 0.625rem;\n          }\n\n          .seed-controls__header {\n            display: flex;\n            gap: 0.625rem;\n            justify-content: space-between;\n            margin-bottom: 0.625rem;\n          }\n\n          .seed-controls h4, .seed-controls__header h4 {\n            color: var(--bg-color-white);\n            margin: 0 0 0.625rem 0;\n          }\n\n          .seed-controls__header button {\n            background: var(--bg-color-red-500);\n            border-radius: 0.25rem;\n            border: none;\n            color: white;\n            cursor: pointer;\n            margin: 0 0 0.625rem 0;\n            padding: 0.3125rem 0.625rem;\n          }\n\n          .seed-controls input {\n            font-size: 0.75rem;\n            margin-left: 0.3125rem;\n            padding: 0.125rem 0.3125rem;\n            width: 5rem;\n            font-size: 0.5rem;\n          }\n\n          .seed-controls input:focus {\n            outline: 0.125rem solid var(--bg-color-blue-400);\n          }\n\n          .seed-controls__save-load {\n            display: flex;\n            flex-direction: column;\n            margin-bottom: 0.5rem;\n          }\n\n          #saveModeToggle {\n            background: var(--bg-color-blue-500);\n          }\n\n          .examples {\n            background: var(--bg-color-white);\n            line-height: 1.5;\n            overflow: auto;\n            padding: 0.5rem 1rem 1rem 2rem;\n          }\n\n          .about,\n          .examples,\n          .privacy {\n            background: var(--bg-color-white);\n            line-height: 1.5;\n            overflow: auto;\n            padding: 0.5rem 1rem 1rem 2rem;\n          }\n\n          dialog.about-content,\n          dialog.examples-content,\n          dialog.privacy-content {\n            background: var(--bg-color-gray-50);\n            border-radius: 0.5rem;\n            border: 0.125rem solid var(--bg-color-gray-900);\n            color: var(--bg-color-gray-900);\n            font-family: monospace;\n            line-height: 1.5;\n            max-height: 80vh;\n            max-height: 80dvh;\n            max-width: 50rem;\n            width: 90%;\n          }\n\n          .about-content li,\n          .examples-content li,\n          .privacy-content li {\n            margin: 0.25rem 0;\n          }\n\n          .about-content_header,\n          .examples-content_header,\n          .privacy-content_header {\n            align-items: center;\n            display: flex;\n            justify-content: space-between;\n            margin-bottom: 1rem;\n            padding-top: 1rem;\n          }\n\n          .about-content_close-btn,\n          .examples-content_close-btn,\n          .privacy-content_close-btn {\n            background: var(--bg-color-red-500);\n            border-radius: 0.25rem;\n            border: none;\n            color: var(--bg-color-white);\n            cursor: pointer;\n            font-size: 1.2rem;\n            padding: 0.5rem 1rem;\n          }\n\n          .about-controls {\n            background: var(--bg-color-gray-300);\n            border-radius: 0.25rem;\n            list-style-type: none;\n            margin-bottom: 1.5rem;\n            margin-top: 0.5rem;\n            padding: 1rem;\n          }\n\n          /* Mobile Responsive */\n          @media (min-width: 30rem) {\n            .ui-grid__corner--heading {\n              font-size: 1rem;\n            }\n\n            #stats,\n            #settings {\n              font-size: 0.725rem;\n            }\n          }\n\n          @media (min-width: 48rem) {\n            .ui-grid__corner--heading {\n              font-size: 1.25rem;\n            }\n\n            #stats,\n            #settings {\n              font-size: 1.25rem;\n            }\n          }\n\n          /* Stats Panel */\n          #stats {\n            backdrop-filter: blur(0.3125rem);\n            background: var(--bg-color-black-alpha-80);\n            border-radius: 0.5rem;\n            border: 0.0625rem solid var(--bg-color-gray-alpha-10);\n            color: var(--bg-color-white);\n          }\n\n          /* Settings Panel */\n          #settings {\n            backdrop-filter: blur(0.3125rem);\n            background: var(--bg-color-black-alpha-80);\n            border-radius: 0.5rem;\n            border: 0.0625rem solid var(--bg-color-gray-alpha-10);\n            color: var(--bg-color-white);\n            display: flex;\n            flex-direction: column;\n            position: relative;\n          }\n\n          #settings .settings-actions {\n            display: flex;\n            flex-direction: column;\n          }\n\n          #settings button {\n            width: 100%;\n          }\n\n          .info-buttons-container {\n            border-top: 0.0625rem solid var(--bg-color-gray-500);\n            margin-top: 0.9375rem;\n            padding-top: 0.625rem;\n          }\n\n          #aboutBtn,\n          #privacyBtn {\n            border-radius: 0.25rem;\n            border: none;\n            color: var(--bg-color-white);\n            cursor: pointer;\n            margin: 0.25rem;\n            padding: 0.5rem 1rem;\n            width: calc(100% - 0.5rem);\n          }\n\n          #aboutBtn {\n            background: var(--bg-color-green-500);\n          }\n\n          #privacyBtn {\n            background: var(--bg-color-blue-500);\n          }\n\n          #resolution {\n            display: block;\n            margin: 0.125rem;\n            width: 100%;\n            position: relative;\n          }\n\n          .resolution-400 #canvas {\n            border: 0.125rem solid var(--bg-color-gray-900);\n            height: 25rem;\n            margin: auto;\n            width: 25rem;\n          }\n\n          .resolution-800 #canvas {\n            border: 0.125rem solid (var(--bg-color-gray-900));\n            height: 50rem;\n            margin: auto;\n            width: 50rem;\n          }\n\n          /* Touch Controls */\n          .touch-controls {\n            bottom: var(--bg-ui-touch-controls-bottom, 2rem);\n            position: var(--bg-ui-touch-controls-position, absolute);\n            width: var(--bg-ui-touch-controls-width, 100%);\n            touch-action: none;\n            pointer-events: none;\n          }\n\n          .touch-btn {\n            align-items: center;\n            backdrop-filter: blur(0.3125rem);\n            background: var(--bg-ui-touch-btn-background-color);\n            border-radius: 50%;\n            border: 0.125rem solid var(--bg-ui-touch-btn-border-color);\n            color: var(--bg-ui-touch-btn-color);\n            cursor: pointer;\n            display: inline-flex;\n            font-size: 0.7rem;\n            height: 3.25rem;\n            justify-content: center;\n            padding: 0.125rem;\n            pointer-events: auto;\n            touch-action: manipulation;\n            user-select: none;\n            width: 3.25rem;\n            z-index: 3;\n          }\n\n          .touch-btn:active {\n            background: var(--bg-color-gray-alpha-20);\n            transform: scale(0.95);\n          }\n\n          #toastContainer {\n            align-items: center;\n            bottom: 1rem;\n            display: flex;\n            flex-direction: column;\n            gap: 0.5rem;\n            left: 50%;\n            max-height: var(--bg-ui-toast-container-max-height);\n            max-width: 90vw;\n            max-width: 90dvw;\n            overflow-y: var(--bg-ui-toast-container-overflow-y);\n            pointer-events: none;\n            position: fixed;\n            transform: translateX(-50%);\n            z-index: 9999;\n          }\n\n          .toast {\n            align-items: flex-start;\n            animation: toastSlideIn 0.3s cubic-bezier(0.68, -0.55, 0.27, 1.55);\n            backdrop-filter: blur(0.5rem);\n            background: var(--bg-color-black-alpha-80);\n            border-radius: 0.5rem;\n            border: 0.125rem solid var(--bg-color-gray-alpha-30);\n            box-shadow: 0 0.25rem 0.75rem rgba(0, 0, 0, 0.3);\n            color: var(--bg-color-white);\n            display: flex;\n            font-family: monospace;\n            font-size: 0.875rem;\n            gap: 0.75rem;\n            justify-content: space-between;\n            max-width: 25rem;\n            min-width: 15rem;\n            padding: 0.75rem 1rem;\n            pointer-events: auto;\n            position: relative;\n            text-align: center;\n          }\n\n          .toast--fade-out {\n            animation: toastFadeOut 0.2s ease-out forwards;\n          }\n\n          .toast--slide-out {\n            animation: toastSlideOut 0.2s ease-out forwards;\n          }\n\n          .toast__content {\n            flex: 1;\n            line-height: 1.4;\n          }\n\n          .toast__close-btn {\n            background: var(--bg-color-red-500);\n            border-radius: 0.25rem;\n            border: none;\n            color: var(--bg-color-white);\n            cursor: pointer;\n            font-size: 1rem;\n            height: 1.5rem;\n            line-height: 1;\n            padding: 0;\n            transition: background 0.2s;\n            width: 1.5rem;\n          }\n\n          .toast__close-btn:hover {\n            background: var(--bg-color-red-500);\n            opacity: 0.8;\n          }\n\n          .toast__close-btn:active {\n            transform: scale(0.95);\n          }\n\n          @keyframes toastSlideIn {\n            from {\n              opacity: 0;\n              transform: translateY(100%);\n            }\n\n            to {\n              opacity: 1;\n              transform: translateY(0);\n            }\n          }\n\n          @keyframes toastFadeOut {\n            from {\n              opacity: 1;\n            }\n\n            to {\n              opacity: 0;\n            }\n          }\n\n          @keyframes toastSlideOut {\n            from {\n              opacity: 1;\n              transform: translateY(0);\n            }\n\n            to {\n              opacity: 0;\n              transform: translateY(100%);\n            }\n          }\n\n          .dpad-container {\n            display: flex;\n            flex-direction: row;\n            justify-content: space-between;\n            padding: 0 1rem 1rem 0.5rem;\n          }\n\n          .dpad {\n            display: grid;\n            gap: 0.3125rem;\n            grid-template-columns: 3.125rem 3.125rem 3.125rem;\n            grid-template-rows: 3.125rem 3.125rem 3.125rem;\n            justify-content: left;\n            position: relative;\n            z-index: 3;\n          }\n\n          .dpad .up-left {\n            grid-column: 1;\n            grid-row: 1;\n            margin-left: 0.5rem;\n            margin-top: 0.5rem;\n            padding: 0;\n            z-index: 4;\n          }\n\n          .dpad .up {\n            grid-column: 2;\n            grid-row: 1;\n          }\n\n          .dpad .up-right {\n            grid-column: 3;\n            grid-row: 1;\n            margin-right: 0.5rem;\n            margin-top: 0.5rem;\n            padding: 0;\n            z-index: 4;\n          }\n\n          .dpad .left {\n            grid-column: 1;\n            grid-row: 2;\n            margin-top: 0.125rem;\n          }\n\n          .dpad .middle {\n            grid-column: 2;\n            grid-row: 2;\n            z-index: 2;\n          }\n\n          .dpad .right {\n            grid-column: 3;\n            grid-row: 2;\n            margin-top: 0.125rem;\n          }\n\n          .dpad .down-left {\n            grid-column: 1;\n            grid-row: 3;\n            margin-bottom: 0.5rem;\n            margin-left: 0.5rem;\n            padding: 0;\n            z-index: 4;\n          }\n\n          .dpad .down {\n            grid-column: 2;\n            grid-row: 3;\n          }\n\n          .dpad .down-right {\n            grid-column: 3;\n            grid-row: 3;\n            margin-bottom: 0.5rem;\n            margin-right: 0.5rem;\n            padding: 0;\n            z-index: 4;\n          }\n\n          /* Button Styles */\n          button {\n            background: var(--bg-color-green-500);\n            border-radius: 0.25rem;\n            border: none;\n            color: var(--bg-color-white);\n            cursor: pointer;\n            font-size: 0.625rem;\n            height: 2.125rem;\n            margin: 0.125rem;\n            padding: 0.375rem 0.75rem;\n            transition: background 0.2s;\n          }\n\n          button:hover,\n          button:focus {\n            outline: none;\n          }\n\n          button:active {\n            transform: scale(0.95);\n          }\n\n          #privacy {\n            color: var(--bg-color-white);\n          }\n        </style>\n        <canvas id="canvas" tabindex="0"></canvas>\n        <div id="ui-grid" class="ui-grid">\n          <div class="ui-grid__corner ui-grid__corner--top-left">\n            <div id="stats">\n              <div class="ui-grid__corner--heading"> Block Garden</div>\n              <div class="ui-grid__corner--container" hidden="hidden">\n                <div class="ui-grid__corner--sub-heading">Selected Block: <span id="blockName"></span></div>\n\n                <div class="ui-grid__corner--sub-heading">Player Position:</div>\n                <ul style="list-style-type: none; margin-bottom: 0; margin-top: 0; padding-left: 1rem;">\n                  <li>x: <span id="playerX">0</span></li>\n                  <li>y: <span id="playerY">0</span></li>\n                  <li>z: <span id="playerZ">0</span></li>\n                </ul>\n\n                <br />\n                [ w / a / s / d ]: Move<br />\n                [ arrow keys ]: Camera<br />\n                [ shift ]: Descend<br />\n                [ space ]: Jump / Ascend<br />\n                [ enter ]: Place / Remove Block<br /><br />\n\n                [ <b>~ / &#96;</b> ]: Change Block<br />\n                [ e ]: Open Inventory<br /><br />\n\n                Use crosshair to center block placement<br />\n                Click Game Canvas To Lock Mouse<br /><br />\n\n                Left Click: Place Block<br />\n                Right Click: Remove Block<br /><br />\n\n                <div class="info-buttons-container">\n                  <button id="aboutBtn"> About</button>\n                  <button id="privacyBtn"> Privacy</button>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          <div class="ui-grid__corner ui-grid__corner--center" id="materialsPanel">\n            <div id="material">\n              <div class="ui-grid__corner--heading"> Material</div>\n            </div>\n          </div>\n\n          <div class="ui-grid__corner ui-grid__corner--top-right">\n            <div id="settings">\n              <div class="ui-grid__corner--heading"> Settings</div>\n              <div class="ui-grid__corner--container" hidden="hidden">\n                <div class="settings-actions">\n                  <div>\n                    <div class="ui-grid__corner--sub-heading">Game</div>\n                    <button id="worldState"> World State</button>\n                    <button id="toggleTouchControls">Disable Touch Controls</button>\n                    <button id="randomPlantButton" hidden="hidden">Plant randomly</button>\n                    <button id="fastGrowthButton" hidden="hidden">Enable Fast Growth</button>\n                    <button id="gameSaveLinkingButton" hidden="hidden">Enable Game Save Linking</button>\n                    <button id="toggleSplitControls">Enable Split Controls</button>\n                    <button id="toggleFlight"> Enable Flight</button>\n                    <button id="configureLinkBlock"> Configure Link Block</button>\n                    <button\n                      onclick="if (confirm('Reloading will lose unsaved progress. Do you want to continue?')) { window.location.reload(); }">\n                      Reload Game\n                    </button>\n                  </div>\n\n                  <div>\n                    <div class="ui-grid__corner--sub-heading">Visuals</div>\n\n                    <div id="resolution">\n                      <block-garden-select id="resolutionSelect" value="600">\n                        <block-garden-option value="400">400x400</block-garden-option>\n                        <block-garden-option value="600">600x600</block-garden-option>\n                        <block-garden-option value="800">800x800</block-garden-option>\n                        <block-garden-option value="fullscreen">Fullscreen</block-garden-option>\n                      </block-garden-select>\n                    </div>\n                    <button id="toggleTextures">Disable Textures</button>\n                    <button id="toggleAO">Disable Ambient Occlusion</button>\n                    <button id="toggleAODebug" hidden="hidden">Enable AO Debug</button>\n                    <button id="toggleDynamicLighting">Disable Light Cycle</button>\n                    <button id="togglePerFaceLighting">Disable Per-Face Lighting</button>\n                  </div>\n\n                  <div>\n                    <div id="rendering">\n                      <div style="margin-top: 0.625rem; margin-bottom: 0.625rem;">\n                        <label for="worldRadiusInput">World Radius: <span id="worldRadiusDisplay"></span></label>\n                        <input type="range" id="worldRadiusInput" min="0" max="2072" step="16" style="width: 100%;">\n                      </div>\n                      <div style="margin-top: 0.625rem;">\n                        <label for="viewRadiusInput">View Radius: <span id="viewRadiusDisplay"></span></label>\n                        <input type="range" id="viewRadiusInput" min="0" max="2048" step="16" style="width: 100%;">\n                      </div>\n                      <div style="margin-top: 0.625rem;">\n                        <label for="renderRadiusInput">Render Radius: <span id="renderRadiusDisplay"></span></label>\n                        <input type="range" id="renderRadiusInput" min="0" max="256" step="8" style="width: 100%;">\n                      </div>\n                      <div style="margin-top: 0.625rem;">\n                        <label for="cacheRadiusInput">Cache Radius: <span id="cacheRadiusDisplay"></span></label>\n                        <input type="range" id="cacheRadiusInput" min="0" max="256" step="8" style="width: 100%;">\n                      </div>\n                    </div>\n\n                    <div id="generation">\n                      <div class="ui-grid__corner--sub-heading">Generation (affects new chunks)</div>\n                      <div style="margin-top: 0.625rem;">\n                        <label for="terrainOctavesInput">Terrain Octaves: <span id="terrainOctavesDisplay"></span></label>\n                        <input type="range" id="terrainOctavesInput" min="1" max="8" step="1" style="width: 100%;">\n                      </div>\n                      <div style="margin-top: 0.625rem;">\n                        <label for="mountainScaleInput">Mountain Scale: <span id="mountainScaleDisplay"></span></label>\n                        <input type="range" id="mountainScaleInput" min="0" max="100" step="1" style="width: 100%;">\n                      </div>\n                      <div style="margin-top: 0.625rem;">\n                        <label for="decorationDensityInput">Decoration Density: <span id="decorationDensityDisplay"></span></label>\n                        <input type="range" id="decorationDensityInput" min="0" max="100" step="1" style="width: 100%;">\n                      </div>\n                      <div style="margin-top: 0.625rem;">\n                        <label for="cloudDensityInput">Cloud Density: <span id="cloudDensityDisplay"></span></label>\n                        <input type="range" id="cloudDensityInput" min="0" max="100" step="1" style="width: 100%;">\n                      </div>\n                      <div id="caveThresholdInputContainer" style="margin-top: 0.625rem;">\n                        <label for="caveThresholdInput">Cave Density (higher number is fewer caves): <span id="caveDensityDisplay"></span></label>\n                        <input type="range" id="caveThresholdInput" min="0" max="100" step="1" style="width: 100%;">\n                      </div>\n                      <div style="margin-top: 0.625rem;">\n                        <button id="toggleCaves">Disable Caves</button>\n                      </div>\n                      <button id="applyLowDetailPreset" title="Use low detail defaults.">Apply Low Detail Defaults</button>\n                    </div>\n                  </div>\n\n                  <div id="customizeColorsBtnContainer" hidden="hidden">\n                    <div class="ui-grid__corner--sub-heading"> Colors</div>\n\n                    <button id="customizeColorsBtn">Customize</button>\n                  </div>\n                  <div id="examplesBtnContainer" hidden="hidden">\n                    <div class="ui-grid__corner--sub-heading"> Examples</div>\n                    <button id="examplesBtn">\n                       <span id="examplesBtnText">Open</span>\n                    </button>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          <div class="ui-grid__corner ui-grid__corner--bottom-left" hidden="hidden">\n            <div class="ui-grid__corner--heading">\n              <div class="ui-grid__corner--container" hidden="hidden"></div>\n            </div>\n          </div>\n\n          <div class="ui-grid__corner ui-grid__corner--bottom-right" hidden="hidden">\n            <div class="ui-grid__corner--heading">\n              <div class="ui-grid__corner--container" hidden="hidden"></div>\n            </div>\n          </div>\n        </div>\n\n        <div class="seed-controls" hidden="hidden">\n          <div class="seed-controls__header">\n            <h4>World Generation</h4>\n            <button id="closeWorldGeneration">\n              &times;\n            </button>\n          </div>\n          <div class="seed-controls__actions">\n            <label>\n              Seed:\n              <input id="worldSeedInput" placeholder="Enter seed..." type="number" />\n            </label>\n\n            <button id="generateWithSeed">Generate</button>\n            <button id="randomSeed">Random</button>\n            <button id="copySeed">Copy Seed</button>\n          </div>\n\n          <div class="current-seed">\n            <p>Current seed: <span id="currentSeed"></span></p>\n          </div>\n\n          <h4>Store / Save / Load</h4>\n\n          <div class="seed-controls__save-load">\n            <button id="openStorageBtn"> Open Game Storage</button>\n            <button id="saveExternalGameFile"> Save Game File To Disk</button>\n            <button id="loadExternalGameFile"> Load Game File From Disk</button>\n            <button id="loadExternalGameUrl"> Load Game By URL</button>\n          </div>\n\n          <h4 class="seed-controls__header seed-controls--share" hidden>Share</h4>\n\n          <div class="seed-controls__save-load seed-controls--share" hidden>\n            <button id="shareExternalGameFile"> Share Game File From Disk</button>\n          </div>\n\n          <h4>Mode</h4>\n\n          <div class="seed-controls__save-load">\n            <button id="saveModeToggle">Save Mode Auto</button>\n          </div>\n        </div>\n\n        <div class="touch-controls" hidden="hidden">\n          <div class="dpad-container">\n            <div class="dpad">\n              <div class="touch-btn up-left" data-key="upleft"></div>\n              <div class="touch-btn up" data-key="w"></div>\n              <div class="touch-btn up-right" data-key="upright"></div>\n\n              <div class="touch-btn left" data-key="a"></div>\n              <div class="touch-btn middle" data-key="e"></div>\n              <div class="touch-btn right" data-key="d"></div>\n\n              <div class="touch-btn down-left" data-key="downleft"></div>\n              <div class="touch-btn down" data-key="s"></div>\n              <div class="touch-btn down-right" data-key="downright"></div>\n            </div>\n            <div class="dpad">\n              <div class="up-left"></div>\n              <div id="fly" class="touch-btn up" data-key=" " hidden="hidden"></div>\n              <div class="up-right"></div>\n\n              <div id="dig" class="touch-btn left" data-key="backspace"></div>\n              <div id="jump" class="touch-btn middle" data-key=" ">\n                \n              </div>\n              <div class="right"></div>\n\n              <div class="down-left"></div>\n              <div id="descend" class="touch-btn down" data-key="shift" hidden="hidden"></div>\n              <div class="down-right"></div>\n            </div>\n          </div>\n        </div>\n\n        <div id="materialBar" class="materialBar" hidden="hidden"></div>\n\n        <div id="toastContainer"></div>\n      `;this.attachShadow({mode:"open"}).appendChild(e.content.cloneNode(!0))}}async connectedCallback(){const e=this.shadowRoot,t=e.querySelector("canvas");await gr(globalThis,e,t)}async disconnectedCallback(){await q(globalThis)}}globalThis.customElements?.get(hr)||globalThis.customElements?.define(hr,br);export{br as BlockGarden,hr as tagName};
